(function webpackUniversalModuleDefinition(root, factory) {
  if (typeof exports === 'object' && typeof module === 'object')
    module.exports = factory();
  else if (typeof define === 'function' && define.amd) define([], factory);
        else if (typeof exports === 'object') exports['deck'] = factory();
  else root['deck'] = factory();})(globalThis, function () {
"use strict";var __exports__=(()=>{var Om=Object.create;var dn=Object.defineProperty;var wm=Object.getOwnPropertyDescriptor;var Fm=Object.getOwnPropertyNames;var Lm=Object.getPrototypeOf,Dm=Object.prototype.hasOwnProperty;var yr=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports),Ze=(t,r)=>{for(var e in r)dn(t,e,{get:r[e],enumerable:!0})},ln=(t,r,e,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of Fm(r))!Dm.call(t,a)&&a!==e&&dn(t,a,{get:()=>r[a],enumerable:!(n=wm(r,a))||n.enumerable});return t},vt=(t,r,e)=>(ln(t,r,"default"),e&&ln(e,r,"default")),oe=(t,r,e)=>(e=t!=null?Om(Lm(t)):{},ln(r||!t||!t.__esModule?dn(e,"default",{value:t,enumerable:!0}):e,t)),Pm=t=>ln(dn({},"__esModule",{value:!0}),t);var Kt=yr((Db,Ps)=>{Ps.exports=globalThis.deck});var Ma=yr((Zb,Us)=>{Us.exports=globalThis.luma});var Tu=yr((lx,Ya)=>{var Ka=function(t){"use strict";var r=Object.prototype,e=r.hasOwnProperty,n,a=typeof Symbol=="function"?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(B,A,I){return Object.defineProperty(B,A,{value:I,enumerable:!0,configurable:!0,writable:!0}),B[A]}try{u({},"")}catch{u=function(A,I,G){return A[I]=G}}function f(B,A,I,G){var j=A&&A.prototype instanceof g?A:g,ee=Object.create(j.prototype),ie=new z(G||[]);return ee._invoke=U(B,I,ie),ee}t.wrap=f;function c(B,A,I){try{return{type:"normal",arg:B.call(A,I)}}catch(G){return{type:"throw",arg:G}}}var d="suspendedStart",m="suspendedYield",h="executing",p="completed",v={};function g(){}function _(){}function b(){}var C={};u(C,i,function(){return this});var x=Object.getPrototypeOf,T=x&&x(x(H([])));T&&T!==r&&e.call(T,i)&&(C=T);var R=b.prototype=g.prototype=Object.create(C);_.prototype=b,u(R,"constructor",b),u(b,"constructor",_),_.displayName=u(b,s,"GeneratorFunction");function D(B){["next","throw","return"].forEach(function(A){u(B,A,function(I){return this._invoke(A,I)})})}t.isGeneratorFunction=function(B){var A=typeof B=="function"&&B.constructor;return A?A===_||(A.displayName||A.name)==="GeneratorFunction":!1},t.mark=function(B){return Object.setPrototypeOf?Object.setPrototypeOf(B,b):(B.__proto__=b,u(B,s,"GeneratorFunction")),B.prototype=Object.create(R),B},t.awrap=function(B){return{__await:B}};function V(B,A){function I(ee,ie,pe,be){var _e=c(B[ee],B,ie);if(_e.type==="throw")be(_e.arg);else{var qe=_e.arg,Mt=qe.value;return Mt&&typeof Mt=="object"&&e.call(Mt,"__await")?A.resolve(Mt.__await).then(function(Pe){I("next",Pe,pe,be)},function(Pe){I("throw",Pe,pe,be)}):A.resolve(Mt).then(function(Pe){qe.value=Pe,pe(qe)},function(Pe){return I("throw",Pe,pe,be)})}}var G;function j(ee,ie){function pe(){return new A(function(be,_e){I(ee,ie,be,_e)})}return G=G?G.then(pe,pe):pe()}this._invoke=j}D(V.prototype),u(V.prototype,o,function(){return this}),t.AsyncIterator=V,t.async=function(B,A,I,G,j){j===void 0&&(j=Promise);var ee=new V(f(B,A,I,G),j);return t.isGeneratorFunction(A)?ee:ee.next().then(function(ie){return ie.done?ie.value:ee.next()})};function U(B,A,I){var G=d;return function(ee,ie){if(G===h)throw new Error("Generator is already running");if(G===p){if(ee==="throw")throw ie;return se()}for(I.method=ee,I.arg=ie;;){var pe=I.delegate;if(pe){var be=N(pe,I);if(be){if(be===v)continue;return be}}if(I.method==="next")I.sent=I._sent=I.arg;else if(I.method==="throw"){if(G===d)throw G=p,I.arg;I.dispatchException(I.arg)}else I.method==="return"&&I.abrupt("return",I.arg);G=h;var _e=c(B,A,I);if(_e.type==="normal"){if(G=I.done?p:m,_e.arg===v)continue;return{value:_e.arg,done:I.done}}else _e.type==="throw"&&(G=p,I.method="throw",I.arg=_e.arg)}}}function N(B,A){var I=B.iterator[A.method];if(I===n){if(A.delegate=null,A.method==="throw"){if(B.iterator.return&&(A.method="return",A.arg=n,N(B,A),A.method==="throw"))return v;A.method="throw",A.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var G=c(I,B.iterator,A.arg);if(G.type==="throw")return A.method="throw",A.arg=G.arg,A.delegate=null,v;var j=G.arg;if(!j)return A.method="throw",A.arg=new TypeError("iterator result is not an object"),A.delegate=null,v;if(j.done)A[B.resultName]=j.value,A.next=B.nextLoc,A.method!=="return"&&(A.method="next",A.arg=n);else return j;return A.delegate=null,v}D(R),u(R,s,"Generator"),u(R,i,function(){return this}),u(R,"toString",function(){return"[object Generator]"});function J(B){var A={tryLoc:B[0]};1 in B&&(A.catchLoc=B[1]),2 in B&&(A.finallyLoc=B[2],A.afterLoc=B[3]),this.tryEntries.push(A)}function L(B){var A=B.completion||{};A.type="normal",delete A.arg,B.completion=A}function z(B){this.tryEntries=[{tryLoc:"root"}],B.forEach(J,this),this.reset(!0)}t.keys=function(B){var A=[];for(var I in B)A.push(I);return A.reverse(),function G(){for(;A.length;){var j=A.pop();if(j in B)return G.value=j,G.done=!1,G}return G.done=!0,G}};function H(B){if(B){var A=B[i];if(A)return A.call(B);if(typeof B.next=="function")return B;if(!isNaN(B.length)){var I=-1,G=function j(){for(;++I<B.length;)if(e.call(B,I))return j.value=B[I],j.done=!1,j;return j.value=n,j.done=!0,j};return G.next=G}}return{next:se}}t.values=H;function se(){return{value:n,done:!0}}return z.prototype={constructor:z,reset:function(B){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(L),!B)for(var A in this)A.charAt(0)==="t"&&e.call(this,A)&&!isNaN(+A.slice(1))&&(this[A]=n)},stop:function(){this.done=!0;var B=this.tryEntries[0],A=B.completion;if(A.type==="throw")throw A.arg;return this.rval},dispatchException:function(B){if(this.done)throw B;var A=this;function I(be,_e){return ee.type="throw",ee.arg=B,A.next=be,_e&&(A.method="next",A.arg=n),!!_e}for(var G=this.tryEntries.length-1;G>=0;--G){var j=this.tryEntries[G],ee=j.completion;if(j.tryLoc==="root")return I("end");if(j.tryLoc<=this.prev){var ie=e.call(j,"catchLoc"),pe=e.call(j,"finallyLoc");if(ie&&pe){if(this.prev<j.catchLoc)return I(j.catchLoc,!0);if(this.prev<j.finallyLoc)return I(j.finallyLoc)}else if(ie){if(this.prev<j.catchLoc)return I(j.catchLoc,!0)}else if(pe){if(this.prev<j.finallyLoc)return I(j.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(B,A){for(var I=this.tryEntries.length-1;I>=0;--I){var G=this.tryEntries[I];if(G.tryLoc<=this.prev&&e.call(G,"finallyLoc")&&this.prev<G.finallyLoc){var j=G;break}}j&&(B==="break"||B==="continue")&&j.tryLoc<=A&&A<=j.finallyLoc&&(j=null);var ee=j?j.completion:{};return ee.type=B,ee.arg=A,j?(this.method="next",this.next=j.finallyLoc,v):this.complete(ee)},complete:function(B,A){if(B.type==="throw")throw B.arg;return B.type==="break"||B.type==="continue"?this.next=B.arg:B.type==="return"?(this.rval=this.arg=B.arg,this.method="return",this.next="end"):B.type==="normal"&&A&&(this.next=A),v},finish:function(B){for(var A=this.tryEntries.length-1;A>=0;--A){var I=this.tryEntries[A];if(I.finallyLoc===B)return this.complete(I.completion,I.afterLoc),L(I),v}},catch:function(B){for(var A=this.tryEntries.length-1;A>=0;--A){var I=this.tryEntries[A];if(I.tryLoc===B){var G=I.completion;if(G.type==="throw"){var j=G.arg;L(I)}return j}}throw new Error("illegal catch attempt")},delegateYield:function(B,A,I){return this.delegate={iterator:H(B),resultName:A,nextLoc:I},this.method==="next"&&(this.arg=n),v}},t}(typeof Ya=="object"?Ya.exports:{});try{regeneratorRuntime=Ka}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=Ka:Function("r","regeneratorRuntime = r")(Ka)}});var ge=yr((dx,Cu)=>{Cu.exports=Tu()});var Il=yr(()=>{});var cn={};Ze(cn,{ScenegraphLayer:()=>Ca,SimpleMeshLayer:()=>Qn});var et={},Gs=oe(Kt());vt(et,oe(Kt()));if(!Gs.Layer)throw new Error("@deck.gl/core is not found");vt(cn,et);function y(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function ks(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function E(t,r,e){return r&&ks(t.prototype,r),e&&ks(t,e),t}function Z(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},O(t)}function Sa(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=O(t),t!==null););return t}function ve(t,r,e){return typeof Reflect<"u"&&Reflect.get?ve=Reflect.get:ve=function(a,i,o){var s=Sa(a,i);if(s){var u=Object.getOwnPropertyDescriptor(s,i);return u.get?u.get.call(o):u.value}},ve(t,r,e||t)}function Rt(t,r){return Rt=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},Rt(t,r)}function w(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Rt(t,r)}function $(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$=function(e){return typeof e}:$=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(t)}function W(t,r){if(r&&($(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Z(t)}function l(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var it=oe(Kt()),at=oe(Ma());function Yt(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Ra(t){if(Array.isArray(t))return Yt(t)}function Ia(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function br(t,r){if(t){if(typeof t=="string")return Yt(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Yt(t,r)}}function Oa(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y(t){return Ra(t)||Ia(t)||br(t)||Oa()}function _r(t){if(typeof window<"u"&&$(window.process)==="object"&&window.process.type==="renderer"||typeof process<"u"&&$(process.versions)==="object"&&Boolean(process.versions.electron))return!0;var r=(typeof navigator>"u"?"undefined":$(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,e=t||r;return!!(e&&e.indexOf("Electron")>=0)}function Ce(){var t=(typeof process>"u"?"undefined":$(process))==="object"&&String(process)==="[object process]"&&!process.browser;return!t||_r()}var gt={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:(typeof process>"u"?"undefined":$(process))==="object"&&process};var Gm=gt.self||gt.window||gt.global,Qt=gt.window||gt.self||gt.global,km=gt.document||{},It=gt.process||{};var mn="8.9.21",b_=Ce();var wa=globalThis;function hn(t){if(!t&&!Ce())return"Node";if(_r(t))return"Electron";var r=typeof navigator<"u"?navigator:{},e=t||r.userAgent||"";if(e.indexOf("Edge")>-1)return"Edge";var n=e.indexOf("MSIE ")!==-1,a=e.indexOf("Trident/")!==-1;return n||a?"IE":wa.chrome?"Chrome":wa.safari?"Safari":wa.mozInnerScreenX?"Firefox":"Unknown"}function Um(t){try{var r=window[t],e="__storage_test__";return r.setItem(e,e),r.removeItem(e),r}catch{return null}}var Ns=function(){function t(r){y(this,t);var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";l(this,"storage",void 0),l(this,"id",void 0),l(this,"config",{}),this.storage=Um(n),this.id=r,this.config={},Object.assign(this.config,e),this._loadConfiguration()}return E(t,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(e){return this.config={},this.updateConfiguration(e)}},{key:"updateConfiguration",value:function(e){if(Object.assign(this.config,e),this.storage){var n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}return this}},{key:"_loadConfiguration",value:function(){var e={};if(this.storage){var n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}]),t}();function Hs(t){var r;return t<10?r="".concat(t.toFixed(2),"ms"):t<100?r="".concat(t.toFixed(1),"ms"):t<1e3?r="".concat(t.toFixed(0),"ms"):r="".concat((t/1e3).toFixed(2),"s"),r}function js(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,e=Math.max(r-t.length,0);return"".concat(" ".repeat(e)).concat(t)}function pn(t,r,e){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,a=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>n&&(e=Math.min(e,n/t.width));var i=t.width*e,o=t.height*e,s=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(i/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(a,");"),"background-size:".concat(i,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(r," %c+"),s]}var vn;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(vn||(vn={}));function Vs(t){return typeof t=="string"?vn[t.toUpperCase()]||vn.WHITE:t}function Js(t,r,e){return!Ce&&typeof t=="string"&&(r&&(r=Vs(r),t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")),e&&(r=Vs(e),t="\x1B[".concat(e+10,"m").concat(t,"\x1B[49m"))),t}function Nm(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Hm(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Hm(t,r){if(t){if(typeof t=="string")return Xs(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Xs(t,r)}}function Xs(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function zs(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],e=Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(e),a=Nm(n),i;try{var o=function(){var u=i.value;typeof t[u]=="function"&&(r.find(function(f){return u===f})||(t[u]=t[u].bind(t)))};for(a.s();!(i=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}}function $t(t,r){if(!t)throw new Error(r||"Assertion failed")}function Ot(){var t;if(Ce&&"performance"in Qt){var r,e;t=Qt===null||Qt===void 0||(r=Qt.performance)===null||r===void 0||(e=r.now)===null||e===void 0?void 0:e.call(r)}else if("hrtime"in It){var n,a=It===null||It===void 0||(n=It.hrtime)===null||n===void 0?void 0:n.call(It);t=a[0]*1e3+a[1]/1e6}else t=Date.now();return t}var qt={debug:Ce&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},jm={enabled:!0,level:0};function He(){}var Ws={},Ks={once:!0},Zt=function(){function t(){y(this,t);var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""},e=r.id;l(this,"id",void 0),l(this,"VERSION",mn),l(this,"_startTs",Ot()),l(this,"_deltaTs",Ot()),l(this,"_storage",void 0),l(this,"userData",{}),l(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this._storage=new Ns("__probe-".concat(this.id,"__"),jm),this.userData={},this.timeStamp("".concat(this.id," started")),zs(this),Object.seal(this)}return E(t,[{key:"level",get:function(){return this.getLevel()},set:function(e){this.setLevel(e)}},{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((Ot()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Ot()-this._deltaTs).toPrecision(10))}},{key:"priority",get:function(){return this.level},set:function(e){this.level=e}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:e}),this}},{key:"setLevel",value:function(e){return this._storage.updateConfiguration({level:e}),this}},{key:"get",value:function(e){return this._storage.config[e]}},{key:"set",value:function(e,n){this._storage.updateConfiguration(l({},e,n))}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"assert",value:function(e,n){$t(e,n)}},{key:"warn",value:function(e){return this._getLogFunction(0,e,qt.warn,arguments,Ks)}},{key:"error",value:function(e){return this._getLogFunction(0,e,qt.error,arguments)}},{key:"deprecated",value:function(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}},{key:"removed",value:function(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}},{key:"probe",value:function(e,n){return this._getLogFunction(e,n,qt.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(e,n){return this._getLogFunction(e,n,qt.debug,arguments)}},{key:"info",value:function(e,n){return this._getLogFunction(e,n,console.info,arguments)}},{key:"once",value:function(e,n){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return this._getLogFunction(e,n,qt.debug||qt.info,arguments,Ks)}},{key:"table",value:function(e,n,a){return n?this._getLogFunction(e,n,console.table||He,a&&[a],{tag:zm(n)}):He}},{key:"image",value:function(e){var n=e.logLevel,a=e.priority,i=e.image,o=e.message,s=o===void 0?"":o,u=e.scale,f=u===void 0?1:u;return this._shouldLog(n||a)?Ce?Xm({image:i,message:s,scale:f}):Jm({image:i,message:s,scale:f}):He}},{key:"time",value:function(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}},{key:"timeEnd",value:function(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(e,n){return this._getLogFunction(e,n,console.timeStamp||He)}},{key:"group",value:function(e,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1},i=Ys({logLevel:e,message:n,opts:a}),o=a.collapsed;return i.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}},{key:"groupCollapsed",value:function(e,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},a,{collapsed:!0}))}},{key:"groupEnd",value:function(e){return this._getLogFunction(e,"",console.groupEnd||He)}},{key:"withGroup",value:function(e,n,a){this.group(e,n)();try{a()}finally{this.groupEnd(e)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(e){return this.isEnabled()&&this.getLevel()>=Qs(e)}},{key:"_getLogFunction",value:function(e,n,a,i,o){if(this._shouldLog(e)){var s;o=Ys({logLevel:e,message:n,args:i,opts:o}),a=a||o.method,$t(a),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=Ot();var u=o.tag||o.message;if(o.once)if(!Ws[u])Ws[u]=Ot();else return He;return n=Vm(this.id,o.message,o),(s=a).bind.apply(s,[console,n].concat(Y(o.args)))}return He}}]),t}();l(Zt,"VERSION",mn);function Qs(t){if(!t)return 0;var r;switch($(t)){case"number":r=t;break;case"object":r=t.logLevel||t.priority||0;break;default:return 0}return $t(Number.isFinite(r)&&r>=0),r}function Ys(t){var r=t.logLevel,e=t.message;t.logLevel=Qs(r);for(var n=t.args?Array.from(t.args):[];n.length&&n.shift()!==e;);switch($(r)){case"string":case"function":e!==void 0&&n.unshift(e),t.message=r;break;case"object":Object.assign(t,r);break;default:}typeof t.message=="function"&&(t.message=t.message());var a=$(t.message);return $t(a==="string"||a==="object"),Object.assign(t,{args:n},t.opts)}function Vm(t,r,e){if(typeof r=="string"){var n=e.time?js(Hs(e.total)):"";r=e.time?"".concat(t,": ").concat(n,"  ").concat(r):"".concat(t,": ").concat(r),r=Js(r,e.color,e.background)}return r}function Jm(t){var r=t.image,e=t.message,n=e===void 0?"":e,a=t.scale,i=a===void 0?1:a,o=null;try{o=module.require("asciify-image")}catch{}return o?function(){return o(r,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then(function(s){return console.log(s)})}:He}function Xm(t){var r=t.image,e=t.message,n=e===void 0?"":e,a=t.scale,i=a===void 0?1:a;if(typeof r=="string"){var o=new Image;return o.onload=function(){var c,d=pn(o,n,i);(c=console).log.apply(c,Y(d))},o.src=r,He}var s=r.nodeName||"";if(s.toLowerCase()==="img"){var u;return(u=console).log.apply(u,Y(pn(r,n,i))),He}if(s.toLowerCase()==="canvas"){var f=new Image;return f.onload=function(){var c;return(c=console).log.apply(c,Y(pn(f,n,i)))},f.src=r.toDataURL(),He}return He}function zm(t){for(var r in t)for(var e in t[r])return e||"untitled";return"empty"}var o1=new Zt({id:"@probe.gl/log"});var F=new Zt({id:"luma.gl"});function Be(t,r){if(!t)throw new Error(r||"luma.gl: assertion failed.")}var Wm="Invalid WebGLRenderingContext";var Km="Requires WebGL2";function er(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&Number.isFinite(t._version))}function X(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function Fa(t){return X(t)?t:null}function wt(t){return Be(er(t),Wm),t}function Ae(t){return Be(X(t),Km),t}var Br={};function Ym(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function Qm(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function $m(t,r){Br[t]=!0,r!==void 0&&Ym(r)}function qm(t){var r=t.getError;t.getError=function(){var n;do n=r.apply(t),n!==0&&(Br[n]=!0);while(n!==0);for(n in Br)if(Br[n])return delete Br[n],parseInt(n,10);return 0}}var Er=function t(r){var e=r.gl;this.ext=r,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(r.maxVertexAttribs);for(var n=0;n<this.attribs.length;n++){var a=new t.VertexAttrib(e);this.attribs[n]=a}this.maxAttrib=0};Er.VertexAttrib=function(r){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Er.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var Ft=function(r){var e=this;this.gl=r,qm(r);var n=this.original={getParameter:r.getParameter,enableVertexAttribArray:r.enableVertexAttribArray,disableVertexAttribArray:r.disableVertexAttribArray,bindBuffer:r.bindBuffer,getVertexAttrib:r.getVertexAttrib,vertexAttribPointer:r.vertexAttribPointer};r.getParameter=function(i){return i===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},r.enableVertexAttribArray=function(i){var o=e.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,i);var s=o.attribs[i];return s.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},r.disableVertexAttribArray=function(i){var o=e.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,i);var s=o.attribs[i];return s.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},r.bindBuffer=function(i,o){switch(i){case 34962:e.currentArrayBuffer=o;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=o;break;default:}return n.bindBuffer.apply(this,arguments)},r.getVertexAttrib=function(i,o){var s=e.currentVertexArrayObject,u=s.attribs[i];switch(o){case 34975:return u.buffer;case 34338:return u.enabled;case 34339:return u.size;case 34340:return u.stride;case 34341:return u.type;case 34922:return u.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},r.vertexAttribPointer=function(i,o,s,u,f,c){var d=e.currentVertexArrayObject;d.maxAttrib=Math.max(d.maxAttrib,i);var m=d.attribs[i];return m.buffer=e.currentArrayBuffer,m.size=o,m.type=s,m.normalized=u,m.stride=f,m.offset=c,m.recache(),n.vertexAttribPointer.apply(this,arguments)},r.instrumentExtension&&r.instrumentExtension(this,"OES_vertex_array_object"),r.canvas&&r.canvas.addEventListener("webglcontextrestored",function(){Qm("OESVertexArrayObject emulation library context restored"),e.reset_()},!0),this.reset_()};Ft.prototype.VERTEX_ARRAY_BINDING_OES=34229;Ft.prototype.reset_=function(){var r=this.vertexArrayObjects!==void 0;if(r)for(var e=0;e<this.vertexArrayObjects.length;++e)this.vertexArrayObjects.isAlive=!1;var n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Er(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Ft.prototype.createVertexArrayOES=function(){var r=new Er(this);return this.vertexArrayObjects.push(r),r};Ft.prototype.deleteVertexArrayOES=function(r){r.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(r),1),this.currentVertexArrayObject===r&&this.bindVertexArrayOES(null)};Ft.prototype.isVertexArrayOES=function(r){return!!(r&&r instanceof Er&&r.hasBeenBound&&r.ext===this)};Ft.prototype.bindVertexArrayOES=function(r){var e=this.gl;if(r&&!r.isAlive){$m(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}var n=this.original,a=this.currentVertexArrayObject;this.currentVertexArrayObject=r||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;var i=this.currentVertexArrayObject;if(a!==i){(!a||i.elementArrayBuffer!==a.elementArrayBuffer)&&n.bindBuffer.call(e,34963,i.elementArrayBuffer);for(var o=this.currentArrayBuffer,s=Math.max(a?a.maxAttrib:0,i.maxAttrib),u=0;u<=s;u++){var f=i.attribs[u],c=a?a.attribs[u]:null;if((!a||f.enabled!==c.enabled)&&(f.enabled?n.enableVertexAttribArray.call(e,u):n.disableVertexAttribArray.call(e,u)),f.enabled){var d=!1;(!a||f.buffer!==c.buffer)&&(o!==f.buffer&&(n.bindBuffer.call(e,34962,f.buffer),o=f.buffer),d=!0),(d||f.cached!==c.cached)&&n.vertexAttribPointer.call(e,u,f.size,f.type,f.normalized,f.stride,f.offset)}}this.currentArrayBuffer!==o&&n.bindBuffer.call(e,34962,this.currentArrayBuffer)}};function $s(t){if(typeof t.createVertexArray!="function"){var r=t.getSupportedExtensions;t.getSupportedExtensions=function(){var a=r.call(this)||[];return a.indexOf("OES_vertex_array_object")<0&&a.push("OES_vertex_array_object"),a};var e=t.getExtension;t.getExtension=function(a){var i=e.call(this,a);return i||(a!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Ft(this)),this.__OESVertexArrayObject))}}}var q,qs="OES_element_index",Zs="WEBGL_draw_buffers",Zm="EXT_disjoint_timer_query",eh="EXT_disjoint_timer_query_webgl2",th="EXT_texture_filter_anisotropic",eu="WEBGL_debug_renderer_info",rh=35723,nh=4352,ah=36795,ih=34047,oh=37445,sh=37446,ce=function(r){return X(r)?void 0:0},uh=(q={},l(q,3074,function(r){return X(r)?void 0:36064}),l(q,rh,function(t){return X(t)?void 0:nh}),l(q,35977,ce),l(q,32937,ce),l(q,ah,function(t,r){var e=X(t)?t.getExtension(eh):t.getExtension(Zm);return e&&e.GPU_DISJOINT_EXT?r(e.GPU_DISJOINT_EXT):0}),l(q,oh,function(t,r){var e=t.getExtension(eu);return r(e&&e.UNMASKED_VENDOR_WEBGL||7936)}),l(q,sh,function(t,r){var e=t.getExtension(eu);return r(e&&e.UNMASKED_RENDERER_WEBGL||7937)}),l(q,ih,function(t,r){var e=t.luma.extensions[th];return e?r(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1}),l(q,32883,ce),l(q,35071,ce),l(q,37447,ce),l(q,36063,function(r,e){if(!X(r)){var n=r.getExtension(Zs);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}}),l(q,35379,ce),l(q,35374,ce),l(q,35377,ce),l(q,34852,function(r){if(!X(r)){var e=r.getExtension(Zs);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}}),l(q,36203,function(r){return r.getExtension(qs)?2147483647:65535}),l(q,33001,function(r){return r.getExtension(qs)?16777216:65535}),l(q,33e3,function(r){return 16777216}),l(q,37157,ce),l(q,35373,ce),l(q,35657,ce),l(q,36183,ce),l(q,37137,ce),l(q,34045,ce),l(q,35978,ce),l(q,35979,ce),l(q,35968,ce),l(q,35376,ce),l(q,35375,ce),l(q,35659,ce),l(q,37154,ce),l(q,35371,ce),l(q,35658,ce),l(q,35076,ce),l(q,35077,ce),l(q,35380,ce),q);function tu(t,r,e){var n=uh[e],a=typeof n=="function"?n(t,r,e):n,i=a!==void 0?a:r(e);return i}var tr,fh="OES_vertex_array_object",ru="ANGLE_instanced_arrays",ch="WEBGL_draw_buffers",lh="EXT_disjoint_timer_query",dh="EXT_texture_filter_anisotropic",mh="VertexArray requires WebGL2 or OES_vertex_array_object extension";function hh(t,r){return{webgl2:X(t),ext:t.getExtension(r)}}var La=(tr={},l(tr,fh,{meta:{suffix:"OES"},createVertexArray:function(){Be(!1,mh)},deleteVertexArray:function(){},bindVertexArray:function(){},isVertexArray:function(){return!1}}),l(tr,ru,{meta:{suffix:"ANGLE"},vertexAttribDivisor:function(r,e){Be(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:function(){},drawArraysInstanced:function(){}}),l(tr,ch,{meta:{suffix:"WEBGL"},drawBuffers:function(){Be(!1)}}),l(tr,lh,{meta:{suffix:"EXT"},createQuery:function(){Be(!1)},deleteQuery:function(){Be(!1)},beginQuery:function(){Be(!1)},endQuery:function(){},getQuery:function(r,e){return this.getQueryObject(r,e)},getQueryParameter:function(r,e){return this.getQueryObject(r,e)},getQueryObject:function(){}}),tr),gn={readBuffer:function(r,e,n){X(r)&&e(n)},getVertexAttrib:function(r,e,n,a){var i=hh(r,ru),o=i.webgl2,s=i.ext,u;switch(a){case 35069:u=o?void 0:!1;break;case 35070:u=!o&&!s?0:void 0;break;default:}return u!==void 0?u:e(n,a)},getProgramParameter:function(r,e,n,a){if(!X(r))switch(a){case 35967:return 35981;case 35971:return 0;case 35382:return 0;default:}return e(n,a)},getInternalformatParameter:function(r,e,n,a,i){if(!X(r))switch(i){case 32937:return new Int32Array([0]);default:}return r.getInternalformatParameter(n,a,i)},getTexParameter:function(r,e,n,a){switch(a){case 34046:var i=r.luma.extensions,o=i[dh];a=o&&o.TEXTURE_MAX_ANISOTROPY_EXT||34046;break;default:}return e(n,a)},getParameter:tu,hint:function(r,e,n,a){return e(n,a)}};function au(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=ph(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function ph(t,r){if(t){if(typeof t=="string")return nu(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return nu(t,r)}}function nu(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function iu(t){t.luma=t.luma||{};var r=t.luma;return r.polyfilled||($s(t),vh(t),Ah(t,La),gh(t,{target:r,target2:t}),r.polyfilled=!0),t}globalThis.polyfillContext=iu;function vh(t){t.luma.extensions={};var r=t.getSupportedExtensions()||[],e=au(r),n;try{for(e.s();!(n=e.n()).done;){var a=n.value;t.luma[a]=t.getExtension(a)}}catch(i){e.e(i)}finally{e.f()}}function gh(t,r){var e=r.target,n=r.target2;Object.keys(gn).forEach(function(a){if(typeof gn[a]=="function"){var i=t[a]?t[a].bind(t):function(){},o=gn[a].bind(null,t,i);e[a]=o,n[a]=o}})}function Ah(t,r){var e=au(Object.getOwnPropertyNames(r)),n;try{for(e.s();!(n=e.n()).done;){var a=n.value;a!=="overrides"&&yh(t,{extension:a,target:t.luma,target2:t})}}catch(i){e.e(i)}finally{e.f()}}function yh(t,r){var e=r.extension,n=r.target,a=r.target2,i=La[e];Be(i);for(var o=i.meta,s=o===void 0?{}:o,u=s.suffix,f=u===void 0?"":u,c=t.getExtension(e),d=function(){var v=h[m],g="".concat(v).concat(f),_=null;v==="meta"||typeof t[v]=="function"||(c&&typeof c[g]=="function"?_=function(){return c[g].apply(c,arguments)}:typeof i[v]=="function"&&(_=i[v].bind(n))),_&&(n[v]=_,a[v]=_)},m=0,h=Object.keys(i);m<h.length;m++)d()}function Da(t){if(Array.isArray(t))return t}function Pa(t,r){var e=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,o,s;try{for(e=e.call(t);!(a=(o=e.next()).done)&&(n.push(o.value),!(r&&n.length===r));a=!0);}catch(u){i=!0,s=u}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw s}}return n}}function Ga(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ae(t,r){return Da(t)||Pa(t,r)||br(t,r)||Ga()}var P,S,je,An=(P={},l(P,3042,!1),l(P,32773,new Float32Array([0,0,0,0])),l(P,32777,32774),l(P,34877,32774),l(P,32969,1),l(P,32968,0),l(P,32971,1),l(P,32970,0),l(P,3106,new Float32Array([0,0,0,0])),l(P,3107,[!0,!0,!0,!0]),l(P,2884,!1),l(P,2885,1029),l(P,2929,!1),l(P,2931,1),l(P,2932,513),l(P,2928,new Float32Array([0,1])),l(P,2930,!0),l(P,3024,!0),l(P,36006,null),l(P,2886,2305),l(P,33170,4352),l(P,2849,1),l(P,32823,!1),l(P,32824,0),l(P,10752,0),l(P,32938,1),l(P,32939,!1),l(P,3089,!1),l(P,3088,new Int32Array([0,0,1024,1024])),l(P,2960,!1),l(P,2961,0),l(P,2968,4294967295),l(P,36005,4294967295),l(P,2962,519),l(P,2967,0),l(P,2963,4294967295),l(P,34816,519),l(P,36003,0),l(P,36004,4294967295),l(P,2964,7680),l(P,2965,7680),l(P,2966,7680),l(P,34817,7680),l(P,34818,7680),l(P,34819,7680),l(P,2978,[0,0,1024,1024]),l(P,3333,4),l(P,3317,4),l(P,37440,!1),l(P,37441,!1),l(P,37443,37444),l(P,35723,4352),l(P,36010,null),l(P,35977,!1),l(P,3330,0),l(P,3332,0),l(P,3331,0),l(P,3314,0),l(P,32878,0),l(P,3316,0),l(P,3315,0),l(P,32877,0),P),At=function(r,e,n){return e?r.enable(n):r.disable(n)},ou=function(r,e,n){return r.hint(n,e)},Ge=function(r,e,n){return r.pixelStorei(n,e)},bh=function(r,e){var n=X(r)?36009:36160;return r.bindFramebuffer(n,e)},_h=function(r,e){return r.bindFramebuffer(36008,e)};function xr(t){return Array.isArray(t)||ArrayBuffer.isView(t)}var su=(S={},l(S,3042,At),l(S,32773,function(r,e){return r.blendColor.apply(r,Y(e))}),l(S,32777,"blendEquation"),l(S,34877,"blendEquation"),l(S,32969,"blendFunc"),l(S,32968,"blendFunc"),l(S,32971,"blendFunc"),l(S,32970,"blendFunc"),l(S,3106,function(r,e){return r.clearColor.apply(r,Y(e))}),l(S,3107,function(r,e){return r.colorMask.apply(r,Y(e))}),l(S,2884,At),l(S,2885,function(r,e){return r.cullFace(e)}),l(S,2929,At),l(S,2931,function(r,e){return r.clearDepth(e)}),l(S,2932,function(r,e){return r.depthFunc(e)}),l(S,2928,function(r,e){return r.depthRange.apply(r,Y(e))}),l(S,2930,function(r,e){return r.depthMask(e)}),l(S,3024,At),l(S,35723,ou),l(S,36006,bh),l(S,2886,function(r,e){return r.frontFace(e)}),l(S,33170,ou),l(S,2849,function(r,e){return r.lineWidth(e)}),l(S,32823,At),l(S,32824,"polygonOffset"),l(S,10752,"polygonOffset"),l(S,35977,At),l(S,32938,"sampleCoverage"),l(S,32939,"sampleCoverage"),l(S,3089,At),l(S,3088,function(r,e){return r.scissor.apply(r,Y(e))}),l(S,2960,At),l(S,2961,function(r,e){return r.clearStencil(e)}),l(S,2968,function(r,e){return r.stencilMaskSeparate(1028,e)}),l(S,36005,function(r,e){return r.stencilMaskSeparate(1029,e)}),l(S,2962,"stencilFuncFront"),l(S,2967,"stencilFuncFront"),l(S,2963,"stencilFuncFront"),l(S,34816,"stencilFuncBack"),l(S,36003,"stencilFuncBack"),l(S,36004,"stencilFuncBack"),l(S,2964,"stencilOpFront"),l(S,2965,"stencilOpFront"),l(S,2966,"stencilOpFront"),l(S,34817,"stencilOpBack"),l(S,34818,"stencilOpBack"),l(S,34819,"stencilOpBack"),l(S,2978,function(r,e){return r.viewport.apply(r,Y(e))}),l(S,3333,Ge),l(S,3317,Ge),l(S,37440,Ge),l(S,37441,Ge),l(S,37443,Ge),l(S,3330,Ge),l(S,3332,Ge),l(S,3331,Ge),l(S,36010,_h),l(S,3314,Ge),l(S,32878,Ge),l(S,3316,Ge),l(S,3315,Ge),l(S,32877,Ge),l(S,"framebuffer",function(r,e){var n=e&&"handle"in e?e.handle:e;return r.bindFramebuffer(36160,n)}),l(S,"blend",function(r,e){return e?r.enable(3042):r.disable(3042)}),l(S,"blendColor",function(r,e){return r.blendColor.apply(r,Y(e))}),l(S,"blendEquation",function(r,e){e=xr(e)?e:[e,e],r.blendEquationSeparate.apply(r,Y(e))}),l(S,"blendFunc",function(r,e){e=xr(e)&&e.length===2?[].concat(Y(e),Y(e)):e,r.blendFuncSeparate.apply(r,Y(e))}),l(S,"clearColor",function(r,e){return r.clearColor.apply(r,Y(e))}),l(S,"clearDepth",function(r,e){return r.clearDepth(e)}),l(S,"clearStencil",function(r,e){return r.clearStencil(e)}),l(S,"colorMask",function(r,e){return r.colorMask.apply(r,Y(e))}),l(S,"cull",function(r,e){return e?r.enable(2884):r.disable(2884)}),l(S,"cullFace",function(r,e){return r.cullFace(e)}),l(S,"depthTest",function(r,e){return e?r.enable(2929):r.disable(2929)}),l(S,"depthFunc",function(r,e){return r.depthFunc(e)}),l(S,"depthMask",function(r,e){return r.depthMask(e)}),l(S,"depthRange",function(r,e){return r.depthRange.apply(r,Y(e))}),l(S,"dither",function(r,e){return e?r.enable(3024):r.disable(3024)}),l(S,"derivativeHint",function(r,e){r.hint(35723,e)}),l(S,"frontFace",function(r,e){return r.frontFace(e)}),l(S,"mipmapHint",function(r,e){return r.hint(33170,e)}),l(S,"lineWidth",function(r,e){return r.lineWidth(e)}),l(S,"polygonOffsetFill",function(r,e){return e?r.enable(32823):r.disable(32823)}),l(S,"polygonOffset",function(r,e){return r.polygonOffset.apply(r,Y(e))}),l(S,"sampleCoverage",function(r,e){return r.sampleCoverage.apply(r,Y(e))}),l(S,"scissorTest",function(r,e){return e?r.enable(3089):r.disable(3089)}),l(S,"scissor",function(r,e){return r.scissor.apply(r,Y(e))}),l(S,"stencilTest",function(r,e){return e?r.enable(2960):r.disable(2960)}),l(S,"stencilMask",function(r,e){e=xr(e)?e:[e,e];var n=e,a=ae(n,2),i=a[0],o=a[1];r.stencilMaskSeparate(1028,i),r.stencilMaskSeparate(1029,o)}),l(S,"stencilFunc",function(r,e){e=xr(e)&&e.length===3?[].concat(Y(e),Y(e)):e;var n=e,a=ae(n,6),i=a[0],o=a[1],s=a[2],u=a[3],f=a[4],c=a[5];r.stencilFuncSeparate(1028,i,o,s),r.stencilFuncSeparate(1029,u,f,c)}),l(S,"stencilOp",function(r,e){e=xr(e)&&e.length===3?[].concat(Y(e),Y(e)):e;var n=e,a=ae(n,6),i=a[0],o=a[1],s=a[2],u=a[3],f=a[4],c=a[5];r.stencilOpSeparate(1028,i,o,s),r.stencilOpSeparate(1029,u,f,c)}),l(S,"viewport",function(r,e){return r.viewport.apply(r,Y(e))}),S);function ye(t,r,e){return r[t]!==void 0?r[t]:e[t]}var uu={blendEquation:function(r,e,n){return r.blendEquationSeparate(ye(32777,e,n),ye(34877,e,n))},blendFunc:function(r,e,n){return r.blendFuncSeparate(ye(32969,e,n),ye(32968,e,n),ye(32971,e,n),ye(32970,e,n))},polygonOffset:function(r,e,n){return r.polygonOffset(ye(32824,e,n),ye(10752,e,n))},sampleCoverage:function(r,e,n){return r.sampleCoverage(ye(32938,e,n),ye(32939,e,n))},stencilFuncFront:function(r,e,n){return r.stencilFuncSeparate(1028,ye(2962,e,n),ye(2967,e,n),ye(2963,e,n))},stencilFuncBack:function(r,e,n){return r.stencilFuncSeparate(1029,ye(34816,e,n),ye(36003,e,n),ye(36004,e,n))},stencilOpFront:function(r,e,n){return r.stencilOpSeparate(1028,ye(2964,e,n),ye(2965,e,n),ye(2966,e,n))},stencilOpBack:function(r,e,n){return r.stencilOpSeparate(1029,ye(34817,e,n),ye(34818,e,n),ye(34819,e,n))}},ka={enable:function(r,e){return r(l({},e,!0))},disable:function(r,e){return r(l({},e,!1))},pixelStorei:function(r,e,n){return r(l({},e,n))},hint:function(r,e,n){return r(l({},e,n))},bindFramebuffer:function(r,e,n){var a;switch(e){case 36160:return r((a={},l(a,36006,n),l(a,36010,n),a));case 36009:return r(l({},36006,n));case 36008:return r(l({},36010,n));default:return null}},blendColor:function(r,e,n,a,i){return r(l({},32773,new Float32Array([e,n,a,i])))},blendEquation:function(r,e){var n;return r((n={},l(n,32777,e),l(n,34877,e),n))},blendEquationSeparate:function(r,e,n){var a;return r((a={},l(a,32777,e),l(a,34877,n),a))},blendFunc:function(r,e,n){var a;return r((a={},l(a,32969,e),l(a,32968,n),l(a,32971,e),l(a,32970,n),a))},blendFuncSeparate:function(r,e,n,a,i){var o;return r((o={},l(o,32969,e),l(o,32968,n),l(o,32971,a),l(o,32970,i),o))},clearColor:function(r,e,n,a,i){return r(l({},3106,new Float32Array([e,n,a,i])))},clearDepth:function(r,e){return r(l({},2931,e))},clearStencil:function(r,e){return r(l({},2961,e))},colorMask:function(r,e,n,a,i){return r(l({},3107,[e,n,a,i]))},cullFace:function(r,e){return r(l({},2885,e))},depthFunc:function(r,e){return r(l({},2932,e))},depthRange:function(r,e,n){return r(l({},2928,new Float32Array([e,n])))},depthMask:function(r,e){return r(l({},2930,e))},frontFace:function(r,e){return r(l({},2886,e))},lineWidth:function(r,e){return r(l({},2849,e))},polygonOffset:function(r,e,n){var a;return r((a={},l(a,32824,e),l(a,10752,n),a))},sampleCoverage:function(r,e,n){var a;return r((a={},l(a,32938,e),l(a,32939,n),a))},scissor:function(r,e,n,a,i){return r(l({},3088,new Int32Array([e,n,a,i])))},stencilMask:function(r,e){var n;return r((n={},l(n,2968,e),l(n,36005,e),n))},stencilMaskSeparate:function(r,e,n){return r(l({},e===1028?2968:36005,n))},stencilFunc:function(r,e,n,a){var i;return r((i={},l(i,2962,e),l(i,2967,n),l(i,2963,a),l(i,34816,e),l(i,36003,n),l(i,36004,a),i))},stencilFuncSeparate:function(r,e,n,a,i){var o;return r((o={},l(o,e===1028?2962:34816,n),l(o,e===1028?2967:36003,a),l(o,e===1028?2963:36004,i),o))},stencilOp:function(r,e,n,a){var i;return r((i={},l(i,2964,e),l(i,2965,n),l(i,2966,a),l(i,34817,e),l(i,34818,n),l(i,34819,a),i))},stencilOpSeparate:function(r,e,n,a,i){var o;return r((o={},l(o,e===1028?2964:34817,n),l(o,e===1028?2965:34818,a),l(o,e===1028?2966:34819,i),o))},viewport:function(r,e,n,a,i){return r(l({},2978,[e,n,a,i]))}},tt=function(r,e){return r.isEnabled(e)},Ua=(je={},l(je,3042,tt),l(je,2884,tt),l(je,2929,tt),l(je,3024,tt),l(je,32823,tt),l(je,32926,tt),l(je,32928,tt),l(je,3089,tt),l(je,2960,tt),l(je,35977,tt),je);function Na(t){for(var r in t)return!1;return!0}function fu(t,r){if(t===r)return!0;var e=Array.isArray(t)||ArrayBuffer.isView(t),n=Array.isArray(r)||ArrayBuffer.isView(r);if(e&&n&&t.length===r.length){for(var a=0;a<t.length;++a)if(t[a]!==r[a])return!1;return!0}return!1}function cu(t,r){var e=t[r].bind(t);t[r]=function(){var a=arguments.length<=0?void 0:arguments[0];return a in t.state.cache&&t.state.enable?t.state.cache[a]:e.apply(void 0,arguments)},Object.defineProperty(t[r],"name",{value:"".concat(r,"-from-cache"),configurable:!1})}function Bh(t,r,e){var n=t[r].bind(t);t[r]=function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];var u=e.apply(void 0,[t.state._updateCache].concat(o)),f=u.valueChanged,c=u.oldValue;return f&&n.apply(void 0,o),c},Object.defineProperty(t[r],"name",{value:"".concat(r,"-to-cache"),configurable:!1})}function Eh(t){var r=t.useProgram.bind(t);t.useProgram=function(n){t.state.program!==n&&(r(n),t.state.program=n)}}var xh=function(){function t(r){y(this,t);var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.copyState,a=n===void 0?!1:n,i=e.log,o=i===void 0?function(){}:i;this.gl=r,this.program=null,this.stateStack=[],this.enable=!0,this.cache=a?Va(r):Object.assign({},An),this.log=o,this._updateCache=this._updateCache.bind(this),Object.seal(this)}return E(t,[{key:"push",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.stateStack.push({})}},{key:"pop",value:function(){Be(this.stateStack.length>0);var e=this.stateStack[this.stateStack.length-1];bn(this.gl,e),this.stateStack.pop()}},{key:"_updateCache",value:function(e){var n=!1,a,i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(var o in e){Be(o!==void 0);var s=e[o],u=this.cache[o];fu(s,u)||(n=!0,a=u,i&&!(o in i)&&(i[o]=u),this.cache[o]=s)}return{valueChanged:n,oldValue:a}}}]),t}();function Ha(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=r.enable,n=e===void 0?!0:e,a=r.copyState;if(Be(a!==void 0),!t.state){var i=globalThis.polyfillContext;i&&i(t),t.state=new xh(t,{copyState:a}),Eh(t);for(var o in ka){var s=ka[o];Bh(t,o,s)}cu(t,"getParameter"),cu(t,"isEnabled")}return t.state.enable=n,t}function ja(t){t.state||Ha(t,{copyState:!1}),t.state.push()}function yn(t){Be(t.state),t.state.pop()}function Th(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Ch(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Ch(t,r){if(t){if(typeof t=="string")return lu(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return lu(t,r)}}function lu(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function bn(t,r){if(Be(er(t),"setParameters requires a WebGL context"),!Na(r)){var e={};for(var n in r){var a=Number(n),i=su[n];i&&(typeof i=="string"?e[i]=!0:i(t,r[n],a))}var o=t.state&&t.state.cache;if(o)for(var s in e){var u=uu[s];u(t,r,o)}}}function Va(t,r){if(r=r||An,typeof r=="number"){var e=r,n=Ua[e];return n?n(t,e):t.getParameter(e)}var a=Array.isArray(r)?r:Object.keys(r),i={},o=Th(a),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,f=Ua[u];i[u]=f?f(t,Number(u)):t.getParameter(Number(u))}}catch(c){o.e(c)}finally{o.f()}return i}function We(t,r,e){if(Na(r))return e(t);var n=r.nocatch,a=n===void 0?!0:n;ja(t),bn(t,r);var i;if(a)i=e(t),yn(t);else try{i=e(t)}finally{yn(t)}return i}var uB=Ce();function Tr(){var t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){var r=process.hrtime();t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}var _n=function(){function t(r,e){y(this,t),l(this,"name",void 0),l(this,"type",void 0),l(this,"sampleSize",1),l(this,"time",void 0),l(this,"count",void 0),l(this,"samples",void 0),l(this,"lastTiming",void 0),l(this,"lastSampleTime",void 0),l(this,"lastSampleCount",void 0),l(this,"_count",0),l(this,"_time",0),l(this,"_samples",0),l(this,"_startTime",0),l(this,"_timerPending",!1),this.name=r,this.type=e,this.reset()}return E(t,[{key:"setSampleSize",value:function(e){return this.sampleSize=e,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(e){return this._count+=e,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(e){return this._count-=e,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Tr(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Tr()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),t}();var Ja=function(){function t(r){y(this,t),l(this,"id",void 0),l(this,"stats",{}),this.id=r.id,this.stats={},this._initializeStats(r.stats),Object.seal(this)}return E(t,[{key:"get",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}},{key:"size",get:function(){return Object.keys(this.stats).length}},{key:"reset",value:function(){for(var e in this.stats)this.stats[e].reset();return this}},{key:"forEach",value:function(e){for(var n in this.stats)e(this.stats[n])}},{key:"getTable",value:function(){var e={};return this.forEach(function(n){e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}},{key:"_initializeStats",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];n.forEach(function(a){return e._getOrCreate(a)})}},{key:"_getOrCreate",value:function(e){if(!e||!e.name)return null;var n=e.name,a=e.type;return this.stats[n]||(e instanceof _n?this.stats[n]=e:this.stats[n]=new _n(n,a)),this.stats[n]}}]),t}();var Cr="8.5.20",Sh="set luma.log.level=1 (or higher) to trace rendering",Mh=function(){function t(){y(this,t),this.stats=new Map}return E(t,[{key:"get",value:function(e){return this.stats.has(e)||this.stats.set(e,new Ja({id:e})),this.stats.get(e)}}]),t}(),rr=new Mh;if(globalThis.luma&&globalThis.luma.VERSION!==Cr)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Cr));globalThis.luma||(Ce()&&F.log(1,"luma.gl ".concat(Cr," - ").concat(Sh))(),globalThis.luma=globalThis.luma||{VERSION:Cr,version:Cr,log:F,stats:rr,globals:{modules:{},nodeIO:{}}});var XB=globalThis.luma;function M(t,r){if(!t)throw new Error(r||"luma.gl: assertion failed.")}function Bn(t,r){if(typeof r!="string")return r;var e=Number(r);if(!isNaN(e))return e;r=r.replace(/^.*\./,"");var n=t[r];return M(n!==void 0,"Accessing undefined constant GL.".concat(r)),n}function Ve(t,r){r=Number(r);for(var e in t)if(t[e]===r)return"GL.".concat(e);return String(r)}var Xa={};function Oe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";Xa[t]=Xa[t]||1;var r=Xa[t]++;return"".concat(t,"-").concat(r)}function za(t){return M(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function nr(t){var r=!0;for(var e in t){r=!1;break}return r}function En(t,r,e,n){var a="See luma.gl ".concat(e," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),i=Object.getPrototypeOf(t);n.forEach(function(o){i.methodName||(i[o]=function(){throw F.removed("Calling removed method ".concat(r,".").concat(o,": "),a)(),new Error(o)})})}function Rh(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Ih(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Ih(t,r){if(t){if(typeof t=="string")return du(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return du(t,r)}}function du(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var ar="Resource subclass must define virtual methods",Re=function(t){function r(e){y(this,r);var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};wt(e);var a=n.id,i=n.userData,o=i===void 0?{}:i;this.gl=e,this.gl2=e,this.id=a||Oe(this[Symbol.toStringTag]),this.userData=o,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}return E(r,[{key:t,get:function(){return"Resource"}},{key:"toString",value:function(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}},{key:"handle",get:function(){return this._handle}},{key:"delete",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=n.deleteChildren,i=a===void 0?!1:a,o=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,o&&i&&o.filter(Boolean).forEach(function(s){return s.delete()}),this}},{key:"bind",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof n!="function")return this._bindHandle(n),this;var a;return this._bound?a=n():(this._bindHandle(this.handle),this._bound=!0,a=n(),this._bound=!1,this._bindHandle(null)),a}},{key:"unbind",value:function(){this.bind(null)}},{key:"getParameter",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};n=Bn(this.gl,n),M(n);var i=this.constructor.PARAMETERS||{},o=i[n];if(o){var s=X(this.gl),u=(!("webgl2"in o)||s)&&(!("extension"in o)||this.gl.getExtension(o.extension));if(!u){var f=o.webgl1,c="webgl2"in o?o.webgl2:o.webgl1,d=s?c:f;return d}}return this._getParameter(n,a)}},{key:"getParameters",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=n.parameters,i=n.keys,o=this.constructor.PARAMETERS||{},s=X(this.gl),u={},f=a||Object.keys(o),c=Rh(f),d;try{for(c.s();!(d=c.n()).done;){var m=d.value,h=o[m],p=h&&(!("webgl2"in h)||s)&&(!("extension"in h)||this.gl.getExtension(h.extension));if(p){var v=i?Ve(this.gl,m):m;u[v]=this.getParameter(m,n),i&&h.type==="GLenum"&&(u[v]=Ve(this.gl,u[v]))}}}catch(g){c.e(g)}finally{c.f()}return u}},{key:"setParameter",value:function(n,a){n=Bn(this.gl,n),M(n);var i=this.constructor.PARAMETERS||{},o=i[n];if(o){var s=X(this.gl),u=(!("webgl2"in o)||s)&&(!("extension"in o)||this.gl.getExtension(o.extension));if(!u)throw new Error("Parameter not available on this platform");o.type==="GLenum"&&(a=Bn(a))}return this._setParameter(n,a),this}},{key:"setParameters",value:function(n){for(var a in n)this.setParameter(a,n[a]);return this}},{key:"stubRemovedMethods",value:function(n,a,i){return En(this,n,a,i)}},{key:"initialize",value:function(n){}},{key:"_createHandle",value:function(){throw new Error(ar)}},{key:"_deleteHandle",value:function(){throw new Error(ar)}},{key:"_bindHandle",value:function(n){throw new Error(ar)}},{key:"_getOptsFromHandle",value:function(){throw new Error(ar)}},{key:"_getParameter",value:function(n,a){throw new Error(ar)}},{key:"_setParameter",value:function(n,a){throw new Error(ar)}},{key:"_context",value:function(){return this.gl.luma=this.gl.luma||{},this.gl.luma}},{key:"_addStats",value:function(){var n=this[Symbol.toStringTag],a=rr.get("Resource Counts");a.get("Resources Created").incrementCount(),a.get("".concat(n,"s Created")).incrementCount(),a.get("".concat(n,"s Active")).incrementCount()}},{key:"_removeStats",value:function(){var n=this[Symbol.toStringTag],a=rr.get("Resource Counts");a.get("".concat(n,"s Active")).decrementCount()}},{key:"_trackAllocatedMemory",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(n,a),this._trackAllocatedMemoryForContext(n,a,this.gl.canvas&&this.gl.canvas.id),this.byteLength=n}},{key:"_trackAllocatedMemoryForContext",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",o=rr.get("Memory Usage".concat(i));o.get("GPU Memory").addCount(n),o.get("".concat(a," Memory")).addCount(n)}},{key:"_trackDeallocatedMemory",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(n),this._trackDeallocatedMemoryForContext(n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}},{key:"_trackDeallocatedMemoryForContext",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=rr.get("Memory Usage".concat(a));i.get("GPU Memory").subtractCount(this.byteLength),i.get("".concat(n," Memory")).subtractCount(this.byteLength)}}]),r}(Symbol.toStringTag);function Wa(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ir(t,r,e){return Wa()?ir=Reflect.construct:ir=function(a,i,o){var s=[null];s.push.apply(s,i);var u=Function.bind.apply(a,s),f=new u;return o&&Rt(f,o.prototype),f},ir.apply(null,arguments)}var Oh="Failed to deduce GL constant from typed array";function Sr(t){var r=ArrayBuffer.isView(t)?t.constructor:t;switch(r){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(Oh)}}function yt(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=r.clamped,n=e===void 0?!0:e;switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function mu(t){var r=t.data,e=t.width,n=t.height,a=t.bytesPerPixel,i=a===void 0?4:a,o=t.temp,s=e*i;o=o||new Uint8Array(s);for(var u=0;u<n/2;++u){var f=u*s,c=(n-u-1)*s;o.set(r.subarray(f,f+s)),r.copyWithin(f,c,c+s),r.set(o,c)}}function hu(t){for(var r=t.data,e=t.width,n=t.height,a=Math.round(e/2),i=Math.round(n/2),o=new Uint8Array(a*i*4),s=0;s<i;s++)for(var u=0;u<a;u++)for(var f=0;f<4;f++)o[(s*a+u)*4+f]=r[(s*2*e+u*2)*4+f];return{data:o,width:a,height:i}}function Mr(t,r,e){var n=e.removedProps,a=n===void 0?{}:n,i=e.deprecatedProps,o=i===void 0?{}:i,s=e.replacedProps,u=s===void 0?{}:s;for(var f in a)if(f in r){var c=a[f],d=c?"".concat(t,".").concat(a[f]):"N/A";F.removed("".concat(t,".").concat(f),d)()}for(var m in o)if(m in r){var h=o[m];F.deprecated("".concat(t,".").concat(m),"".concat(t,".").concat(h))()}var p=null;for(var v in u)if(v in r){var g=u[v];F.deprecated("".concat(t,".").concat(v),"".concat(t,".").concat(g))(),p=p||Object.assign({},r),p[g]=r[v],delete p[v]}return p||r}var wh={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Fh={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}},we=function(){function t(){var r=this;y(this,t);for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];n.forEach(function(i){return r._assign(i)}),Object.freeze(this)}return E(t,[{key:"toString",value:function(){return JSON.stringify(this)}},{key:"BYTES_PER_ELEMENT",get:function(){return t.getBytesPerElement(this)}},{key:"BYTES_PER_VERTEX",get:function(){return t.getBytesPerVertex(this)}},{key:"_assign",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=Mr("Accessor",e,Fh),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}],[{key:"getBytesPerElement",value:function(e){var n=yt(e.type||5126);return n.BYTES_PER_ELEMENT}},{key:"getBytesPerVertex",value:function(e){M(e.size);var n=yt(e.type||5126);return n.BYTES_PER_ELEMENT*e.size}},{key:"resolve",value:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return ir(t,[wh].concat(n))}}]),t}();function Lh(t){var r=Dh();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function Dh(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var pu=10,vu={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Ph={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:vu},Gh={removedProps:vu},le=function(t,r){w(n,t);var e=Lh(n);function n(a){var i;y(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i=e.call(this,a,o),i.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),i.target=o.target||(i.gl.webgl2?36662:34962),i.initialize(o),Object.seal(Z(i)),i}return E(n,[{key:r,get:function(){return"Buffer"}},{key:"getElementCount",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/we.getBytesPerElement(i))}},{key:"getVertexCount",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/we.getBytesPerVertex(i))}},{key:"initialize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(i)&&(i={data:i}),Number.isFinite(i)&&(i={byteLength:i}),i=Mr("Buffer",i,Ph),this.usage=i.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},i,i.accessor)),i.data?this._setData(i.data,i.offset,i.byteLength):this._setByteLength(i.byteLength||0),this}},{key:"setProps",value:function(i){return i=Mr("Buffer",i,Gh),"accessor"in i&&this.setAccessor(i.accessor),this}},{key:"setAccessor",value:function(i){return i=Object.assign({},i),delete i.buffer,this.accessor=new we(i),this}},{key:"reallocate",value:function(i){return i>this.byteLength?(this._setByteLength(i),!0):(this.bytesUsed=i,!1)}},{key:"setData",value:function(i){return this.initialize(i)}},{key:"subData",value:function(i){ArrayBuffer.isView(i)&&(i={data:i});var o=i,s=o.data,u=o.offset,f=u===void 0?0:u,c=o.srcOffset,d=c===void 0?0:c,m=i.byteLength||i.length;M(s);var h=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(h,this.handle),d!==0||m!==void 0?(Ae(this.gl),this.gl.bufferSubData(this.target,f,s,d,m)):this.gl.bufferSubData(h,f,s),this.gl.bindBuffer(h,null),this.debugData=null,this._inferType(s),this}},{key:"copyData",value:function(i){var o=i.sourceBuffer,s=i.readOffset,u=s===void 0?0:s,f=i.writeOffset,c=f===void 0?0:f,d=i.size,m=this.gl;return Ae(m),m.bindBuffer(36662,o.handle),m.bindBuffer(36663,this.handle),m.copyBufferSubData(36662,36663,u,c,d),m.bindBuffer(36662,null),m.bindBuffer(36663,null),this.debugData=null,this}},{key:"getData",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.dstData,s=o===void 0?null:o,u=i.srcByteOffset,f=u===void 0?0:u,c=i.dstOffset,d=c===void 0?0:c,m=i.length,h=m===void 0?0:m;Ae(this.gl);var p=yt(this.accessor.type||5126,{clamped:!1}),v=this._getAvailableElementCount(f),g=d,_,b;s?(b=s.length,_=b-g):(_=Math.min(v,h||v),b=g+_);var C=Math.min(v,_);return h=h||C,M(h<=C),s=s||new p(b),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,f,s,d,h),this.gl.bindBuffer(36662,null),s}},{key:"bind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.target,s=o===void 0?this.target:o,u=i.index,f=u===void 0?this.accessor&&this.accessor.index:u,c=i.offset,d=c===void 0?0:c,m=i.size;return s===35345||s===35982?m!==void 0?this.gl.bindBufferRange(s,f,this.handle,d,m):(M(d===0),this.gl.bindBufferBase(s,f,this.handle)):this.gl.bindBuffer(s,this.handle),this}},{key:"unbind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.target,s=o===void 0?this.target:o,u=i.index,f=u===void 0?this.accessor&&this.accessor.index:u,c=s===35345||s===35982;return c?this.gl.bindBufferBase(s,f,null):this.gl.bindBuffer(s,null),this}},{key:"getDebugData",value:function(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(pu,this.byteLength)}),{data:this.debugData,changed:!0})}},{key:"invalidateDebugData",value:function(){this.debugData=null}},{key:"_setData",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i.byteLength+o;M(ArrayBuffer.isView(i)),this._trackDeallocatedMemory();var u=this._getTarget();this.gl.bindBuffer(u,this.handle),this.gl.bufferData(u,s,this.usage),this.gl.bufferSubData(u,o,i),this.gl.bindBuffer(u,null),this.debugData=i.slice(0,pu),this.bytesUsed=s,this._trackAllocatedMemory(s);var f=Sr(i);return M(f),this.setAccessor(new we(this.accessor,{type:f})),this}},{key:"_setByteLength",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;M(i>=0),this._trackDeallocatedMemory();var s=i;i===0&&(s=new Float32Array(0));var u=this._getTarget();return this.gl.bindBuffer(u,this.handle),this.gl.bufferData(u,s,o),this.gl.bindBuffer(u,null),this.usage=o,this.debugData=null,this.bytesUsed=i,this._trackAllocatedMemory(i),this}},{key:"_getTarget",value:function(){return this.gl.webgl2?36663:this.target}},{key:"_getAvailableElementCount",value:function(i){var o=yt(this.accessor.type||5126,{clamped:!1}),s=i/o.BYTES_PER_ELEMENT;return this.getElementCount()-s}},{key:"_inferType",value:function(i){this.accessor.type||this.setAccessor(new we(this.accessor,{type:Sr(i)}))}},{key:"_createHandle",value:function(){return this.gl.createBuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}},{key:"_getParameter",value:function(i){this.gl.bindBuffer(this.target,this.handle);var o=this.gl.getBufferParameter(this.target,i);return this.gl.bindBuffer(this.target,null),o}},{key:"type",get:function(){return F.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}},{key:"bytes",get:function(){return F.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}},{key:"setByteLength",value:function(i){return F.deprecated("setByteLength","reallocate")(),this.reallocate(i)}},{key:"updateAccessor",value:function(i){return F.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new we(this.accessor,i),this}}]),n}(Re,Symbol.toStringTag);var Ke,Fe,rt,xn=(Ke={},l(Ke,6407,{dataFormat:6407,types:[5121,33635]}),l(Ke,6408,{dataFormat:6408,types:[5121,32819,32820]}),l(Ke,6406,{dataFormat:6406,types:[5121]}),l(Ke,6409,{dataFormat:6409,types:[5121]}),l(Ke,6410,{dataFormat:6410,types:[5121]}),l(Ke,33326,{dataFormat:6403,types:[5126],gl2:!0}),l(Ke,33328,{dataFormat:33319,types:[5126],gl2:!0}),l(Ke,34837,{dataFormat:6407,types:[5126],gl2:!0}),l(Ke,34836,{dataFormat:6408,types:[5126],gl2:!0}),Ke),gu=(Fe={},l(Fe,6403,1),l(Fe,36244,1),l(Fe,33319,2),l(Fe,33320,2),l(Fe,6407,3),l(Fe,36248,3),l(Fe,6408,4),l(Fe,36249,4),l(Fe,6402,1),l(Fe,34041,1),l(Fe,6406,1),l(Fe,6409,1),l(Fe,6410,2),Fe),Au=(rt={},l(rt,5126,4),l(rt,5125,4),l(rt,5124,4),l(rt,5123,2),l(rt,5122,2),l(rt,5131,2),l(rt,5120,1),l(rt,5121,1),rt);function yu(t,r){var e=xn[r];if(!e)return!1;if(e.gl1===void 0&&e.gl2===void 0)return!0;var n=X(t)&&e.gl2||e.gl1;return typeof n=="string"?t.getExtension(n):n}function bu(t,r){var e=xn[r];switch(e&&e.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}function kh(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Uh(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Uh(t,r){if(t){if(typeof t=="string")return _u(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return _u(t,r)}}function _u(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Nh(t){var r=Hh();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function Hh(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jh=[9729,9728],Bu=globalThis.WebGLBuffer||function(){},Lt=function(t,r){w(n,t);var e=Nh(n);function n(a,i){var o;y(this,n);var s=i.id,u=s===void 0?Oe("texture"):s,f=i.handle,c=i.target;return o=e.call(this,a,{id:u,handle:f}),o.target=c,o.textureUnit=void 0,o.loaded=!1,o.width=void 0,o.height=void 0,o.depth=void 0,o.format=void 0,o.type=void 0,o.dataFormat=void 0,o.border=void 0,o.textureUnit=void 0,o.mipmaps=void 0,o}return E(n,[{key:r,get:function(){return"Texture"}},{key:"toString",value:function(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}},{key:"initialize",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=o.data;if(s instanceof Promise)return s.then(function(I){return i.initialize(Object.assign({},o,{pixels:I,data:I}))}),this;var u=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement;if(u&&s.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,s.addEventListener("loadeddata",function(){return i.initialize(o)}),this;var f=o.pixels,c=f===void 0?null:f,d=o.format,m=d===void 0?6408:d,h=o.border,p=h===void 0?0:h,v=o.recreate,g=v===void 0?!1:v,_=o.parameters,b=_===void 0?{}:_,C=o.pixelStore,x=C===void 0?{}:C,T=o.textureUnit,R=T===void 0?void 0:T;s||(s=c);var D=o.width,V=o.height,U=o.dataFormat,N=o.type,J=o.compressed,L=J===void 0?!1:J,z=o.mipmaps,H=z===void 0?!0:z,se=o.depth,B=se===void 0?0:se,A=this._deduceParameters({format:m,type:N,dataFormat:U,compressed:L,data:s,width:D,height:V});return D=A.width,V=A.height,L=A.compressed,U=A.dataFormat,N=A.type,this.width=D,this.height=V,this.depth=B,this.format=m,this.type=N,this.dataFormat=U,this.border=p,this.textureUnit=R,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),H&&this._isNPOT()&&(F.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),H=!1,this._updateForNPOT(b)),this.mipmaps=H,this.setImageData({data:s,width:D,height:V,depth:B,format:m,type:N,dataFormat:U,border:p,mipmaps:H,parameters:x,compressed:L}),H&&this.generateMipmap(),this.setParameters(b),g&&(this.data=s),u&&(this._video={video:s,parameters:b,lastTime:s.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?s.currentTime:-1}),this}},{key:"update",value:function(){if(this._video){var i=this._video,o=i.video,s=i.parameters,u=i.lastTime;if(u===o.currentTime||o.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:o,parameters:s}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=o.currentTime}}},{key:"resize",value:function(i){var o=i.height,s=i.width,u=i.mipmaps,f=u===void 0?!1:u;return s!==this.width||o!==this.height?this.initialize({width:s,height:o,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:f}):this}},{key:"generateMipmap",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(F.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),We(this.gl,o,function(){i.gl.generateMipmap(i.target)}),this.gl.bindTexture(this.target,null),this)}},{key:"setImageData",value:function(i){this._trackDeallocatedMemory("Texture");var o=i.target,s=o===void 0?this.target:o,u=i.pixels,f=u===void 0?null:u,c=i.level,d=c===void 0?0:c,m=i.format,h=m===void 0?this.format:m,p=i.border,v=p===void 0?this.border:p,g=i.offset,_=g===void 0?0:g,b=i.parameters,C=b===void 0?{}:b,x=i.data,T=x===void 0?null:x,R=i.type,D=R===void 0?this.type:R,V=i.width,U=V===void 0?this.width:V,N=i.height,J=N===void 0?this.height:N,L=i.dataFormat,z=L===void 0?this.dataFormat:L,H=i.compressed,se=H===void 0?!1:H;T||(T=f);var B=this._deduceParameters({format:h,type:D,dataFormat:z,compressed:se,data:T,width:U,height:J});D=B.type,z=B.dataFormat,se=B.compressed,U=B.width,J=B.height;var A=this.gl;A.bindTexture(this.target,this.handle);var I=null,G=this._getDataType({data:T,compressed:se});T=G.data,I=G.dataType;var j,ee=0;if(We(this.gl,C,function(){switch(I){case"null":A.texImage2D(s,d,h,U,J,v,z,D,T);break;case"typed-array":A.texImage2D(s,d,h,U,J,v,z,D,T,_);break;case"buffer":j=Ae(A),j.bindBuffer(35052,T.handle||T),j.texImage2D(s,d,h,U,J,v,z,D,_),j.bindBuffer(35052,null);break;case"browser-object":X(A)?A.texImage2D(s,d,h,U,J,v,z,D,T):A.texImage2D(s,d,h,z,D,T);break;case"compressed":var be=kh(T.entries()),_e;try{for(be.s();!(_e=be.n()).done;){var qe=ae(_e.value,2),Mt=qe[0],Pe=qe[1];A.compressedTexImage2D(s,Mt,Pe.format,Pe.width,Pe.height,v,Pe.data),ee+=Pe.levelSize}}catch(Im){be.e(Im)}finally{be.f()}break;default:M(!1,"Unknown image data type")}}),I==="compressed")this._trackAllocatedMemory(ee,"Texture");else if(T&&T.byteLength)this._trackAllocatedMemory(T.byteLength,"Texture");else{var ie=gu[this.dataFormat]||4,pe=Au[this.type]||1;this._trackAllocatedMemory(this.width*this.height*ie*pe,"Texture")}return this.loaded=!0,this}},{key:"setSubImageData",value:function(i){var o=this,s=i.target,u=s===void 0?this.target:s,f=i.pixels,c=f===void 0?null:f,d=i.data,m=d===void 0?null:d,h=i.x,p=h===void 0?0:h,v=i.y,g=v===void 0?0:v,_=i.width,b=_===void 0?this.width:_,C=i.height,x=C===void 0?this.height:C,T=i.level,R=T===void 0?0:T,D=i.format,V=D===void 0?this.format:D,U=i.type,N=U===void 0?this.type:U,J=i.dataFormat,L=J===void 0?this.dataFormat:J,z=i.compressed,H=z===void 0?!1:z,se=i.offset,B=se===void 0?0:se,A=i.border,I=A===void 0?this.border:A,G=i.parameters,j=G===void 0?{}:G,ee=this._deduceParameters({format:V,type:N,dataFormat:L,compressed:H,data:m,width:b,height:x});if(N=ee.type,L=ee.dataFormat,H=ee.compressed,b=ee.width,x=ee.height,M(this.depth===0,"texSubImage not supported for 3D textures"),m||(m=c),m&&m.data){var ie=m;m=ie.data,b=ie.shape[0],x=ie.shape[1]}m instanceof le&&(m=m.handle),this.gl.bindTexture(this.target,this.handle),We(this.gl,j,function(){if(H)o.gl.compressedTexSubImage2D(u,R,p,g,b,x,V,m);else if(m===null)o.gl.texSubImage2D(u,R,p,g,b,x,L,N,null);else if(ArrayBuffer.isView(m))o.gl.texSubImage2D(u,R,p,g,b,x,L,N,m,B);else if(m instanceof Bu){var pe=Ae(o.gl);pe.bindBuffer(35052,m),pe.texSubImage2D(u,R,p,g,b,x,L,N,B),pe.bindBuffer(35052,null)}else if(X(o.gl)){var be=Ae(o.gl);be.texSubImage2D(u,R,p,g,b,x,L,N,m)}else o.gl.texSubImage2D(u,R,p,g,L,N,m)}),this.gl.bindTexture(this.target,null)}},{key:"copyFramebuffer",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return F.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}},{key:"getActiveUnit",value:function(){return this.gl.getParameter(34016)-33984}},{key:"bind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit,o=this.gl;return i!==void 0&&(this.textureUnit=i,o.activeTexture(33984+i)),o.bindTexture(this.target,this.handle),i}},{key:"unbind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit,o=this.gl;return i!==void 0&&(this.textureUnit=i,o.activeTexture(33984+i)),o.bindTexture(this.target,null),i}},{key:"_getDataType",value:function(i){var o=i.data,s=i.compressed,u=s===void 0?!1:s;return u?{data:o,dataType:"compressed"}:o===null?{data:o,dataType:"null"}:ArrayBuffer.isView(o)?{data:o,dataType:"typed-array"}:o instanceof le?{data:o.handle,dataType:"buffer"}:o instanceof Bu?{data:o,dataType:"buffer"}:{data:o,dataType:"browser-object"}}},{key:"_deduceParameters",value:function(i){var o=i.format,s=i.data,u=i.width,f=i.height,c=i.dataFormat,d=i.type,m=i.compressed,h=xn[o];c=c||h&&h.dataFormat,d=d||h&&h.types[0],m=m||h&&h.compressed;var p=this._deduceImageSize(s,u,f);return u=p.width,f=p.height,{dataFormat:c,type:d,compressed:m,width:u,height:f,format:o,data:s}}},{key:"_deduceImageSize",value:function(i,o,s){var u;return typeof ImageData<"u"&&i instanceof ImageData?u={width:i.width,height:i.height}:typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement?u={width:i.naturalWidth,height:i.naturalHeight}:typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement?u={width:i.width,height:i.height}:typeof ImageBitmap<"u"&&i instanceof ImageBitmap?u={width:i.width,height:i.height}:typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement?u={width:i.videoWidth,height:i.videoHeight}:i?u={width:o,height:s}:u={width:o>=0?o:1,height:s>=0?s:1},M(u,"Could not deduced texture size"),M(o===void 0||u.width===o,"Deduced texture width does not match supplied width"),M(s===void 0||u.height===s,"Deduced texture height does not match supplied height"),u}},{key:"_createHandle",value:function(){return this.gl.createTexture()}},{key:"_deleteHandle",value:function(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}},{key:"_getParameter",value:function(i){switch(i){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);var o=this.gl.getTexParameter(this.target,i);return this.gl.bindTexture(this.target,null),o}}},{key:"_setParameter",value:function(i,o){switch(this.gl.bindTexture(this.target,this.handle),o=this._getNPOTParam(i,o),i){case 33082:case 33083:this.gl.texParameterf(this.handle,i,o);break;case 4096:case 4097:M(!1);break;default:this.gl.texParameteri(this.target,i,o);break}return this.gl.bindTexture(this.target,null),this}},{key:"_isNPOT",value:function(){return X(this.gl)||!this.width||!this.height?!1:!za(this.width)||!za(this.height)}},{key:"_updateForNPOT",value:function(i){i[this.gl.TEXTURE_MIN_FILTER]===void 0&&(i[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),i[this.gl.TEXTURE_WRAP_S]===void 0&&(i[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),i[this.gl.TEXTURE_WRAP_T]===void 0&&(i[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}},{key:"_getNPOTParam",value:function(i,o){if(this._isNPOT())switch(i){case 10241:jh.indexOf(o)===-1&&(o=9729);break;case 10242:case 10243:o!==33071&&(o=33071);break;default:break}return o}}],[{key:"isSupported",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=o.format,u=o.linearFiltering,f=!0;return s&&(f=f&&yu(i,s),f=f&&(!u||bu(i,s))),f}}]),n}(Re,Symbol.toStringTag);var Vh="";function Eu(t,r){return M(typeof t=="string"),t=Vh+t,new Promise(function(e,n){try{var a=new Image;a.onload=function(){return e(a)},a.onerror=function(){return n(new Error("Could not load image ".concat(t,".")))},a.crossOrigin=r&&r.crossOrigin||"anonymous",a.src=t}catch(i){n(i)}})}function Jh(t){var r=Xh();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function Xh(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Dt=function(t,r){w(n,t);var e=Jh(n);function n(a){var i;y(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return wt(a),(o instanceof Promise||typeof o=="string")&&(o={data:o}),typeof o.data=="string"&&(o=Object.assign({},o,{data:Eu(o.data)})),i=e.call(this,a,Object.assign({},o,{target:3553})),i.initialize(o),Object.seal(Z(i)),i}return E(n,[{key:r,get:function(){return"Texture2D"}}],[{key:"isSupported",value:function(i,o){return Lt.isSupported(i,o)}}]),n}(Lt,Symbol.toStringTag);function xu(t,r,e,n,a,i,o){try{var s=t[i](o),u=s.value}catch(f){e(f);return}s.done?r(u):Promise.resolve(u).then(n,a)}function k(t){return function(){var r=this,e=arguments;return new Promise(function(n,a){var i=t.apply(r,e);function o(u){xu(i,n,a,o,s,"next",u)}function s(u){xu(i,n,a,o,s,"throw",u)}o(void 0)})}}var Q,Pt="EXT_color_buffer_float",Qa=(Q={},l(Q,33189,{bpp:2}),l(Q,33190,{gl2:!0,bpp:3}),l(Q,36012,{gl2:!0,bpp:4}),l(Q,36168,{bpp:1}),l(Q,34041,{bpp:4}),l(Q,35056,{gl2:!0,bpp:4}),l(Q,36013,{gl2:!0,bpp:5}),l(Q,32854,{bpp:2}),l(Q,36194,{bpp:2}),l(Q,32855,{bpp:2}),l(Q,33321,{gl2:!0,bpp:1}),l(Q,33330,{gl2:!0,bpp:1}),l(Q,33329,{gl2:!0,bpp:1}),l(Q,33332,{gl2:!0,bpp:2}),l(Q,33331,{gl2:!0,bpp:2}),l(Q,33334,{gl2:!0,bpp:4}),l(Q,33333,{gl2:!0,bpp:4}),l(Q,33323,{gl2:!0,bpp:2}),l(Q,33336,{gl2:!0,bpp:2}),l(Q,33335,{gl2:!0,bpp:2}),l(Q,33338,{gl2:!0,bpp:4}),l(Q,33337,{gl2:!0,bpp:4}),l(Q,33340,{gl2:!0,bpp:8}),l(Q,33339,{gl2:!0,bpp:8}),l(Q,32849,{gl2:!0,bpp:3}),l(Q,32856,{gl2:!0,bpp:4}),l(Q,32857,{gl2:!0,bpp:4}),l(Q,36220,{gl2:!0,bpp:4}),l(Q,36238,{gl2:!0,bpp:4}),l(Q,36975,{gl2:!0,bpp:4}),l(Q,36214,{gl2:!0,bpp:8}),l(Q,36232,{gl2:!0,bpp:8}),l(Q,36226,{gl2:!0,bpp:16}),l(Q,36208,{gl2:!0,bpp:16}),l(Q,33325,{gl2:Pt,bpp:2}),l(Q,33327,{gl2:Pt,bpp:4}),l(Q,34842,{gl2:Pt,bpp:8}),l(Q,33326,{gl2:Pt,bpp:4}),l(Q,33328,{gl2:Pt,bpp:8}),l(Q,34836,{gl2:Pt,bpp:16}),l(Q,35898,{gl2:Pt,bpp:4}),Q);function zh(t){var r=Wh();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function Wh(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kh(t,r,e){var n=e[r];if(!n)return!1;var a=X(t)&&n.gl2||n.gl1;return typeof a=="string"?t.getExtension(a):a}var Gt=function(t,r){w(n,t);var e=zh(n);function n(a){var i;y(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i=e.call(this,a,o),i.initialize(o),Object.seal(Z(i)),i}return E(n,[{key:r,get:function(){return"Renderbuffer"}},{key:"initialize",value:function(i){var o=i.format,s=i.width,u=s===void 0?1:s,f=i.height,c=f===void 0?1:f,d=i.samples,m=d===void 0?0:d;return M(o,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),m!==0&&X(this.gl)?this.gl.renderbufferStorageMultisample(36161,m,o,u,c):this.gl.renderbufferStorage(36161,o,u,c),this.format=o,this.width=u,this.height=c,this.samples=m,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Qa[this.format].bpp),this}},{key:"resize",value:function(i){var o=i.width,s=i.height;return o!==this.width||s!==this.height?this.initialize({width:o,height:s,format:this.format,samples:this.samples}):this}},{key:"_createHandle",value:function(){return this.gl.createRenderbuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}},{key:"_bindHandle",value:function(i){this.gl.bindRenderbuffer(36161,i)}},{key:"_syncHandle",value:function(i){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}},{key:"_getParameter",value:function(i){this.gl.bindRenderbuffer(36161,this.handle);var o=this.gl.getRenderbufferParameter(36161,i);return o}}],[{key:"isSupported",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null},s=o.format;return!s||Kh(i,s,Qa)}},{key:"getSamplesForFormat",value:function(i,o){var s=o.format;return i.getInternalformatParameter(36161,s,32937)}}]),n}(Re,Symbol.toStringTag);var Yh=256,Qh=1024,$h=16384,Su=6144,Mu=6145,Ru=6146,Iu=34041,Ou="clear: bad arguments";function Rr(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=r.framebuffer,n=e===void 0?null:e,a=r.color,i=a===void 0?null:a,o=r.depth,s=o===void 0?null:o,u=r.stencil,f=u===void 0?null:u,c={};n&&(c.framebuffer=n);var d=0;i&&(d|=$h,i!==!0&&(c.clearColor=i)),s&&(d|=Yh,s!==!0&&(c.clearDepth=s)),f&&(d|=Qh,s!==!0&&(c.clearStencil=s)),M(d!==0,Ou),We(t,c,function(){t.clear(d)})}function $a(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=r.framebuffer,n=e===void 0?null:e,a=r.buffer,i=a===void 0?Su:a,o=r.drawBuffer,s=o===void 0?0:o,u=r.value,f=u===void 0?[0,0,0,0]:u;Ae(t),We(t,{framebuffer:n},function(){switch(i){case Su:switch(f.constructor){case Int32Array:t.clearBufferiv(i,s,f);break;case Uint32Array:t.clearBufferuiv(i,s,f);break;case Float32Array:default:t.clearBufferfv(i,s,f)}break;case Mu:t.clearBufferfv(Mu,0,[f]);break;case Ru:t.clearBufferiv(Ru,0,[f]);break;case Iu:var c=ae(f,2),d=c[0],m=c[1];t.clearBufferfi(Iu,0,d,m);break;default:M(!1,Ou)}})}function wu(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return M(!1),0}}function qh(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=r.sourceX,n=e===void 0?0:e,a=r.sourceY,i=a===void 0?0:a,o=r.sourceFormat,s=o===void 0?6408:o,u=r.sourceAttachment,f=u===void 0?36064:u,c=r.target,d=c===void 0?null:c,m=r.sourceWidth,h=r.sourceHeight,p=r.sourceType,v=Zh(t),g=v.framebuffer,_=v.deleteFramebuffer;M(g);var b=g.gl,C=g.handle,x=g.attachments;m=m||g.width,h=h||g.height,f===36064&&C===null&&(f=1028),M(x[f]),p=p||x[f].type,d=ep(d,p,s,m,h),p=p||Sr(d);var T=b.bindFramebuffer(36160,C);return b.readPixels(n,i,m,h,s,p,d),b.bindFramebuffer(36160,T||null),_&&g.delete(),d}function qa(t){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=r.sourceAttachment,n=e===void 0?36064:e,a=r.targetMaxHeight,i=a===void 0?Number.MAX_SAFE_INTEGER:a,o=qh(t,{sourceAttachment:n}),s=t.width,u=t.height;u>i;){var f=hu({data:o,width:s,height:u});o=f.data,s=f.width,u=f.height}mu({data:o,width:s,height:u});var c=document.createElement("canvas");c.width=s,c.height=u;var d=c.getContext("2d"),m=d.createImageData(s,u);return m.data.set(o),d.putImageData(m,0,0),c.toDataURL()}function Zh(t){return t instanceof Je?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:Fu(t),deleteFramebuffer:!0}}function ep(t,r,e,n,a){if(t)return t;r=r||5121;var i=yt(r,{clamped:!1}),o=wu(e);return new i(n*a*o)}var me,ue={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function tp(t){var r=new Dt(t,{format:6408,type:5126,dataFormat:6408}),e=new Je(t,{id:"test-framebuffer",check:!1,attachments:l({},36064,r)}),n=e.getStatus();return r.delete(),e.delete(),n===36053}var Za=(me={},l(me,ue.WEBGL2,[!1,!0]),l(me,ue.VERTEX_ARRAY_OBJECT,["OES_vertex_array_object",!0]),l(me,ue.TIMER_QUERY,["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"]),l(me,ue.INSTANCED_RENDERING,["ANGLE_instanced_arrays",!0]),l(me,ue.MULTIPLE_RENDER_TARGETS,["WEBGL_draw_buffers",!0]),l(me,ue.ELEMENT_INDEX_UINT32,["OES_element_index_uint",!0]),l(me,ue.BLEND_EQUATION_MINMAX,["EXT_blend_minmax",!0]),l(me,ue.FLOAT_BLEND,["EXT_float_blend"]),l(me,ue.COLOR_ENCODING_SRGB,["EXT_sRGB",!0]),l(me,ue.TEXTURE_DEPTH,["WEBGL_depth_texture",!0]),l(me,ue.TEXTURE_FLOAT,["OES_texture_float",!0]),l(me,ue.TEXTURE_HALF_FLOAT,["OES_texture_half_float",!0]),l(me,ue.TEXTURE_FILTER_LINEAR_FLOAT,["OES_texture_float_linear"]),l(me,ue.TEXTURE_FILTER_LINEAR_HALF_FLOAT,["OES_texture_half_float_linear"]),l(me,ue.TEXTURE_FILTER_ANISOTROPIC,["EXT_texture_filter_anisotropic"]),l(me,ue.COLOR_ATTACHMENT_RGBA32F,[tp,"EXT_color_buffer_float"]),l(me,ue.COLOR_ATTACHMENT_FLOAT,[!1,"EXT_color_buffer_float"]),l(me,ue.COLOR_ATTACHMENT_HALF_FLOAT,["EXT_color_buffer_half_float"]),l(me,ue.GLSL_FRAG_DATA,["WEBGL_draw_buffers",!0]),l(me,ue.GLSL_FRAG_DEPTH,["EXT_frag_depth",!0]),l(me,ue.GLSL_DERIVATIVES,["OES_standard_derivatives",!0]),l(me,ue.GLSL_TEXTURE_LOD,["EXT_shader_texture_lod",!0]),me);function rp(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=np(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function np(t,r){if(t){if(typeof t=="string")return Lu(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Lu(t,r)}}function Lu(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var ap=2;function or(t,r){return ei(t,r)}function ei(t,r){return r=Array.isArray(r)?r:[r],r.every(function(e){return Du(t,e)})}function Tn(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(var r in Za)t.luma.caps[r]===void 0&&(t.luma.caps[r]=Du(t,r));return t.luma.caps}function Du(t,r){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[r]===void 0&&(t.luma.caps[r]=ip(t,r)),t.luma.caps[r]||F.log(ap,"Feature: ".concat(r," not supported"))(),t.luma.caps[r]}function ip(t,r){var e=Za[r];M(e,r);var n,a=X(t)&&e[1]||e[0];if(typeof a=="function")n=a(t);else if(Array.isArray(a)){n=!0;var i=rp(a),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;n=n&&Boolean(t.getExtension(s))}}catch(u){i.e(u)}finally{i.f()}}else typeof a=="string"?n=Boolean(t.getExtension(a)):typeof a=="boolean"?n=a:M(!1);return n}function Pu(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=op(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function op(t,r){if(t){if(typeof t=="string")return Gu(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Gu(t,r)}}function Gu(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function sp(t){var r=up();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function up(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ku="Multiple render targets not supported",Je=function(t,r){w(n,t);var e=sp(n);function n(a){var i;y(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i=e.call(this,a,o),i.width=null,i.height=null,i.attachments={},i.readBuffer=36064,i.drawBuffers=[36064],i.ownResources=[],i.initialize(o),Object.seal(Z(i)),i}return E(n,[{key:r,get:function(){return"Framebuffer"}},{key:"MAX_COLOR_ATTACHMENTS",get:function(){var i=Ae(this.gl);return i.getParameter(i.MAX_COLOR_ATTACHMENTS)}},{key:"MAX_DRAW_BUFFERS",get:function(){var i=Ae(this.gl);return i.getParameter(i.MAX_DRAW_BUFFERS)}},{key:"color",get:function(){return this.attachments[36064]||null}},{key:"texture",get:function(){return this.attachments[36064]||null}},{key:"depth",get:function(){return this.attachments[36096]||this.attachments[33306]||null}},{key:"stencil",get:function(){return this.attachments[36128]||this.attachments[33306]||null}},{key:"initialize",value:function(i){var o=i.width,s=o===void 0?1:o,u=i.height,f=u===void 0?1:u,c=i.attachments,d=c===void 0?null:c,m=i.color,h=m===void 0?!0:m,p=i.depth,v=p===void 0?!0:p,g=i.stencil,_=g===void 0?!1:g,b=i.check,C=b===void 0?!0:b,x=i.readBuffer,T=x===void 0?void 0:x,R=i.drawBuffers,D=R===void 0?void 0:R;if(M(s>=0&&f>=0,"Width and height need to be integers"),this.width=s,this.height=f,d)for(var V in d){var U=d[V],N=Array.isArray(U)?U[0]:U;N.resize({width:s,height:f})}else d=this._createDefaultAttachments(h,v,_,s,f);this.update({clearAttachments:!0,attachments:d,readBuffer:T,drawBuffers:D}),d&&C&&this.checkStatus()}},{key:"delete",value:function(){var i=Pu(this.ownResources),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;s.delete()}}catch(u){i.e(u)}finally{i.f()}return ve(O(n.prototype),"delete",this).call(this),this}},{key:"update",value:function(i){var o=i.attachments,s=o===void 0?{}:o,u=i.readBuffer,f=i.drawBuffers,c=i.clearAttachments,d=c===void 0?!1:c,m=i.resizeAttachments,h=m===void 0?!0:m;this.attach(s,{clearAttachments:d,resizeAttachments:h});var p=this.gl,v=p.bindFramebuffer(36160,this.handle);return u&&this._setReadBuffer(u),f&&this._setDrawBuffers(f),p.bindFramebuffer(36160,v||null),this}},{key:"resize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.width,s=i.height;if(this.handle===null)return M(o===void 0&&s===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;o===void 0&&(o=this.gl.drawingBufferWidth),s===void 0&&(s=this.gl.drawingBufferHeight),o!==this.width&&s!==this.height&&F.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(o,"x").concat(s))();for(var u in this.attachments)this.attachments[u].resize({width:o,height:s});return this.width=o,this.height=s,this}},{key:"attach",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=s.clearAttachments,f=u===void 0?!1:u,c=s.resizeAttachments,d=c===void 0?!0:c,m={};f&&Object.keys(this.attachments).forEach(function(V){m[V]=null}),Object.assign(m,i);var h=this.gl.bindFramebuffer(36160,this.handle);for(var p in m){M(p!==void 0,"Misspelled framebuffer binding point?");var v=Number(p),g=m[v],_=g;if(!_)this._unattach(v);else if(_ instanceof Gt)this._attachRenderbuffer({attachment:v,renderbuffer:_});else if(Array.isArray(g)){var b=ae(g,3),C=b[0],x=b[1],T=x===void 0?0:x,R=b[2],D=R===void 0?0:R;_=C,this._attachTexture({attachment:v,texture:C,layer:T,level:D})}else this._attachTexture({attachment:v,texture:_,layer:0,level:0});d&&_&&_.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,h||null),Object.assign(this.attachments,i),Object.keys(this.attachments).filter(function(V){return!o.attachments[V]}).forEach(function(V){delete o.attachments[V]})}},{key:"checkStatus",value:function(){var i=this.gl,o=this.getStatus();if(o!==36053)throw new Error(cp(o));return this}},{key:"getStatus",value:function(){var i=this.gl,o=i.bindFramebuffer(36160,this.handle),s=i.checkFramebufferStatus(36160);return i.bindFramebuffer(36160,o||null),s}},{key:"clear",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=o.color,u=o.depth,f=o.stencil,c=o.drawBuffers,d=c===void 0?[]:c,m=this.gl.bindFramebuffer(36160,this.handle);return(s||u||f)&&Rr(this.gl,{color:s,depth:u,stencil:f}),d.forEach(function(h,p){$a(i.gl,{drawBuffer:p,value:h})}),this.gl.bindFramebuffer(36160,m||null),this}},{key:"readPixels",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return F.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}},{key:"readPixelsToBuffer",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return F.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}},{key:"copyToDataUrl",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return F.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}},{key:"copyToImage",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return F.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}},{key:"copyToTexture",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return F.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}},{key:"blit",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return F.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}},{key:"invalidate",value:function(i){var o=i.attachments,s=o===void 0?[]:o,u=i.x,f=u===void 0?0:u,c=i.y,d=c===void 0?0:c,m=i.width,h=i.height,p=Ae(this.gl),v=p.bindFramebuffer(36008,this.handle),g=f===0&&d===0&&m===void 0&&h===void 0;return g?p.invalidateFramebuffer(36008,s):p.invalidateFramebuffer(36008,s,f,d,m,h),p.bindFramebuffer(36008,v),this}},{key:"getAttachmentParameter",value:function(i,o,s){var u=this._getAttachmentParameterFallback(o);return u===null&&(this.gl.bindFramebuffer(36160,this.handle),u=this.gl.getFramebufferAttachmentParameter(36160,i,o),this.gl.bindFramebuffer(36160,null)),s&&u>1e3&&(u=Ve(this.gl,u)),u}},{key:"getAttachmentParameters",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,o=arguments.length>1?arguments[1]:void 0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[],u={},f=Pu(s),c;try{for(f.s();!(c=f.n()).done;){var d=c.value,m=o?Ve(this.gl,d):d;u[m]=this.getAttachmentParameter(i,d,o)}}catch(h){f.e(h)}finally{f.f()}return u}},{key:"getParameters",value:function(){for(var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,o=Object.keys(this.attachments),s={},u=0,f=o;u<f.length;u++){var c=f[u],d=Number(c),m=i?Ve(this.gl,d):d;s[m]=this.getAttachmentParameters(d,i)}return s}},{key:"show",value:function(){return typeof window<"u"&&window.open(qa(this),"luma-debug-texture"),this}},{key:"log",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(i>F.level||typeof window>"u")return this;o=o||"Framebuffer ".concat(this.id);var s=qa(this,{targetMaxHeight:100});return F.image({logLevel:i,message:o,image:s},o)(),this}},{key:"bind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.target,s=o===void 0?36160:o;return this.gl.bindFramebuffer(s,this.handle),this}},{key:"unbind",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.target,s=o===void 0?36160:o;return this.gl.bindFramebuffer(s,null),this}},{key:"_createDefaultAttachments",value:function(i,o,s,u,f){var c=null;if(i){var d;c=c||{},c[36064]=new Dt(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:u,height:f,mipmaps:!1,parameters:(d={},l(d,10241,9729),l(d,10240,9729),l(d,10242,33071),l(d,10243,33071),d)}),this.ownResources.push(c[36064])}return o&&s?(c=c||{},c[33306]=new Gt(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:u,height:111}),this.ownResources.push(c[33306])):o?(c=c||{},c[36096]=new Gt(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:u,height:f}),this.ownResources.push(c[36096])):s&&M(!1),c}},{key:"_unattach",value:function(i){var o=this.attachments[i];o&&(o instanceof Gt?this.gl.framebufferRenderbuffer(36160,i,36161,null):this.gl.framebufferTexture2D(36160,i,3553,null,0),delete this.attachments[i])}},{key:"_attachRenderbuffer",value:function(i){var o=i.attachment,s=o===void 0?36064:o,u=i.renderbuffer,f=this.gl;f.framebufferRenderbuffer(36160,s,36161,u.handle),this.attachments[s]=u}},{key:"_attachTexture",value:function(i){var o=i.attachment,s=o===void 0?36064:o,u=i.texture,f=i.layer,c=i.level,d=this.gl;switch(d.bindTexture(u.target,u.handle),u.target){case 35866:case 32879:var m=Ae(d);m.framebufferTextureLayer(36160,s,u.target,c,f);break;case 34067:var h=fp(f);d.framebufferTexture2D(36160,s,h,u.handle,c);break;case 3553:d.framebufferTexture2D(36160,s,3553,u.handle,c);break;default:M(!1,"Illegal texture type")}d.bindTexture(u.target,null),this.attachments[s]=u}},{key:"_setReadBuffer",value:function(i){var o=Fa(this.gl);o?o.readBuffer(i):M(i===36064||i===1029,ku),this.readBuffer=i}},{key:"_setDrawBuffers",value:function(i){var o=this.gl,s=Ae(o);if(s)s.drawBuffers(i);else{var u=o.getExtension("WEBGL_draw_buffers");u?u.drawBuffersWEBGL(i):M(i.length===1&&(i[0]===36064||i[0]===1029),ku)}this.drawBuffers=i}},{key:"_getAttachmentParameterFallback",value:function(i){var o=Tn(this.gl);switch(i){case 36052:return o.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return o.WEBGL2?null:8;case 33297:return o.WEBGL2?null:5125;case 33296:return!o.WEBGL2&&!o.EXT_sRGB?9729:null;default:return null}}},{key:"_createHandle",value:function(){return this.gl.createFramebuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteFramebuffer(this.handle)}},{key:"_bindHandle",value:function(i){return this.gl.bindFramebuffer(36160,i)}}],[{key:"isSupported",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=o.colorBufferFloat,u=o.colorBufferHalfFloat,f=!0;return s&&(f=Boolean(i.getExtension("EXT_color_buffer_float")||i.getExtension("WEBGL_color_buffer_float")||i.getExtension("OES_texture_float"))),u&&(f=f&&Boolean(i.getExtension("EXT_color_buffer_float")||i.getExtension("EXT_color_buffer_half_float"))),f}},{key:"getDefaultFramebuffer",value:function(i){return i.luma=i.luma||{},i.luma.defaultFramebuffer=i.luma.defaultFramebuffer||new n(i,{id:"default-framebuffer",handle:null,attachments:{}}),i.luma.defaultFramebuffer}}]),n}(Re,Symbol.toStringTag);function fp(t){return t<34069?t+34069:t}function cp(t){var r=Je.STATUS||{};return r[t]||"Framebuffer error ".concat(t)}var lp=[36049,36048,33296,33298,33299,33300,33301,33302,33303];Je.ATTACHMENT_PARAMETERS=lp;function Fu(t,r){var e=t.gl,n=t.width,a=t.height,i=t.id,o=new Je(e,Object.assign({},r,{id:"framebuffer-for-".concat(i),width:n,height:a,attachments:l({},36064,t)}));return o}function bt(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed",e=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,n=t.match(e);return n?n[1]:r}var dp=35632,mp=35633;function ti(t){switch(t){case dp:return"fragment";case mp:return"vertex";default:return"unknown type"}}function ri(t,r,e,n){for(var a=t.split(/\r?\n/),i={},o={},s=n||bt(r)||"(unnamed)",u="".concat(ti(e)," shader ").concat(s),f=0;f<a.length;f++){var c=a[f];if(!(c.length<=1)){var d=c.split(":"),m=d[0],h=parseInt(d[2],10);if(isNaN(h))throw new Error("GLSL compilation error in ".concat(u,": ").concat(t));m!=="WARNING"?i[h]=c:o[h]=c}}var p=hp(r);return{shaderName:u,errors:Uu(i,p),warnings:Uu(o,p)}}function Uu(t,r){for(var e="",n=0;n<r.length;n++){var a=r[n];if(!(!t[n+3]&&!t[n+2]&&!t[n+1])&&(e+="".concat(a,`
`),t[n+1])){var i=t[n+1],o=i.split(":",3),s=o[0],u=parseInt(o[1],10)||0,f=i.substring(o.join(":").length+1).trim();e+=Nu("^^^ ".concat(s,": ").concat(f,`

`),u)}}return e}function hp(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ",n=t.split(/\r?\n/),a=String(n.length+r-1).length;return n.map(function(i,o){var s=String(o+r),u=s.length,f=Nu(s,a-u);return f+e+i})}function Nu(t,r){for(var e="",n=0;n<r;++n)e+=" ";return"".concat(e).concat(t)}function ni(t){var r=pp();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function pp(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vp="Shader: GLSL source code must be a JavaScript string",Hu=function(t,r){w(n,t);var e=ni(n);function n(a,i){var o;y(this,n),wt(a),M(typeof i.source=="string",vp);var s=bt(i.source,null)||i.id||Oe("unnamed ".concat(n.getTypeName(i.shaderType)));return o=e.call(this,a,{id:s}),o.shaderType=i.shaderType,o.source=i.source,o.initialize(i),o}return E(n,[{key:r,get:function(){return"Shader"}},{key:"initialize",value:function(i){var o=i.source,s=bt(o,null);s&&(this.id=Oe(s)),this._compile(o)}},{key:"getParameter",value:function(i){return this.gl.getShaderParameter(this.handle,i)}},{key:"toString",value:function(){return"".concat(n.getTypeName(this.shaderType),":").concat(this.id)}},{key:"getName",value:function(){return bt(this.source)||"unnamed-shader"}},{key:"getSource",value:function(){return this.gl.getShaderSource(this.handle)}},{key:"getTranslatedSource",value:function(){var i=this.gl.getExtension("WEBGL_debug_shaders");return i?i.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}},{key:"_compile",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;i.startsWith("#version ")||(i=`#version 100
`.concat(i)),this.source=i,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle);var o=this.getParameter(35713);if(!o){var s=this.gl.getShaderInfoLog(this.handle),u=ri(s,this.source,this.shaderType,this.id),f=u.shaderName,c=u.errors,d=u.warnings;throw F.error("GLSL compilation errors in ".concat(f,`
`).concat(c))(),F.warn("GLSL compilation warnings in ".concat(f,`
`).concat(d))(),new Error("GLSL compilation errors in ".concat(f))}}},{key:"_deleteHandle",value:function(){this.gl.deleteShader(this.handle)}},{key:"_getOptsFromHandle",value:function(){return{type:this.getParameter(35663),source:this.getSource()}}}],[{key:"getTypeName",value:function(i){switch(i){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return M(!1),"unknown"}}}]),n}(Re,Symbol.toStringTag),Cn=function(t,r){w(n,t);var e=ni(n);function n(a,i){return y(this,n),typeof i=="string"&&(i={source:i}),e.call(this,a,Object.assign({},i,{shaderType:35633}))}return E(n,[{key:r,get:function(){return"VertexShader"}},{key:"_createHandle",value:function(){return this.gl.createShader(35633)}}]),n}(Hu,Symbol.toStringTag),Sn=function(t,r){w(n,t);var e=ni(n);function n(a,i){return y(this,n),typeof i=="string"&&(i={source:i}),e.call(this,a,Object.assign({},i,{shaderType:35632}))}return E(n,[{key:r,get:function(){return"FragmentShader"}},{key:"_createHandle",value:function(){return this.gl.createShader(35632)}}]),n}(Hu,Symbol.toStringTag);var K,gp=(K={},l(K,5126,de.bind(null,"uniform1fv",ke,1,Ie)),l(K,35664,de.bind(null,"uniform2fv",ke,2,Ie)),l(K,35665,de.bind(null,"uniform3fv",ke,3,Ie)),l(K,35666,de.bind(null,"uniform4fv",ke,4,Ie)),l(K,5124,de.bind(null,"uniform1iv",_t,1,Ie)),l(K,35667,de.bind(null,"uniform2iv",_t,2,Ie)),l(K,35668,de.bind(null,"uniform3iv",_t,3,Ie)),l(K,35669,de.bind(null,"uniform4iv",_t,4,Ie)),l(K,35670,de.bind(null,"uniform1iv",_t,1,Ie)),l(K,35671,de.bind(null,"uniform2iv",_t,2,Ie)),l(K,35672,de.bind(null,"uniform3iv",_t,3,Ie)),l(K,35673,de.bind(null,"uniform4iv",_t,4,Ie)),l(K,35674,de.bind(null,"uniformMatrix2fv",ke,4,lt)),l(K,35675,de.bind(null,"uniformMatrix3fv",ke,9,lt)),l(K,35676,de.bind(null,"uniformMatrix4fv",ke,16,lt)),l(K,35678,Se),l(K,35680,Se),l(K,5125,de.bind(null,"uniform1uiv",Mn,1,Ie)),l(K,36294,de.bind(null,"uniform2uiv",Mn,2,Ie)),l(K,36295,de.bind(null,"uniform3uiv",Mn,3,Ie)),l(K,36296,de.bind(null,"uniform4uiv",Mn,4,Ie)),l(K,35685,de.bind(null,"uniformMatrix2x3fv",ke,6,lt)),l(K,35686,de.bind(null,"uniformMatrix2x4fv",ke,8,lt)),l(K,35687,de.bind(null,"uniformMatrix3x2fv",ke,6,lt)),l(K,35688,de.bind(null,"uniformMatrix3x4fv",ke,12,lt)),l(K,35689,de.bind(null,"uniformMatrix4x2fv",ke,8,lt)),l(K,35690,de.bind(null,"uniformMatrix4x3fv",ke,12,lt)),l(K,35678,Se),l(K,35680,Se),l(K,35679,Se),l(K,35682,Se),l(K,36289,Se),l(K,36292,Se),l(K,36293,Se),l(K,36298,Se),l(K,36299,Se),l(K,36300,Se),l(K,36303,Se),l(K,36306,Se),l(K,36307,Se),l(K,36308,Se),l(K,36311,Se),K),Ap={},yp={},bp={},ju=[0];function ai(t,r,e,n){r===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(ju[0]=t,t=ju);var a=t.length;if(a%r&&F.warn("Uniform size should be multiples of ".concat(r),t)(),t instanceof e)return t;var i=n[a];i||(i=new e(a),n[a]=i);for(var o=0;o<a;o++)i[o]=t[o];return i}function ke(t,r){return ai(t,r,Float32Array,Ap)}function _t(t,r){return ai(t,r,Int32Array,yp)}function Mn(t,r){return ai(t,r,Uint32Array,bp)}function ii(t,r,e){var n=gp[e.type];if(!n)throw new Error("Unknown GLSL uniform type ".concat(e.type));return n().bind(null,t,r)}function Vu(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};var r=/([^[]*)(\[[0-9]+\])?/,e=t.match(r);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function Ju(t,r,e){for(var n in t){var a=t[n],i=!e||Boolean(e[n]);if(i&&!_p(a))throw r=r?"".concat(r," "):"",console.error("".concat(r," Bad uniform ").concat(n),a),new Error("".concat(r," Bad uniform ").concat(n))}return!0}function _p(t){return Array.isArray(t)||ArrayBuffer.isView(t)?Bp(t):isFinite(t)||t===!0||t===!1||t instanceof Lt||t instanceof Gt?!0:t instanceof Je?Boolean(t.texture):!1}function Xu(t,r,e){if(Array.isArray(e)||ArrayBuffer.isView(e))if(t[r])for(var n=t[r],a=0,i=e.length;a<i;++a)n[a]=e[a];else t[r]=e.slice();else t[r]=e}function Bp(t){if(t.length===0)return!1;for(var r=Math.min(t.length,16),e=0;e<r;++e)if(!Number.isFinite(t[e]))return!1;return!0}function Se(){var t=null;return function(r,e,n){var a=t!==n;return a&&(r.uniform1i(e,n),t=n),a}}function de(t,r,e,n){var a=null,i=null;return function(o,s,u){var f=r(u,e),c=f.length,d=!1;if(a===null)a=new Float32Array(c),i=c,d=!0;else{M(i===c,"Uniform length cannot change.");for(var m=0;m<c;++m)if(f[m]!==a[m]){d=!0;break}}return d&&(n(o,t,s,f),a.set(f)),d}}function Ie(t,r,e,n){t[r](e,n)}function lt(t,r,e,n){t[r](e,!1,n)}var fe,Ep=5120,xp=5121,Tp=5122,Cp=5123,zu=0,Rn=1,Sp=2,Mp=3,In=4,Rp=5,Ip=6,xe=5126,Op=35664,wp=35665,Fp=35666,Ir=5124,Lp=35667,Dp=35668,Pp=35669,Or=5125,Gp=36294,kp=36295,Up=36296,Np=35670,Hp=35671,jp=35672,Vp=35673,Jp=35674,Xp=35675,zp=35676,Wp=35685,Kp=35686,Yp=35687,Qp=35688,$p=35689,qp=35690,oi=(fe={},l(fe,xe,[xe,1,"float"]),l(fe,Op,[xe,2,"vec2"]),l(fe,wp,[xe,3,"vec3"]),l(fe,Fp,[xe,4,"vec4"]),l(fe,Ir,[Ir,1,"int"]),l(fe,Lp,[Ir,2,"ivec2"]),l(fe,Dp,[Ir,3,"ivec3"]),l(fe,Pp,[Ir,4,"ivec4"]),l(fe,Or,[Or,1,"uint"]),l(fe,Gp,[Or,2,"uvec2"]),l(fe,kp,[Or,3,"uvec3"]),l(fe,Up,[Or,4,"uvec4"]),l(fe,Np,[xe,1,"bool"]),l(fe,Hp,[xe,2,"bvec2"]),l(fe,jp,[xe,3,"bvec3"]),l(fe,Vp,[xe,4,"bvec4"]),l(fe,Jp,[xe,8,"mat2"]),l(fe,Wp,[xe,8,"mat2x3"]),l(fe,Kp,[xe,8,"mat2x4"]),l(fe,Xp,[xe,12,"mat3"]),l(fe,Yp,[xe,12,"mat3x2"]),l(fe,Qp,[xe,12,"mat3x4"]),l(fe,zp,[xe,16,"mat4"]),l(fe,$p,[xe,16,"mat4x2"]),l(fe,qp,[xe,16,"mat4x3"]),fe);function Wu(t){switch(t){case zu:return zu;case Rn:return Rn;case Mp:return Rn;case Sp:return Rn;case In:return In;case Rp:return In;case Ip:return In;default:return M(!1),0}}function si(t){var r=oi[t];if(!r)return null;var e=ae(r,2),n=e[0],a=e[1];return{type:n,components:a}}function On(t,r){switch(t){case Ep:case xp:case Tp:case Cp:t=xe;break;default:}for(var e in oi){var n=ae(oi[e],3),a=n[0],i=n[1],o=n[2];if(a===t&&i===r)return{glType:e,name:o}}return null}var Ku=function(){function t(r){y(this,t),this.id=r.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(r),this._readVaryingsFromProgram(r)}return E(t,[{key:"getAttributeInfo",value:function(e){var n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}},{key:"getAttributeLocation",value:function(e){var n=this.getAttributeInfo(e);return n?n.location:-1}},{key:"getAttributeAccessor",value:function(e){var n=this.getAttributeInfo(e);return n?n.accessor:null}},{key:"getVaryingInfo",value:function(e){var n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}},{key:"getVaryingIndex",value:function(e){var n=this.getVaryingInfo();return n?n.location:-1}},{key:"getVaryingAccessor",value:function(e){var n=this.getVaryingInfo();return n?n.accessor:null}},{key:"_readAttributesFromProgram",value:function(e){for(var n=e.gl,a=n.getProgramParameter(e.handle,35721),i=0;i<a;i++){var o=n.getActiveAttrib(e.handle,i),s=o.name,u=o.type,f=o.size,c=n.getAttribLocation(e.handle,s);c>=0&&this._addAttribute(c,s,u,f)}this.attributeInfos.sort(function(d,m){return d.location-m.location})}},{key:"_readVaryingsFromProgram",value:function(e){var n=e.gl;if(X(n)){for(var a=n.getProgramParameter(e.handle,35971),i=0;i<a;i++){var o=n.getTransformFeedbackVarying(e.handle,i),s=o.name,u=o.type,f=o.size;this._addVarying(i,s,u,f)}this.varyingInfos.sort(function(c,d){return c.location-d.location})}}},{key:"_addAttribute",value:function(e,n,a,i){var o=si(a),s=o.type,u=o.components,f={type:s,size:i*u};this._inferProperties(e,n,f);var c={location:e,name:n,accessor:new we(f)};this.attributeInfos.push(c),this.attributeInfosByLocation[e]=c,this.attributeInfosByName[c.name]=c}},{key:"_inferProperties",value:function(e,n,a){/instance/i.test(n)&&(a.divisor=1)}},{key:"_addVarying",value:function(e,n,a,i){var o=si(a),s=o.type,u=o.components,f=new we({type:s,size:i*u}),c={location:e,name:n,accessor:f};this.varyingInfos.push(c),this.varyingInfosByName[c.name]=c}}]),t}();function Zp(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=ev(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function ev(t,r){if(t){if(typeof t=="string")return Yu(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Yu(t,r)}}function Yu(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function tv(t){var r=rv();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function rv(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Qu=4,nv=35981,av=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"],wr=function(t,r){w(n,t);var e=tv(n);function n(a){var i;y(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i=e.call(this,a,o),i.stubRemovedMethods("Program","v6.0",av),i._isCached=!1,i.initialize(o),Object.seal(Z(i)),i._setId(o.id),i}return E(n,[{key:r,get:function(){return"Program"}},{key:"initialize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.hash,s=i.vs,u=i.fs,f=i.varyings,c=i.bufferMode,d=c===void 0?nv:c;return this.hash=o||"",this.vs=typeof s=="string"?new Cn(this.gl,{id:"".concat(i.id,"-vs"),source:s}):s,this.fs=typeof u=="string"?new Sn(this.gl,{id:"".concat(i.id,"-fs"),source:u}):u,M(this.vs instanceof Cn),M(this.fs instanceof Sn),this.uniforms={},this._textureUniforms={},f&&f.length>0&&(Ae(this.gl),this.varyings=f,this.gl2.transformFeedbackVaryings(this.handle,f,d)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Ku(this),this.setProps(i)}},{key:"delete",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:ve(O(n.prototype),"delete",this).call(this,i)}},{key:"setProps",value:function(i){return"uniforms"in i&&this.setUniforms(i.uniforms),this}},{key:"draw",value:function(i){var o=this,s=i.logPriority,u=i.drawMode,f=u===void 0?4:u,c=i.vertexCount,d=i.offset,m=d===void 0?0:d,h=i.start,p=i.end,v=i.isIndexed,g=v===void 0?!1:v,_=i.indexType,b=_===void 0?5123:_,C=i.instanceCount,x=C===void 0?0:C,T=i.isInstanced,R=T===void 0?x>0:T,D=i.vertexArray,V=D===void 0?null:D,U=i.transformFeedback,N=i.framebuffer,J=i.parameters,L=J===void 0?{}:J,z=i.uniforms,H=i.samplers;if((z||H)&&(F.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(z||{})),F.priority>=s){var se=N?N.id:"default",B="mode=".concat(Ve(this.gl,f)," verts=").concat(c," ")+"instances=".concat(x," indexType=").concat(Ve(this.gl,b)," ")+"isInstanced=".concat(R," isIndexed=").concat(g," ")+"Framebuffer=".concat(se);F.log(s,B)()}return M(V),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||c===0||R&&x===0?!1:(V.bindForDraw(c,x,function(){if(N!==void 0&&(L=Object.assign({},L,{framebuffer:N})),U){var A=Wu(f);U.begin(A)}o._bindTextures(),We(o.gl,L,function(){g&&R?o.gl2.drawElementsInstanced(f,c,b,m,x):g&&X(o.gl)&&!isNaN(h)&&!isNaN(p)?o.gl2.drawRangeElements(f,h,p,c,b,m):g?o.gl.drawElements(f,c,b,m):R?o.gl2.drawArraysInstanced(f,m,c,x):o.gl.drawArrays(f,m,c)}),U&&U.end()}),!0)}},{key:"setUniforms",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};F.priority>=2&&Ju(i,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(var o in i){var s=i[o],u=this._uniformSetters[o];if(u){var f=s,c=!1;if(f instanceof Je&&(f=f.texture),f instanceof Lt)if(c=this.uniforms[o]!==s,c){u.textureIndex===void 0&&(u.textureIndex=this._textureIndexCounter++);var d=f,m=u.textureIndex;d.bind(m),f=m,this._textureUniforms[o]=d}else f=u.textureIndex;else this._textureUniforms[o]&&delete this._textureUniforms[o];(u(f)||c)&&Xu(this.uniforms,o,s)}}return this}},{key:"_areTexturesRenderable",value:function(){var i=!0;for(var o in this._textureUniforms){var s=this._textureUniforms[o];s.update(),i=i&&s.loaded}return i}},{key:"_bindTextures",value:function(){for(var i in this._textureUniforms){var o=this._uniformSetters[i].textureIndex;this._textureUniforms[i].bind(o)}}},{key:"_createHandle",value:function(){return this.gl.createProgram()}},{key:"_deleteHandle",value:function(){this.gl.deleteProgram(this.handle)}},{key:"_getOptionsFromHandle",value:function(i){var o=this.gl.getAttachedShaders(i),s={},u=Zp(o),f;try{for(u.s();!(f=u.n()).done;){var c=f.value,d=this.gl.getShaderParameter(this.handle,35663);switch(d){case 35633:s.vs=new Cn({handle:c});break;case 35632:s.fs=new Sn({handle:c});break;default:}}}catch(m){u.e(m)}finally{u.f()}return s}},{key:"_getParameter",value:function(i){return this.gl.getProgramParameter(this.handle,i)}},{key:"_setId",value:function(i){if(!i){var o=this._getName();this.id=Oe(o)}}},{key:"_getName",value:function(){var i=this.vs.getName()||this.fs.getName();return i=i.replace(/shader/i,""),i=i?"".concat(i,"-program"):"program",i}},{key:"_compileAndLink",value:function(){var i=this.gl;if(i.attachShader(this.handle,this.vs.handle),i.attachShader(this.handle,this.fs.handle),F.time(Qu,"linkProgram for ".concat(this._getName()))(),i.linkProgram(this.handle),F.timeEnd(Qu,"linkProgram for ".concat(this._getName()))(),i.debug||F.level>0){var o=i.getProgramParameter(this.handle,35714);if(!o)throw new Error("Error linking: ".concat(i.getProgramInfoLog(this.handle)));i.validateProgram(this.handle);var s=i.getProgramParameter(this.handle,35715);if(!s)throw new Error("Error validating: ".concat(i.getProgramInfoLog(this.handle)))}}},{key:"_readUniformLocationsFromLinkedProgram",value:function(){var i=this.gl;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(var o=0;o<this._uniformCount;o++){var s=this.gl.getActiveUniform(this.handle,o),u=Vu(s.name),f=u.name,c=i.getUniformLocation(this.handle,f);if(this._uniformSetters[f]=ii(i,c,s),s.size>1)for(var d=0;d<s.size;d++)c=i.getUniformLocation(this.handle,"".concat(f,"[").concat(d,"]")),this._uniformSetters["".concat(f,"[").concat(d,"]")]=ii(i,c,s)}this._textureIndexCounter=0}},{key:"getActiveUniforms",value:function(i,o){return this.gl2.getActiveUniforms(this.handle,i,o)}},{key:"getUniformBlockIndex",value:function(i){return this.gl2.getUniformBlockIndex(this.handle,i)}},{key:"getActiveUniformBlockParameter",value:function(i,o){return this.gl2.getActiveUniformBlockParameter(this.handle,i,o)}},{key:"uniformBlockBinding",value:function(i,o){this.gl2.uniformBlockBinding(this.handle,i,o)}}]),n}(Re,Symbol.toStringTag);function iv(t){var r=ov();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function ov(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ui=function(t,r){w(n,t);var e=iv(n);function n(a){var i;y(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ae(a),i=e.call(this,a,o),i.initialize(o),i.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(Z(i)),i}return E(n,[{key:r,get:function(){return"TransformFeedback"}},{key:"initialize",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,nr(this.buffers)||this.bind(function(){return i._unbindBuffers()}),this.setProps(o),this}},{key:"setProps",value:function(i){"program"in i&&(this.configuration=i.program&&i.program.configuration),"configuration"in i&&(this.configuration=i.configuration),"bindOnUse"in i&&(i=i.bindOnUse),"buffers"in i&&this.setBuffers(i.buffers)}},{key:"setBuffers",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(function(){for(var s in o)i.setBuffer(s,o[s])}),this}},{key:"setBuffer",value:function(i,o){var s=this._getVaryingIndex(i),u=this._getBufferParams(o),f=u.buffer,c=u.byteSize,d=u.byteOffset;return s<0?(this.unused[i]=f,F.warn("".concat(this.id," unused varying buffer ").concat(i))(),this):(this.buffers[s]=o,this.bindOnUse||this._bindBuffer(s,f,d,c),this)}},{key:"begin",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(i),this}},{key:"end",value:function(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}},{key:"_getBufferParams",value:function(i){var o,s,u;return i instanceof le?u=i:(u=i.buffer,s=i.byteSize,o=i.byteOffset),(o!==void 0||s!==void 0)&&(o=o||0,s=s||u.byteLength-o),{buffer:u,byteOffset:o,byteSize:s}}},{key:"_getVaryingInfo",value:function(i){return this.configuration&&this.configuration.getVaryingInfo(i)}},{key:"_getVaryingIndex",value:function(i){if(this.configuration)return this.configuration.getVaryingInfo(i).location;var o=Number(i);return Number.isFinite(o)?o:-1}},{key:"_bindBuffers",value:function(){if(this.bindOnUse)for(var i in this.buffers){var o=this._getBufferParams(this.buffers[i]),s=o.buffer,u=o.byteSize,f=o.byteOffset;this._bindBuffer(i,s,f,u)}}},{key:"_unbindBuffers",value:function(){if(this.bindOnUse)for(var i in this.buffers)this._bindBuffer(i,null)}},{key:"_bindBuffer",value:function(i,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3?arguments[3]:void 0,f=o&&o.handle;return!f||u===void 0?this.gl.bindBufferBase(35982,i,f):this.gl.bindBufferRange(35982,i,f,s,u),this}},{key:"_createHandle",value:function(){return this.gl.createTransformFeedback()}},{key:"_deleteHandle",value:function(){this.gl.deleteTransformFeedback(this.handle)}},{key:"_bindHandle",value:function(i){this.gl.bindTransformFeedback(36386,this.handle)}}],[{key:"isSupported",value:function(i){return X(i)}}]),n}(Re,Symbol.toStringTag);var wn=null;function sv(t){return(!wn||wn.byteLength<t)&&(wn=new ArrayBuffer(t)),wn}function $u(t,r){var e=sv(t.BYTES_PER_ELEMENT*r);return new t(e,0,r)}function qu(t){for(var r=t.target,e=t.source,n=t.start,a=n===void 0?0:n,i=t.count,o=i===void 0?1:i,s=e.length,u=o*s,f=0,c=a;f<s;f++)r[c++]=e[f];for(;f<u;)f<u-f?(r.copyWithin(a+f,a,a+f),f*=2):(r.copyWithin(a+f,a,a+u-f),f=u);return r}function uv(t){var r=fv();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function fv(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var cv="elements must be GL.ELEMENT_ARRAY_BUFFER",Fn=function(t,r){w(n,t);var e=uv(n);function n(a){var i;y(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=o.id||o.program&&o.program.id;return i=e.call(this,a,Object.assign({},o,{id:s})),i.buffer=null,i.bufferValue=null,i.isDefaultArray=o.isDefaultArray||!1,i.gl2=a,i.initialize(o),Object.seal(Z(i)),i}return E(n,[{key:r,get:function(){return"VertexArrayObject"}},{key:"delete",value:function(){return ve(O(n.prototype),"delete",this).call(this),this.buffer&&this.buffer.delete(),this}},{key:"MAX_ATTRIBUTES",get:function(){return n.getMaxAttributes(this.gl)}},{key:"initialize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(i)}},{key:"setProps",value:function(i){return this}},{key:"setElementBuffer",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return M(!o||o.target===34963,cv),this.bind(function(){i.gl.bindBuffer(34963,o?o.handle:null)}),this}},{key:"setBuffer",value:function(i,o,s){if(o.target===34963)return this.setElementBuffer(o,s);var u=s.size,f=s.type,c=s.stride,d=s.offset,m=s.normalized,h=s.integer,p=s.divisor,v=this.gl,g=this.gl2;return i=Number(i),this.bind(function(){v.bindBuffer(34962,o.handle),h?(M(X(v)),g.vertexAttribIPointer(i,u,f,c,d)):v.vertexAttribPointer(i,u,f,m,c,d),v.enableVertexAttribArray(i),g.vertexAttribDivisor(i,p||0)}),this}},{key:"enable",value:function(i){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=!s&&i===0&&!n.isSupported(this.gl,{constantAttributeZero:!0});return u||(i=Number(i),this.bind(function(){return s?o.gl.enableVertexAttribArray(i):o.gl.disableVertexAttribArray(i)})),this}},{key:"getConstantBuffer",value:function(i,o){var s=this._normalizeConstantArrayValue(o),u=s.byteLength*i,f=s.length*i,c=!this.buffer;if(this.buffer=this.buffer||new le(this.gl,u),c=c||this.buffer.reallocate(u),c=c||!this._compareConstantArrayValues(s,this.bufferValue),c){var d=$u(o.constructor,f);qu({target:d,source:s,start:0,count:f}),this.buffer.subData(d),this.bufferValue=o}return this.buffer}},{key:"_normalizeConstantArrayValue",value:function(i){return Array.isArray(i)?new Float32Array(i):i}},{key:"_compareConstantArrayValues",value:function(i,o){if(!i||!o||i.length!==o.length||i.constructor!==o.constructor)return!1;for(var s=0;s<i.length;++s)if(i[s]!==o[s])return!1;return!0}},{key:"_createHandle",value:function(){var i=this.gl;return i.createVertexArray()}},{key:"_deleteHandle",value:function(i){return this.gl2.deleteVertexArray(i),[this.elements]}},{key:"_bindHandle",value:function(i){this.gl2.bindVertexArray(i)}},{key:"_getParameter",value:function(i,o){var s=this,u=o.location;return M(Number.isFinite(u)),this.bind(function(){switch(i){case 34373:return s.gl.getVertexAttribOffset(u,i);default:return s.gl.getVertexAttrib(u,i)}})}}],[{key:"isSupported",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return o.constantAttributeZero?X(i)||hn()==="Chrome":!0}},{key:"getDefaultArray",value:function(i){return i.luma=i.luma||{},i.luma.defaultVertexArray||(i.luma.defaultVertexArray=new n(i,{handle:null,isDefaultArray:!0})),i.luma.defaultVertexArray}},{key:"getMaxAttributes",value:function(i){return n.MAX_ATTRIBUTES=n.MAX_ATTRIBUTES||i.getParameter(34921),n.MAX_ATTRIBUTES}},{key:"setConstant",value:function(i,o,s){switch(s.constructor){case Float32Array:n._setConstantFloatArray(i,o,s);break;case Int32Array:n._setConstantIntArray(i,o,s);break;case Uint32Array:n._setConstantUintArray(i,o,s);break;default:M(!1)}}},{key:"_setConstantFloatArray",value:function(i,o,s){switch(s.length){case 1:i.vertexAttrib1fv(o,s);break;case 2:i.vertexAttrib2fv(o,s);break;case 3:i.vertexAttrib3fv(o,s);break;case 4:i.vertexAttrib4fv(o,s);break;default:M(!1)}}},{key:"_setConstantIntArray",value:function(i,o,s){switch(M(X(i)),s.length){case 1:i.vertexAttribI1iv(o,s);break;case 2:i.vertexAttribI2iv(o,s);break;case 3:i.vertexAttribI3iv(o,s);break;case 4:i.vertexAttribI4iv(o,s);break;default:M(!1)}}},{key:"_setConstantUintArray",value:function(i,o,s){switch(M(X(i)),s.length){case 1:i.vertexAttribI1uiv(o,s);break;case 2:i.vertexAttribI2uiv(o,s);break;case 3:i.vertexAttribI3uiv(o,s);break;case 4:i.vertexAttribI4uiv(o,s);break;default:M(!1)}}}]),n}(Re,Symbol.toStringTag);var lv="VertexArray: attributes must be Buffers or constants (i.e. typed array)",dv=/^(.+)__LOCATION_([0-9]+)$/,mv=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"],fi=function(){function t(r){y(this,t);var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.id||e.program&&e.program.id;this.id=n,this.gl=r,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Fn(r),En(this,"VertexArray","v6.0",mv),this.initialize(e),Object.seal(this)}return E(t,[{key:"delete",value:function(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}},{key:"initialize",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}},{key:"reset",value:function(){this.elements=null,this.elementsAccessor=null;var e=this.vertexArrayObject.MAX_ATTRIBUTES;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}},{key:"setProps",value:function(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}},{key:"clearDrawParams",value:function(){this.drawParams=null}},{key:"getDrawParams",value:function(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}},{key:"setAttributes",value:function(e){var n=this;return Object.assign(this.attributes,e),this.vertexArrayObject.bind(function(){for(var a in e){var i=e[a];n._setAttribute(a,i)}n.gl.bindBuffer(34962,null)}),this}},{key:"setElementBuffer",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}},{key:"setBuffer",value:function(e,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,a);var i=this._resolveLocationAndAccessor(e,n,n.accessor,a),o=i.location,s=i.accessor;return o>=0&&(this.values[o]=n,this.accessors[o]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(o,n,s)),this}},{key:"setConstant",value:function(e,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},a)),o=i.location,s=i.accessor;return o>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[o]=n,this.accessors[o]=s,this.clearDrawParams(),this.vertexArrayObject.enable(o,!1)),this}},{key:"unbindBuffers",value:function(){var e=this;return this.vertexArrayObject.bind(function(){e.elements&&e.vertexArrayObject.setElementBuffer(null),e.buffer=e.buffer||new le(e.gl,{accessor:{size:4}});for(var n=0;n<e.vertexArrayObject.MAX_ATTRIBUTES;n++)e.values[n]instanceof le&&(e.gl.disableVertexAttribArray(n),e.gl.bindBuffer(34962,e.buffer.handle),e.gl.vertexAttribPointer(n,1,5126,!1,0,0))}),this}},{key:"bindBuffers",value:function(){var e=this;return this.vertexArrayObject.bind(function(){e.elements&&e.setElementBuffer(e.elements);for(var n=0;n<e.vertexArrayObject.MAX_ATTRIBUTES;n++){var a=e.values[n];a instanceof le&&e.setBuffer(n,a)}}),this}},{key:"bindForDraw",value:function(e,n,a){var i=this,o;return this.vertexArrayObject.bind(function(){i._setConstantAttributes(e,n),o=a()}),o}},{key:"_resolveLocationAndAccessor",value:function(e,n,a,i){var o=this,s={location:-1,accessor:null},u=this._getAttributeIndex(e),f=u.location,c=u.name;if(!Number.isFinite(f)||f<0)return this.unused[e]=n,F.once(3,function(){return"unused value ".concat(e," in ").concat(o.id)})(),s;var d=this._getAttributeInfo(c||f);if(!d)return s;var m=this.accessors[f]||{},h=we.resolve(d.accessor,m,a,i),p=h.size,v=h.type;return M(Number.isFinite(p)&&Number.isFinite(v)),{location:f,accessor:h}}},{key:"_getAttributeInfo",value:function(e){return this.configuration&&this.configuration.getAttributeInfo(e)}},{key:"_getAttributeIndex",value:function(e){var n=Number(e);if(Number.isFinite(n))return{location:n};var a=dv.exec(e),i=a?a[1]:e,o=a?Number(a[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+o,name:i}:{location:-1}}},{key:"_setAttribute",value:function(e,n){if(n instanceof le)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof le){var a=n[0],i=n[1];this.setBuffer(e,a,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){var o=n;this.setConstant(e,o)}else if(n.buffer instanceof le){var s=n;this.setBuffer(e,s.buffer,s)}else throw new Error(lv)}},{key:"_setConstantAttributes",value:function(e,n){var a=Math.max(e|0,n|0),i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,a);for(var o=1;o<this.vertexArrayObject.MAX_ATTRIBUTES;o++)i=this.values[o],ArrayBuffer.isView(i)&&this._setConstantAttribute(o,i)}},{key:"_setConstantAttributeZero",value:function(e,n){if(Fn.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}var a=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,a,this.accessors[0])}},{key:"_setConstantAttribute",value:function(e,n){Fn.setConstant(this.gl,e,n)}},{key:"_updateDrawParams",value:function(){for(var e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0},n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}},{key:"_updateDrawParamsForLocation",value:function(e,n){var a=this.values[n],i=this.accessors[n];if(a){var o=i.divisor,s=o>0;if(e.isInstanced=e.isInstanced||s,a instanceof le){var u=a;if(s){var f=u.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,f)}else{var c=u.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,c)}}}}},{key:"setElements",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return F.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}]),t}();function hv(t,r){for(var e=r.maxElts,n=e===void 0?16:e,a=r.size,i=a===void 0?1:a,o="[",s=0;s<t.length&&s<n;++s)s>0&&(o+=",".concat(s%i===0?" ":"")),o+=kt(t[s],r);var u=t.length>n?"...":"]";return"".concat(o).concat(u)}function kt(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=1e-16,n=r.isInteger,a=n===void 0?!1:n;if(Array.isArray(t)||ArrayBuffer.isView(t))return hv(t,r);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<e)return a?"0":"0.";if(a||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);var i=t.toPrecision(2),o=i.indexOf(".0");return o===i.length-2?i.slice(0,-1):i}function ci(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=pv(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function pv(t,r){if(t){if(typeof t=="string")return Zu(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Zu(t,r)}}function Zu(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Ln(t){var r=t.header,e=r===void 0?"Uniforms":r,n=t.program,a=t.uniforms,i=t.undefinedOnly,o=i===void 0?!1:i;M(n);var s=".*_.*",u=".*Matrix",f=n._uniformSetters,c={},d=Object.keys(f).sort(),m=0,h=ci(d),p;try{for(h.s();!(p=h.n()).done;){var v=p.value;!v.match(s)&&!v.match(u)&&li({table:c,header:e,uniforms:a,uniformName:v,undefinedOnly:o})&&m++}}catch(N){h.e(N)}finally{h.f()}var g=ci(d),_;try{for(g.s();!(_=g.n()).done;){var b=_.value;b.match(u)&&li({table:c,header:e,uniforms:a,uniformName:b,undefinedOnly:o})&&m++}}catch(N){g.e(N)}finally{g.f()}var C=ci(d),x;try{for(C.s();!(x=C.n()).done;){var T=x.value;c[T]||li({table:c,header:e,uniforms:a,uniformName:T,undefinedOnly:o})&&m++}}catch(N){C.e(N)}finally{C.f()}var R=0,D={};if(!o)for(var V in a){var U=a[V];c[V]||(R++,D[V]=l({Type:"NOT USED: ".concat(U)},e,kt(U)))}return{table:c,count:m,unusedTable:D,unusedCount:R}}function li(t){var r=t.table,e=t.header,n=t.uniforms,a=t.uniformName,i=t.undefinedOnly,o=n[a],s=vv(o);if(!i||!s){var u;return r[a]=(u={},l(u,e,s?kt(o):"N/A"),l(u,"Uniform Type",s?o:"NOT PROVIDED"),u),!0}return!1}function vv(t){return t!=null}function di(t){var r=t.vertexArray,e=t.header,n=e===void 0?"Attributes":e;if(!r.configuration)return{};var a={};r.elements&&(a.ELEMENT_ARRAY_BUFFER=ef(r,r.elements,null,n));var i=r.values;for(var o in i){var s=r._getAttributeInfo(o);if(s){var u="".concat(o,": ").concat(s.name),f=r.accessors[s.location];f&&(u="".concat(o,": ").concat(gv(s.name,f))),a[u]=ef(r,i[o],f,n)}}return a}function ef(t,r,e,n){var a,i=t.gl;if(!r){var o;return o={},l(o,n,"null"),l(o,"Format ","N/A"),o}var s="NOT PROVIDED",u=1,f=0,c=0,d,m,h;if(e&&(s=e.type,u=e.size,s=String(s).replace("Array",""),d=s.indexOf("nt")!==-1),r instanceof le){var p,v=r,g=v.getDebugData(),_=g.data,b=g.changed;m=b?"*":"",h=_,c=v.byteLength,f=c/_.BYTES_PER_ELEMENT/u;var C;if(e){var x=e.divisor>0;C="".concat(x?"I ":"P "," ").concat(f," (x").concat(u,"=").concat(c," bytes ").concat(Ve(i,s),")")}else d=!0,C="".concat(c," bytes");return p={},l(p,n,"".concat(m).concat(kt(h,{size:u,isInteger:d}))),l(p,"Format ",C),p}return h=r,u=r.length,s=String(r.constructor.name).replace("Array",""),d=s.indexOf("nt")!==-1,a={},l(a,n,"".concat(kt(h,{size:u,isInteger:d})," (constant)")),l(a,"Format ","".concat(u,"x").concat(s," (constant)")),a}function gv(t,r){var e=r.type,n=r.size,a=On(e,n);return a?"".concat(t," (").concat(a.name,")"):t}function tf(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Av(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Av(t,r){if(t){if(typeof t=="string")return rf(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return rf(t,r)}}function rf(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function mi(t){var r={},e="Accessors for ".concat(t.id),n=tf(t.attributeInfos),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;if(i){var o=nf(i);r["in ".concat(o)]=l({},e,JSON.stringify(i.accessor))}}}catch(d){n.e(d)}finally{n.f()}var s=tf(t.varyingInfos),u;try{for(s.s();!(u=s.n()).done;){var f=u.value;if(f){var c=nf(f);r["out ".concat(c)]=l({},e,JSON.stringify(f.accessor))}}}catch(d){s.e(d)}finally{s.f()}return r}function nf(t){var r=t.accessor,e=r.type,n=r.size,a=On(e,n);return a?"".concat(a.name," ").concat(t.name):t.name}var sr=oe(Kt());function yv(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=bv(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function bv(t,r){if(t){if(typeof t=="string")return af(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return af(t,r)}}function af(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var hi=Math.PI/180,Dn=new Float32Array(16),of=new Float32Array(12);function sf(t,r,e){var n=r[0]*hi,a=r[1]*hi,i=r[2]*hi,o=Math.sin(i),s=Math.sin(n),u=Math.sin(a),f=Math.cos(i),c=Math.cos(n),d=Math.cos(a),m=e[0],h=e[1],p=e[2];t[0]=m*d*c,t[1]=m*u*c,t[2]=m*-s,t[3]=h*(-u*f+d*s*o),t[4]=h*(d*f+u*s*o),t[5]=h*c*o,t[6]=p*(u*o+d*s*f),t[7]=p*(-d*o+u*s*f),t[8]=p*c*f}function uf(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}var Pn={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update:function(r,e){var n=e.startRow,a=e.endRow,i=this.props,o=i.data,s=i.getOrientation,u=i.getScale,f=i.getTranslation,c=i.getTransformMatrix,d=Array.isArray(c),m=d&&c.length===16,h=Array.isArray(u),p=Array.isArray(s),v=Array.isArray(f),g=m||!d&&Boolean(c(o[0]));g?r.constant=m:r.constant=p&&h&&v;var _=r.value;if(r.constant){var b;if(g)Dn.set(c),b=uf(Dn);else{b=of;var C=s,x=u;sf(b,C,x),b.set(f,9)}r.value=new Float32Array(b)}else{var T=n*r.size,R=(0,sr.createIterable)(o,n,a),D=R.iterable,V=R.objectInfo,U=yv(D),N;try{for(U.s();!(N=U.n()).done;){var J=N.value;V.index++;var L=void 0;if(g)Dn.set(m?c:c(J,V)),L=uf(Dn);else{L=of;var z=p?s:s(J,V),H=h?u:u(J,V);sf(L,z,H),L.set(v?f:f(J,V),9)}_[T++]=L[0],_[T++]=L[1],_[T++]=L[2],_[T++]=L[3],_[T++]=L[4],_[T++]=L[5],_[T++]=L[6],_[T++]=L[7],_[T++]=L[8],_[T++]=L[9],_[T++]=L[10],_[T++]=L[11]}}catch(se){U.e(se)}finally{U.f()}}}};function Gn(t,r){return r===sr.COORDINATE_SYSTEM.CARTESIAN||r===sr.COORDINATE_SYSTEM.METER_OFFSETS||r===sr.COORDINATE_SYSTEM.DEFAULT&&!t.isGeospatial}var ff=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var cf=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function Fr(t){for(var r=1/0,e=1/0,n=1/0,a=-1/0,i=-1/0,o=-1/0,s=t.POSITION?t.POSITION.value:[],u=s&&s.length,f=0;f<u;f+=3){var c=s[f],d=s[f+1],m=s[f+2];r=c<r?c:r,e=d<e?d:e,n=m<n?m:n,a=c>a?c:a,i=d>i?d:i,o=m>o?m:o}return[[r,e,n],[a,i,o]]}function lf(t,r){if(!t)throw new Error(r||"loader assertion failed.")}function pi(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=_v(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function _v(t,r){if(t){if(typeof t=="string")return df(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return df(t,r)}}function df(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Lr=function(){function t(r,e){y(this,t),l(this,"fields",void 0),l(this,"metadata",void 0),lf(Array.isArray(r)),Bv(r),this.fields=r,this.metadata=e||new Map}return E(t,[{key:"compareTo",value:function(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(var n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}},{key:"select",value:function(){for(var e=Object.create(null),n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];for(var o=0,s=a;o<s.length;o++){var u=s[o];e[u]=!0}var f=this.fields.filter(function(c){return e[c.name]});return new t(f,this.metadata)}},{key:"selectAt",value:function(){for(var e=this,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=a.map(function(s){return e.fields[s]}).filter(Boolean);return new t(o,this.metadata)}},{key:"assign",value:function(e){var n,a=this.metadata;if(e instanceof t){var i=e;n=i.fields,a=mf(mf(new Map,this.metadata),i.metadata)}else n=e;var o=Object.create(null),s=pi(this.fields),u;try{for(s.s();!(u=s.n()).done;){var f=u.value;o[f.name]=f}}catch(p){s.e(p)}finally{s.f()}var c=pi(n),d;try{for(c.s();!(d=c.n()).done;){var m=d.value;o[m.name]=m}}catch(p){c.e(p)}finally{c.f()}var h=Object.values(o);return new t(h,a)}}]),t}();function Bv(t){var r={},e=pi(t),n;try{for(e.s();!(n=e.n()).done;){var a=n.value;r[a.name]&&console.warn("Schema: duplicated field name",a.name,a),r[a.name]=!0}}catch(i){e.e(i)}finally{e.f()}}function mf(t,r){return new Map([].concat(Y(t||new Map),Y(r||new Map)))}var Dr=function(){function t(r,e){y(this,t);var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;l(this,"name",void 0),l(this,"type",void 0),l(this,"nullable",void 0),l(this,"metadata",void 0),this.name=r,this.type=e,this.nullable=n,this.metadata=a}return E(t,[{key:"typeId",get:function(){return this.type&&this.type.typeId}},{key:"clone",value:function(){return new t(this.name,this.type,this.nullable,this.metadata)}},{key:"compareTo",value:function(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}},{key:"toString",value:function(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}]),t}();var re=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({});function te(t){var r=Ev();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function Ev(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var hf,pf,vf,gf,Af,yf,bf,_f,De=function(){function t(){y(this,t)}return E(t,[{key:"typeId",get:function(){return re.NONE}},{key:"compareTo",value:function(e){return this===e}}],[{key:"isNull",value:function(e){return e&&e.typeId===re.Null}},{key:"isInt",value:function(e){return e&&e.typeId===re.Int}},{key:"isFloat",value:function(e){return e&&e.typeId===re.Float}},{key:"isBinary",value:function(e){return e&&e.typeId===re.Binary}},{key:"isUtf8",value:function(e){return e&&e.typeId===re.Utf8}},{key:"isBool",value:function(e){return e&&e.typeId===re.Bool}},{key:"isDecimal",value:function(e){return e&&e.typeId===re.Decimal}},{key:"isDate",value:function(e){return e&&e.typeId===re.Date}},{key:"isTime",value:function(e){return e&&e.typeId===re.Time}},{key:"isTimestamp",value:function(e){return e&&e.typeId===re.Timestamp}},{key:"isInterval",value:function(e){return e&&e.typeId===re.Interval}},{key:"isList",value:function(e){return e&&e.typeId===re.List}},{key:"isStruct",value:function(e){return e&&e.typeId===re.Struct}},{key:"isUnion",value:function(e){return e&&e.typeId===re.Union}},{key:"isFixedSizeBinary",value:function(e){return e&&e.typeId===re.FixedSizeBinary}},{key:"isFixedSizeList",value:function(e){return e&&e.typeId===re.FixedSizeList}},{key:"isMap",value:function(e){return e&&e.typeId===re.Map}},{key:"isDictionary",value:function(e){return e&&e.typeId===re.Dictionary}}]),t}(),Bf=function(t,r){w(n,t);var e=te(n);function n(){return y(this,n),e.apply(this,arguments)}return E(n,[{key:"typeId",get:function(){return re.Null}},{key:r,get:function(){return"Null"}},{key:"toString",value:function(){return"Null"}}]),n}(De,Symbol.toStringTag),Ef=function(t,r){w(n,t);var e=te(n);function n(){return y(this,n),e.apply(this,arguments)}return E(n,[{key:"typeId",get:function(){return re.Bool}},{key:r,get:function(){return"Bool"}},{key:"toString",value:function(){return"Bool"}}]),n}(De,Symbol.toStringTag);hf=Symbol.toStringTag;var nt=function(t,r){w(n,t);var e=te(n);function n(a,i){var o;return y(this,n),o=e.call(this),l(Z(o),"isSigned",void 0),l(Z(o),"bitWidth",void 0),o.isSigned=a,o.bitWidth=i,o}return E(n,[{key:"typeId",get:function(){return re.Int}},{key:r,get:function(){return"Int"}},{key:"toString",value:function(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}]),n}(De,hf),kn=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,!0,8)}return e}(nt),Un=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,!0,16)}return e}(nt),Nn=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,!0,32)}return e}(nt),xf=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,!0,64)}return e}(nt),Hn=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,!1,8)}return e}(nt),jn=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,!1,16)}return e}(nt),Vn=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,!1,32)}return e}(nt),Tf=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,!1,64)}return e}(nt),vi={HALF:16,SINGLE:32,DOUBLE:64};pf=Symbol.toStringTag;var Pr=function(t,r){w(n,t);var e=te(n);function n(a){var i;return y(this,n),i=e.call(this),l(Z(i),"precision",void 0),i.precision=a,i}return E(n,[{key:"typeId",get:function(){return re.Float}},{key:r,get:function(){return"Float"}},{key:"toString",value:function(){return"Float".concat(this.precision)}}]),n}(De,pf),Cf=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,vi.HALF)}return e}(Pr),Jn=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,vi.SINGLE)}return e}(Pr),Xn=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,vi.DOUBLE)}return e}(Pr),Sf=function(t,r){w(n,t);var e=te(n);function n(){return y(this,n),e.call(this)}return E(n,[{key:"typeId",get:function(){return re.Binary}},{key:"toString",value:function(){return"Binary"}},{key:r,get:function(){return"Binary"}}]),n}(De,Symbol.toStringTag),Mf=function(t,r){w(n,t);var e=te(n);function n(){return y(this,n),e.apply(this,arguments)}return E(n,[{key:"typeId",get:function(){return re.Utf8}},{key:r,get:function(){return"Utf8"}},{key:"toString",value:function(){return"Utf8"}}]),n}(De,Symbol.toStringTag),gi={DAY:0,MILLISECOND:1};vf=Symbol.toStringTag;var zn=function(t,r){w(n,t);var e=te(n);function n(a){var i;return y(this,n),i=e.call(this),l(Z(i),"unit",void 0),i.unit=a,i}return E(n,[{key:"typeId",get:function(){return re.Date}},{key:r,get:function(){return"Date"}},{key:"toString",value:function(){return"Date".concat((this.unit+1)*32,"<").concat(gi[this.unit],">")}}]),n}(De,vf),Rf=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,gi.DAY)}return e}(zn),If=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,gi.MILLISECOND)}return e}(zn),Bt={SECOND:1,MILLISECOND:1e3,MICROSECOND:1e6,NANOSECOND:1e9};gf=Symbol.toStringTag;var Wn=function(t,r){w(n,t);var e=te(n);function n(a,i){var o;return y(this,n),o=e.call(this),l(Z(o),"unit",void 0),l(Z(o),"bitWidth",void 0),o.unit=a,o.bitWidth=i,o}return E(n,[{key:"typeId",get:function(){return re.Time}},{key:"toString",value:function(){return"Time".concat(this.bitWidth,"<").concat(Bt[this.unit],">")}},{key:r,get:function(){return"Time"}}]),n}(De,gf),Of=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,Bt.SECOND,32)}return e}(Wn),wf=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,Bt.MILLISECOND,32)}return e}(Wn);Af=Symbol.toStringTag;var ur=function(t,r){w(n,t);var e=te(n);function n(a){var i;y(this,n);var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return i=e.call(this),l(Z(i),"unit",void 0),l(Z(i),"timezone",void 0),i.unit=a,i.timezone=o,i}return E(n,[{key:"typeId",get:function(){return re.Timestamp}},{key:r,get:function(){return"Timestamp"}},{key:"toString",value:function(){return"Timestamp<".concat(Bt[this.unit]).concat(this.timezone?", ".concat(this.timezone):"",">")}}]),n}(De,Af),Ff=function(t){w(e,t);var r=te(e);function e(){y(this,e);var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r.call(this,Bt.SECOND,n)}return e}(ur),Lf=function(t){w(e,t);var r=te(e);function e(){y(this,e);var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r.call(this,Bt.MILLISECOND,n)}return e}(ur),Df=function(t){w(e,t);var r=te(e);function e(){y(this,e);var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r.call(this,Bt.MICROSECOND,n)}return e}(ur),Pf=function(t){w(e,t);var r=te(e);function e(){y(this,e);var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r.call(this,Bt.NANOSECOND,n)}return e}(ur),Ai={DAY_TIME:0,YEAR_MONTH:1};yf=Symbol.toStringTag;var Kn=function(t,r){w(n,t);var e=te(n);function n(a){var i;return y(this,n),i=e.call(this),l(Z(i),"unit",void 0),i.unit=a,i}return E(n,[{key:"typeId",get:function(){return re.Interval}},{key:r,get:function(){return"Interval"}},{key:"toString",value:function(){return"Interval<".concat(Ai[this.unit],">")}}]),n}(De,yf),Gf=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,Ai.DAY_TIME)}return e}(Kn),kf=function(t){w(e,t);var r=te(e);function e(){return y(this,e),r.call(this,Ai.YEAR_MONTH)}return e}(Kn);bf=Symbol.toStringTag;var Yn=function(t,r){w(n,t);var e=te(n);function n(a,i){var o;return y(this,n),o=e.call(this),l(Z(o),"listSize",void 0),l(Z(o),"children",void 0),o.listSize=a,o.children=[i],o}return E(n,[{key:"typeId",get:function(){return re.FixedSizeList}},{key:"valueType",get:function(){return this.children[0].type}},{key:"valueField",get:function(){return this.children[0]}},{key:r,get:function(){return"FixedSizeList"}},{key:"toString",value:function(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}]),n}(De,bf);_f=Symbol.toStringTag;var Uf=function(t,r){w(n,t);var e=te(n);function n(a){var i;return y(this,n),i=e.call(this),l(Z(i),"children",void 0),i.children=a,i}return E(n,[{key:"typeId",get:function(){return re.Struct}},{key:"toString",value:function(){return"Struct<{".concat(this.children.map(function(i){return"".concat(i.name,":").concat(i.type)}).join(", "),"}>")}},{key:r,get:function(){return"Struct"}}]),n}(De,_f);function Nf(t){switch(t.constructor){case Int8Array:return new kn;case Uint8Array:return new Hn;case Int16Array:return new Un;case Uint16Array:return new jn;case Int32Array:return new Nn;case Uint32Array:return new Vn;case Float32Array:return new Jn;case Float64Array:return new Xn;default:throw new Error("array type not supported")}}function yi(t,r,e){var n=Nf(r.value),a=e||Hf(r),i=new Dr(t,new Yn(r.size,new Dr("value",n)),!1,a);return i}function Hf(t){var r=new Map;return"byteOffset"in t&&r.set("byteOffset",t.byteOffset.toString(10)),"byteStride"in t&&r.set("byteStride",t.byteStride.toString(10)),"normalized"in t&&r.set("normalized",t.normalized.toString()),r}function jf(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function Vf(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?jf(Object(e),!0).forEach(function(n){l(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):jf(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function xv(t){var r=Tv();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function Tv(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jf(t,r){var e=t.COLOR_0||t.colors,n=e&&r;n||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),it.log.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function Xf(t,r){if(t.attributes)return Jf(t.attributes,r),t instanceof at.Geometry?t:new at.Geometry(t);if(t.positions||t.POSITION)return Jf(t,r),new at.Geometry({attributes:t});throw Error("Invalid mesh")}var Cv=[0,0,0,255],Sv={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:function(r){return r.position}},getColor:{type:"accessor",value:Cv},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}},Qn=function(t){w(e,t);var r=xv(e);function e(){var n;y(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=r.call.apply(r,[this].concat(i)),l(Z(n),"state",void 0),n}return E(e,[{key:"getShaders",value:function(){var a=!(0,at.isWebGL2)(this.context.gl),i={};return or(this.context.gl,ue.GLSL_DERIVATIVES)&&(i.DERIVATIVES_AVAILABLE=1),ve(O(e.prototype),"getShaders",this).call(this,{vs:ff,fs:cf,modules:[it.project32,it.phongLighting,it.picking],transpileToGLSL100:a,defines:i})}},{key:"getBounds",value:function(){var a;if(this.props._instanced)return ve(O(e.prototype),"getBounds",this).call(this);var i=this.state.positionBounds;if(i)return i;var o=this.props.mesh;if(!o)return null;if(i=(a=o.header)===null||a===void 0?void 0:a.boundingBox,!i){var s=Xf(o,this.props._useMeshColors),u=s.attributes;u.POSITION=u.POSITION||u.positions,i=Fr(u)}return this.state.positionBounds=i,i}},{key:"initializeState",value:function(){var a=this.getAttributeManager();a.addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:Pn}),this.setState({emptyTexture:new at.Texture2D(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}},{key:"updateState",value:function(a){ve(O(e.prototype),"updateState",this).call(this,a);var i=a.props,o=a.oldProps,s=a.changeFlags;if(i.mesh!==o.mesh||s.extensionsChanged){var u;if(this.state.positionBounds=null,(u=this.state.model)===null||u===void 0||u.delete(),i.mesh){this.state.model=this.getModel(i.mesh);var f=i.mesh.attributes||i.mesh;this.setState({hasNormals:Boolean(f.NORMAL||f.normals)})}this.getAttributeManager().invalidateAll()}i.texture!==o.texture&&this.setTexture(i.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}},{key:"finalizeState",value:function(a){ve(O(e.prototype),"finalizeState",this).call(this,a),this.state.emptyTexture.delete()}},{key:"draw",value:function(a){var i=a.uniforms;if(this.state.model){var o=this.context.viewport,s=this.props,u=s.sizeScale,f=s.coordinateSystem,c=s._instanced;this.state.model.setUniforms(i).setUniforms({sizeScale:u,composeModelMatrix:!c||Gn(o,f),flatShading:!this.state.hasNormals}).draw()}}},{key:"getModel",value:function(a){var i=new at.Model(this.context.gl,Vf(Vf({},this.getShaders()),{},{id:this.props.id,geometry:Xf(a,this.props._useMeshColors),isInstanced:!0})),o=this.props.texture,s=this.state.emptyTexture;return i.setUniforms({sampler:o||s,hasTexture:Boolean(o)}),i}},{key:"setTexture",value:function(a){var i=this.state,o=i.emptyTexture,s=i.model;s&&s.setUniforms({sampler:a||o,hasTexture:Boolean(a)})}}]),e}(it.Layer);l(Qn,"defaultProps",Sv);l(Qn,"layerName","SimpleMeshLayer");var $e=oe(Kt()),Mm=oe(Ma());var Ut="vs",Gr="fs";function Le(t,r){if(!t)throw new Error(r||"shadertools: assertion failed.")}var bi={number:{validate:function(r,e){return Number.isFinite(r)&&(!("max"in e)||r<=e.max)&&(!("min"in e)||r>=e.min)}},array:{validate:function(r,e){return Array.isArray(r)||ArrayBuffer.isView(r)}}};function Wf(t){var r={};for(var e in t){var n=t[e],a=Mv(n);r[e]=a}return r}function Mv(t){var r=zf(t);return r==="object"?t?"type"in t?Object.assign({},t,bi[t.type]):"value"in t?(r=zf(t.value),Object.assign({type:r},t,bi[r])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:r,value:t},bi[r])}function zf(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":$(t)}var Rv="vs",Iv="fs",_i=function(){function t(r){y(this,t);var e=r.name,n=r.vs,a=r.fs,i=r.dependencies,o=i===void 0?[]:i,s=r.uniforms,u=r.getUniforms,f=r.deprecations,c=f===void 0?[]:f,d=r.defines,m=d===void 0?{}:d,h=r.inject,p=h===void 0?{}:h,v=r.vertexShader,g=r.fragmentShader;Le(typeof e=="string"),this.name=e,this.vs=n||v,this.fs=a||g,this.getModuleUniforms=u,this.dependencies=o,this.deprecations=this._parseDeprecationDefinitions(c),this.defines=m,this.injections=Ov(p),s&&(this.uniforms=Wf(s))}return E(t,[{key:"getModuleSource",value:function(e){var n;switch(e){case Rv:n=this.vs||"";break;case Iv:n=this.fs||"";break;default:Le(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}},{key:"getUniforms",value:function(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}},{key:"getDefines",value:function(){return this.defines}},{key:"checkDeprecations",value:function(e,n){this.deprecations.forEach(function(a){a.regex.test(e)&&(a.deprecated?n.deprecated(a.old,a.new)():n.removed(a.old,a.new)())})}},{key:"_parseDeprecationDefinitions",value:function(e){return e.forEach(function(n){switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}},{key:"_defaultGetUniforms",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n={},a=this.uniforms;for(var i in a){var o=a[i];i in e&&!o.private?(o.validate&&Le(o.validate(e[i],o),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=o.value}return n}}]),t}();function Ov(t){var r={vs:{},fs:{}};for(var e in t){var n=t[e],a=e.slice(0,2);typeof n=="string"&&(n={order:0,injection:n}),r[a][e]=n}return r}function Kf(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=wv(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function wv(t,r){if(t){if(typeof t=="string")return Yf(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Yf(t,r)}}function Yf(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Qf(t){return Fv(qf(t))}function Fv(t){var r={},e={};return $f({modules:t,level:0,moduleMap:r,moduleDepth:e}),Object.keys(e).sort(function(n,a){return e[a]-e[n]}).map(function(n){return r[n]})}function $f(t){var r=t.modules,e=t.level,n=t.moduleMap,a=t.moduleDepth;if(e>=5)throw new Error("Possible loop in shader dependency graph");var i=Kf(r),o;try{for(i.s();!(o=i.n()).done;){var s=o.value;n[s.name]=s,(a[s.name]===void 0||a[s.name]<e)&&(a[s.name]=e)}}catch(d){i.e(d)}finally{i.f()}var u=Kf(r),f;try{for(u.s();!(f=u.n()).done;){var c=f.value;c.dependencies&&$f({modules:c.dependencies,level:e+1,moduleMap:n,moduleDepth:a})}}catch(d){u.e(d)}finally{u.f()}}function qf(t,r){return t.map(function(e){return e instanceof _i||(Le(typeof e!="string","Shader module use by name is deprecated. Import shader module '".concat(e,"' and use it directly.")),Le(e.name,"shader module has no name"),e=new _i(e),e.dependencies=qf(e.dependencies)),e})}function Bi(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=typeof window<"u"?window.navigator||{}:{},e=t.userAgent||r.userAgent||"",n=e.indexOf("MSIE ")!==-1,a=e.indexOf("Trident/")!==-1;return n||a}var Lv=7936,Dv=7937,Pv=7938,Gv=35724,xi={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Et={};Object.keys(xi).forEach(function(t){Et[t]=t});function kv(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function Zf(t){var r=t.getExtension("WEBGL_debug_renderer_info"),e=t.getParameter(r&&r.UNMASKED_VENDOR_WEBGL||Lv),n=t.getParameter(r&&r.UNMASKED_RENDERER_WEBGL||Dv),a=Uv(e,n),i={gpuVendor:a,vendor:e,renderer:n,version:t.getParameter(Pv),shadingLanguageVersion:t.getParameter(Gv)};return i}function Uv(t,r){return t.match(/NVIDIA/i)||r.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||r.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||r.match(/AMD/i)||t.match(/ATI/i)||r.match(/ATI/i)?"AMD":"UNKNOWN GPU"}var Ei={};function Ti(t,r){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=xi[r];if(Le(n,r),!Bi(e))return!0;if(r in Ei)return Ei[r];var a=n[0],i=e.behavior||"enable",o="#extension GL_".concat(a," : ").concat(i,`
void main(void) {}`),s=t.createShader(35633);t.shaderSource(s,o),t.compileShader(s);var u=t.getShaderParameter(s,35713);return t.deleteShader(s),Ei[r]=u,u}function Nv(t,r){var e=xi[r];Le(e,r);var n=kv(t)&&e[1]||e[0],a=typeof n=="string"?Boolean(t.getExtension(n)):n;return Le(a===!1||a===!0),a}function kr(t,r){return r=Array.isArray(r)?r:[r],r.every(function(e){return Nv(t,e)})}function ec(t){var r=Zf(t);switch(r.gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function tc(t,r,e){var n=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return kr(t,Et.GLSL_FRAG_DEPTH)&&(n+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),kr(t,Et.GLSL_DERIVATIVES)&&Ti(t,Et.GLSL_DERIVATIVES)&&(n+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),kr(t,Et.GLSL_FRAG_DATA)&&Ti(t,Et.GLSL_FRAG_DATA,{behavior:"require"})&&(n+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),kr(t,Et.GLSL_TEXTURE_LOD)&&(n+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),n}var rc=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,nc=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`;var $n,Hv=($n={},l($n,Ut,rc),l($n,Gr,nc),$n),Ur="__LUMA_INJECT_DECLARATIONS__",ac=/void\s+main\s*\([^)]*\)\s*\{\n?/,ic=/}\n?[^{}]*$/,Ci=[];function qn(t,r,e){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=r===Ut,i=function(u){var f=e[u];f.sort(function(h,p){return h.order-p.order}),Ci.length=f.length;for(var c=0,d=f.length;c<d;++c)Ci[c]=f[c].injection;var m="".concat(Ci.join(`
`),`
`);switch(u){case"vs:#decl":a&&(t=t.replace(Ur,m));break;case"vs:#main-start":a&&(t=t.replace(ac,function(h){return h+m}));break;case"vs:#main-end":a&&(t=t.replace(ic,function(h){return m+h}));break;case"fs:#decl":a||(t=t.replace(Ur,m));break;case"fs:#main-start":a||(t=t.replace(ac,function(h){return h+m}));break;case"fs:#main-end":a||(t=t.replace(ic,function(h){return m+h}));break;default:t=t.replace(u,function(h){return h+m})}};for(var o in e)i(o);return t=t.replace(Ur,""),n&&(t=t.replace(/\}\s*$/,function(s){return s+Hv[r]})),t}function jv(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Vv(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Vv(t,r){if(t){if(typeof t=="string")return oc(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return oc(t,r)}}function oc(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function fr(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}var sc=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Jv=[].concat(sc,[[fr("attribute"),"in $1"],[fr("varying"),"out $1"]]),Xv=[].concat(sc,[[fr("varying"),"in $1"]]),uc=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],zv=[].concat(uc,[[fr("in"),"attribute $1"],[fr("out"),"varying $1"]]),Wv=[].concat(uc,[[fr("in"),"varying $1"]]),Si="gl_FragColor",Mi=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Kv=/void\s+main\s*\([^)]*\)\s*\{\n?/;function Ri(t,r,e){switch(r){case 300:return e?Zn(t,Jv):Yv(t);case 100:return e?Zn(t,zv):Qv(t);default:throw new Error("unknown GLSL version ".concat(r))}}function Zn(t,r){var e=jv(r),n;try{for(e.s();!(n=e.n()).done;){var a=ae(n.value,2),i=a[0],o=a[1];t=t.replace(i,o)}}catch(s){e.e(s)}finally{e.f()}return t}function Yv(t){t=Zn(t,Xv);var r=t.match(Mi);if(r){var e=r[1];t=t.replace(new RegExp("\\b".concat(Si,"\\b"),"g"),e)}else{var n="fragmentColor";t=t.replace(Kv,function(a){return"out vec4 ".concat(n,`;
`).concat(a)}).replace(new RegExp("\\b".concat(Si,"\\b"),"g"),n)}return t}function Qv(t){t=Zn(t,Wv);var r=t.match(Mi);if(r){var e=r[1];t=t.replace(Mi,"").replace(new RegExp("\\b".concat(e,"\\b"),"g"),Si)}return t}var ea;function Ii(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=$v(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function $v(t,r){if(t){if(typeof t=="string")return fc(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return fc(t,r)}}function fc(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var qv=`

`.concat(Ur,`

`),lc=(ea={},l(ea,Ut,"vertex"),l(ea,Gr,"fragment"),ea),Zv=`precision highp float;

`;function Oi(t,r){var e=r.vs,n=r.fs,a=Qf(r.modules||[]);return{gl:t,vs:cc(t,Object.assign({},r,{source:e,type:Ut,modules:a})),fs:cc(t,Object.assign({},r,{source:n,type:Gr,modules:a})),getUniforms:eg(a)}}function cc(t,r){var e=r.id,n=r.source,a=r.type,i=r.modules,o=r.defines,s=o===void 0?{}:o,u=r.hookFunctions,f=u===void 0?[]:u,c=r.inject,d=c===void 0?{}:c,m=r.transpileToGLSL100,h=m===void 0?!1:m,p=r.prologue,v=p===void 0?!0:p,g=r.log;Le(typeof n=="string","shader source must be a string");var _=a===Ut,b=n.split(`
`),C=100,x="",T=n;b[0].indexOf("#version ")===0?(C=300,x=b[0],T=b.slice(1).join(`
`)):x="#version ".concat(C);var R={};i.forEach(function(qe){Object.assign(R,qe.getDefines())}),Object.assign(R,s);var D=v?"".concat(x,`
`).concat(rg({id:e,source:n,type:a}),`
`).concat(tg({type:a}),`
`).concat(ec(t),`
`).concat(tc(t,C,!_),`
`).concat(ng(R),`
`).concat(_?"":Zv,`
`):"".concat(x,`
`),V=ig(f),U={},N={},J={};for(var L in d){var z=typeof d[L]=="string"?{injection:d[L],order:0}:d[L],H=L.match(/^(v|f)s:(#)?([\w-]+)$/);if(H){var se=H[2],B=H[3];se?B==="decl"?N[L]=[z]:J[L]=[z]:U[L]=[z]}else J[L]=[z]}var A=Ii(i),I;try{for(A.s();!(I=A.n()).done;){var G=I.value;g&&G.checkDeprecations(T,g);var j=G.getModuleSource(a,C);D+=j;var ee=G.injections[a];for(var ie in ee){var pe=ie.match(/^(v|f)s:#([\w-]+)$/);if(pe){var be=pe[2],_e=be==="decl"?N:J;_e[ie]=_e[ie]||[],_e[ie].push(ee[ie])}else U[ie]=U[ie]||[],U[ie].push(ee[ie])}}}catch(qe){A.e(qe)}finally{A.f()}return D+=qv,D=qn(D,a,N),D+=ag(V[a],U),D+=T,D=qn(D,a,J),D=Ri(D,h?100:C,_),D}function eg(t){return function(e){var n={},a=Ii(t),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s=o.getUniforms(e,n);Object.assign(n,s)}}catch(u){a.e(u)}finally{a.f()}return n}}function tg(t){var r=t.type;return`
#define SHADER_TYPE_`.concat(lc[r].toUpperCase(),`
`)}function rg(t){var r=t.id,e=t.source,n=t.type,a=r&&typeof r=="string"&&e.indexOf("SHADER_NAME")===-1;return a?`
#define SHADER_NAME `.concat(r,"_").concat(lc[n],`

`):""}function ng(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=0,e="";for(var n in t){r===0&&(e+=`
// APPLICATION DEFINES
`),r++;var a=t[n];(a||Number.isFinite(a))&&(e+="#define ".concat(n.toUpperCase()," ").concat(t[n],`
`))}return r===0&&(e+=`
`),e}function ag(t,r){var e="";for(var n in t){var a=t[n];if(e+="void ".concat(a.signature,` {
`),a.header&&(e+="  ".concat(a.header)),r[n]){var i=r[n];i.sort(function(f,c){return f.order-c.order});var o=Ii(i),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;e+="  ".concat(u.injection,`
`)}}catch(f){o.e(f)}finally{o.f()}}a.footer&&(e+="  ".concat(a.footer)),e+=`}
`}return e}function ig(t){var r={vs:{},fs:{}};return t.forEach(function(e){var n;typeof e!="string"?(n=e,e=n.hook):n={},e=e.trim();var a=e.split(":"),i=ae(a,2),o=i[0],s=i[1],u=e.replace(/\(.+/,"");r[o][u]=Object.assign(n,{signature:s})}),r}function ta(t,r){if(!t)throw new Error("math.gl assertion ".concat(r))}var gM=1/Math.PI*180,AM=1/180*Math.PI,Ee={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function dc(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=r.precision,n=e===void 0?Ee.precision:e;return t=og(t),"".concat(parseFloat(t.toPrecision(n)))}function xt(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function wi(t,r,e){var n=Ee.EPSILON;e&&(Ee.EPSILON=e);try{if(t===r)return!0;if(xt(t)&&xt(r)){if(t.length!==r.length)return!1;for(var a=0;a<t.length;++a)if(!wi(t[a],r[a]))return!1;return!0}return t&&t.equals?t.equals(r):r&&r.equals?r.equals(t):typeof t=="number"&&typeof r=="number"?Math.abs(t-r)<=Ee.EPSILON*Math.max(1,Math.abs(t),Math.abs(r)):!1}finally{Ee.EPSILON=n}}function og(t){return Math.round(t/Ee.EPSILON)*Ee.EPSILON}function sg(t){var r=ug();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function ug(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fg(t){function r(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return r.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t,r}var cr=function(t){w(e,t);var r=sg(e);function e(){return y(this,e),r.apply(this,arguments)}return E(e,[{key:"clone",value:function(){return new this.constructor().copy(this)}},{key:"fromArray",value:function(a){for(var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=0;o<this.ELEMENTS;++o)this[o]=a[o+i];return this.check()}},{key:"toArray",value:function(){for(var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=0;o<this.ELEMENTS;++o)a[i+o]=this[o];return a}},{key:"from",value:function(a){return Array.isArray(a)?this.copy(a):this.fromObject(a)}},{key:"to",value:function(a){return a===this?this:xt(a)?this.toArray(a):this.toObject(a)}},{key:"toTarget",value:function(a){return a?this.to(a):this}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(Ee)}},{key:"formatString",value:function(a){for(var i="",o=0;o<this.ELEMENTS;++o)i+=(o>0?", ":"")+dc(this[o],a);return"".concat(a.printTypes?this.constructor.name:"","[").concat(i,"]")}},{key:"equals",value:function(a){if(!a||this.length!==a.length)return!1;for(var i=0;i<this.ELEMENTS;++i)if(!wi(this[i],a[i]))return!1;return!0}},{key:"exactEquals",value:function(a){if(!a||this.length!==a.length)return!1;for(var i=0;i<this.ELEMENTS;++i)if(this[i]!==a[i])return!1;return!0}},{key:"negate",value:function(){for(var a=0;a<this.ELEMENTS;++a)this[a]=-this[a];return this.check()}},{key:"lerp",value:function(a,i,o){if(o===void 0)return this.lerp(this,a,i);for(var s=0;s<this.ELEMENTS;++s){var u=a[s];this[s]=u+o*(i[s]-u)}return this.check()}},{key:"min",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]=Math.min(a[i],this[i]);return this.check()}},{key:"max",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]=Math.max(a[i],this[i]);return this.check()}},{key:"clamp",value:function(a,i){for(var o=0;o<this.ELEMENTS;++o)this[o]=Math.min(Math.max(this[o],a[o]),i[o]);return this.check()}},{key:"add",value:function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];for(var s=0,u=i;s<u.length;s++)for(var f=u[s],c=0;c<this.ELEMENTS;++c)this[c]+=f[c];return this.check()}},{key:"subtract",value:function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];for(var s=0,u=i;s<u.length;s++)for(var f=u[s],c=0;c<this.ELEMENTS;++c)this[c]-=f[c];return this.check()}},{key:"scale",value:function(a){if(typeof a=="number")for(var i=0;i<this.ELEMENTS;++i)this[i]*=a;else for(var o=0;o<this.ELEMENTS&&o<a.length;++o)this[o]*=a[o];return this.check()}},{key:"multiplyByScalar",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]*=a;return this.check()}},{key:"check",value:function(){if(Ee.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var a=this.length===this.ELEMENTS,i=0;i<this.ELEMENTS;++i)a=a&&Number.isFinite(this[i]);return a}},{key:"sub",value:function(a){return this.subtract(a)}},{key:"setScalar",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]=a;return this.check()}},{key:"addScalar",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]+=a;return this.check()}},{key:"subScalar",value:function(a){return this.addScalar(-a)}},{key:"multiplyScalar",value:function(a){for(var i=0;i<this.ELEMENTS;++i)this[i]*=a;return this.check()}},{key:"divideScalar",value:function(a){return this.multiplyByScalar(1/a)}},{key:"clampScalar",value:function(a,i){for(var o=0;o<this.ELEMENTS;++o)this[o]=Math.min(Math.max(this[o],a),i);return this.check()}},{key:"elements",get:function(){return this}}]),e}(fg(Array));function cg(t,r){if(t.length!==r)return!1;for(var e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}function ne(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Tt(t,r){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(Ee.debug&&!cg(t,r))throw new Error("math.gl: ".concat(e," some fields set to invalid numbers'"));return t}function lg(t){var r=dg();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function dg(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ra=function(t){w(e,t);var r=lg(e);function e(){return y(this,e),r.apply(this,arguments)}return E(e,[{key:"x",get:function(){return this[0]},set:function(a){this[0]=ne(a)}},{key:"y",get:function(){return this[1]},set:function(a){this[1]=ne(a)}},{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return this.len()}},{key:"lengthSquared",value:function(){for(var a=0,i=0;i<this.ELEMENTS;++i)a+=this[i]*this[i];return a}},{key:"magnitudeSquared",value:function(){return this.lengthSquared()}},{key:"distance",value:function(a){return Math.sqrt(this.distanceSquared(a))}},{key:"distanceSquared",value:function(a){for(var i=0,o=0;o<this.ELEMENTS;++o){var s=this[o]-a[o];i+=s*s}return ne(i)}},{key:"dot",value:function(a){for(var i=0,o=0;o<this.ELEMENTS;++o)i+=this[o]*a[o];return ne(i)}},{key:"normalize",value:function(){var a=this.magnitude();if(a!==0)for(var i=0;i<this.ELEMENTS;++i)this[i]/=a;return this.check()}},{key:"multiply",value:function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];for(var s=0,u=i;s<u.length;s++)for(var f=u[s],c=0;c<this.ELEMENTS;++c)this[c]*=f[c];return this.check()}},{key:"divide",value:function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];for(var s=0,u=i;s<u.length;s++)for(var f=u[s],c=0;c<this.ELEMENTS;++c)this[c]/=f[c];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(a){return this.distance(a)}},{key:"distanceToSquared",value:function(a){return this.distanceSquared(a)}},{key:"getComponent",value:function(a){return ta(a>=0&&a<this.ELEMENTS,"index is out of range"),ne(this[a])}},{key:"setComponent",value:function(a,i){return ta(a>=0&&a<this.ELEMENTS,"index is out of range"),this[a]=i,this.check()}},{key:"addVectors",value:function(a,i){return this.copy(a).add(i)}},{key:"subVectors",value:function(a,i){return this.copy(a).subtract(i)}},{key:"multiplyVectors",value:function(a,i){return this.copy(a).multiply(i)}},{key:"addScaledVector",value:function(a,i){return this.add(new this.constructor(a).multiplyScalar(i))}}]),e}(cr);var Ye=1e-6,Me=typeof Float32Array<"u"?Float32Array:Array;var kM=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,r=arguments.length;r--;)t+=arguments[r]*arguments[r];return Math.sqrt(t)});function mg(){var t=new Me(2);return Me!=Float32Array&&(t[0]=0,t[1]=0),t}function mc(t,r,e){var n=r[0],a=r[1];return t[0]=e[0]*n+e[3]*a+e[6],t[1]=e[1]*n+e[4]*a+e[7],t}function hc(t,r,e){var n=r[0],a=r[1];return t[0]=e[0]*n+e[4]*a+e[12],t[1]=e[1]*n+e[5]*a+e[13],t}var UM=function(){var t=mg();return function(r,e,n,a,i,o){var s,u;for(e||(e=2),n||(n=0),a?u=Math.min(a*e+n,r.length):u=r.length,s=n;s<u;s+=e)t[0]=r[s],t[1]=r[s+1],i(t,t,o),r[s]=t[0],r[s+1]=t[1];return r}}();function vc(t,r,e){var n=r[0],a=r[1],i=e[3]*n+e[7]*a||1;return t[0]=(e[0]*n+e[4]*a)/i,t[1]=(e[1]*n+e[5]*a)/i,t}function na(t,r,e){var n=r[0],a=r[1],i=r[2],o=e[3]*n+e[7]*a+e[11]*i||1;return t[0]=(e[0]*n+e[4]*a+e[8]*i)/o,t[1]=(e[1]*n+e[5]*a+e[9]*i)/o,t[2]=(e[2]*n+e[6]*a+e[10]*i)/o,t}function gc(t,r,e){var n=r[0],a=r[1];return t[0]=e[0]*n+e[2]*a,t[1]=e[1]*n+e[3]*a,t[2]=r[2],t}function Ac(t,r,e){var n=r[0],a=r[1];return t[0]=e[0]*n+e[2]*a,t[1]=e[1]*n+e[3]*a,t[2]=r[2],t[3]=r[3],t}function aa(t,r,e){var n=r[0],a=r[1],i=r[2];return t[0]=e[0]*n+e[3]*a+e[6]*i,t[1]=e[1]*n+e[4]*a+e[7]*i,t[2]=e[2]*n+e[5]*a+e[8]*i,t[3]=r[3],t}function Li(){var t=new Me(3);return Me!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function hg(t){var r=t[0],e=t[1],n=t[2];return Math.hypot(r,e,n)}function Di(t,r,e){var n=new Me(3);return n[0]=t,n[1]=r,n[2]=e,n}function yc(t,r){var e=r[0],n=r[1],a=r[2],i=e*e+n*n+a*a;return i>0&&(i=1/Math.sqrt(i)),t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t}function Pi(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]}function dr(t,r,e){var n=r[0],a=r[1],i=r[2],o=e[0],s=e[1],u=e[2];return t[0]=a*u-i*s,t[1]=i*o-n*u,t[2]=n*s-a*o,t}function mr(t,r,e){var n=r[0],a=r[1],i=r[2],o=e[3]*n+e[7]*a+e[11]*i+e[15];return o=o||1,t[0]=(e[0]*n+e[4]*a+e[8]*i+e[12])/o,t[1]=(e[1]*n+e[5]*a+e[9]*i+e[13])/o,t[2]=(e[2]*n+e[6]*a+e[10]*i+e[14])/o,t}function ia(t,r,e){var n=r[0],a=r[1],i=r[2];return t[0]=n*e[0]+a*e[3]+i*e[6],t[1]=n*e[1]+a*e[4]+i*e[7],t[2]=n*e[2]+a*e[5]+i*e[8],t}function oa(t,r,e){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1],f=r[2],c=a*f-i*u,d=i*s-n*f,m=n*u-a*s,h=a*m-i*d,p=i*c-n*m,v=n*d-a*c,g=o*2;return c*=g,d*=g,m*=g,h*=2,p*=2,v*=2,t[0]=s+c+h,t[1]=u+d+p,t[2]=f+m+v,t}function bc(t,r,e,n){var a=[],i=[];return a[0]=r[0]-e[0],a[1]=r[1]-e[1],a[2]=r[2]-e[2],i[0]=a[0],i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),t[0]=i[0]+e[0],t[1]=i[1]+e[1],t[2]=i[2]+e[2],t}function _c(t,r,e,n){var a=[],i=[];return a[0]=r[0]-e[0],a[1]=r[1]-e[1],a[2]=r[2]-e[2],i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),i[1]=a[1],i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),t[0]=i[0]+e[0],t[1]=i[1]+e[1],t[2]=i[2]+e[2],t}function Bc(t,r,e,n){var a=[],i=[];return a[0]=r[0]-e[0],a[1]=r[1]-e[1],a[2]=r[2]-e[2],i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),i[2]=a[2],t[0]=i[0]+e[0],t[1]=i[1]+e[1],t[2]=i[2]+e[2],t}function Ec(t,r){var e=t[0],n=t[1],a=t[2],i=r[0],o=r[1],s=r[2],u=Math.sqrt(e*e+n*n+a*a),f=Math.sqrt(i*i+o*o+s*s),c=u*f,d=c&&Pi(t,r)/c;return Math.acos(Math.min(Math.max(d,-1),1))}var xc=hg;var HM=function(){var t=Li();return function(r,e,n,a,i,o){var s,u;for(e||(e=3),n||(n=0),a?u=Math.min(a*e+n,r.length):u=r.length,s=n;s<u;s+=e)t[0]=r[s],t[1]=r[s+1],t[2]=r[s+2],i(t,t,o),r[s]=t[0],r[s+1]=t[1],r[s+2]=t[2];return r}}();function pg(t){var r=vg();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function vg(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Gi=[0,0,0],sa,Qe=function(t){w(e,t);var r=pg(e);function e(){var n,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return y(this,e),n=r.call(this,-0,-0,-0),arguments.length===1&&xt(a)?n.copy(a):(Ee.debug&&(ne(a),ne(i),ne(o)),n[0]=a,n[1]=i,n[2]=o),n}return E(e,[{key:"set",value:function(a,i,o){return this[0]=a,this[1]=i,this[2]=o,this.check()}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this.check()}},{key:"fromObject",value:function(a){return Ee.debug&&(ne(a.x),ne(a.y),ne(a.z)),this[0]=a.x,this[1]=a.y,this[2]=a.z,this.check()}},{key:"toObject",value:function(a){return a.x=this[0],a.y=this[1],a.z=this[2],a}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(a){this[2]=ne(a)}},{key:"angle",value:function(a){return Ec(this,a)}},{key:"cross",value:function(a){return dr(this,this,a),this.check()}},{key:"rotateX",value:function(a){var i=a.radians,o=a.origin,s=o===void 0?Gi:o;return bc(this,this,s,i),this.check()}},{key:"rotateY",value:function(a){var i=a.radians,o=a.origin,s=o===void 0?Gi:o;return _c(this,this,s,i),this.check()}},{key:"rotateZ",value:function(a){var i=a.radians,o=a.origin,s=o===void 0?Gi:o;return Bc(this,this,s,i),this.check()}},{key:"transform",value:function(a){return this.transformAsPoint(a)}},{key:"transformAsPoint",value:function(a){return mr(this,this,a),this.check()}},{key:"transformAsVector",value:function(a){return na(this,this,a),this.check()}},{key:"transformByMatrix3",value:function(a){return ia(this,this,a),this.check()}},{key:"transformByMatrix2",value:function(a){return gc(this,this,a),this.check()}},{key:"transformByQuaternion",value:function(a){return oa(this,this,a),this.check()}}],[{key:"ZERO",get:function(){return sa||(sa=new e(0,0,0),Object.freeze(sa)),sa}}]),e}(ra);function gg(t){var r=Ag();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function Ag(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ua,Tc=function(t){w(e,t);var r=gg(e);function e(){var n,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return y(this,e),n=r.call(this,-0,-0,-0,-0),xt(a)&&arguments.length===1?n.copy(a):(Ee.debug&&(ne(a),ne(i),ne(o),ne(s)),n[0]=a,n[1]=i,n[2]=o,n[3]=s),n}return E(e,[{key:"set",value:function(a,i,o,s){return this[0]=a,this[1]=i,this[2]=o,this[3]=s,this.check()}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this.check()}},{key:"fromObject",value:function(a){return Ee.debug&&(ne(a.x),ne(a.y),ne(a.z),ne(a.w)),this[0]=a.x,this[1]=a.y,this[2]=a.z,this[3]=a.w,this}},{key:"toObject",value:function(a){return a.x=this[0],a.y=this[1],a.z=this[2],a.w=this[3],a}},{key:"ELEMENTS",get:function(){return 4}},{key:"z",get:function(){return this[2]},set:function(a){this[2]=ne(a)}},{key:"w",get:function(){return this[3]},set:function(a){this[3]=ne(a)}},{key:"transform",value:function(a){return mr(this,this,a),this.check()}},{key:"transformByMatrix3",value:function(a){return aa(this,this,a),this.check()}},{key:"transformByMatrix2",value:function(a){return Ac(this,this,a),this.check()}},{key:"transformByQuaternion",value:function(a){return oa(this,this,a),this.check()}},{key:"applyMatrix4",value:function(a){return a.transform(this,this),this}}],[{key:"ZERO",get:function(){return ua||(ua=new e(0,0,0,0),Object.freeze(ua)),ua}}]),e}(ra);function yg(t){var r=bg();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function bg(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var fa=function(t){w(e,t);var r=yg(e);function e(){return y(this,e),r.apply(this,arguments)}return E(e,[{key:"toString",value:function(){var a="[";if(Ee.printRowMajor){a+="row-major:";for(var i=0;i<this.RANK;++i)for(var o=0;o<this.RANK;++o)a+=" ".concat(this[o*this.RANK+i])}else{a+="column-major:";for(var s=0;s<this.ELEMENTS;++s)a+=" ".concat(this[s])}return a+="]",a}},{key:"getElementIndex",value:function(a,i){return i*this.RANK+a}},{key:"getElement",value:function(a,i){return this[i*this.RANK+a]}},{key:"setElement",value:function(a,i,o){return this[i*this.RANK+a]=ne(o),this}},{key:"getColumn",value:function(a){for(var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Array(this.RANK).fill(-0),o=a*this.RANK,s=0;s<this.RANK;++s)i[s]=this[o+s];return i}},{key:"setColumn",value:function(a,i){for(var o=a*this.RANK,s=0;s<this.RANK;++s)this[o+s]=i[s];return this}}]),e}(cr);function Cc(){var t=new Me(9);return Me!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Sc(t,r){if(t===r){var e=r[1],n=r[2],a=r[5];t[1]=r[3],t[2]=r[6],t[3]=e,t[5]=r[7],t[6]=n,t[7]=a}else t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8];return t}function Mc(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=r[4],s=r[5],u=r[6],f=r[7],c=r[8],d=c*o-s*f,m=-c*i+s*u,h=f*i-o*u,p=e*d+n*m+a*h;return p?(p=1/p,t[0]=d*p,t[1]=(-c*n+a*f)*p,t[2]=(s*n-a*o)*p,t[3]=m*p,t[4]=(c*e-a*u)*p,t[5]=(-s*e+a*i)*p,t[6]=h*p,t[7]=(-f*e+n*u)*p,t[8]=(o*e-n*i)*p,t):null}function Rc(t){var r=t[0],e=t[1],n=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],f=t[8];return r*(f*i-o*u)+e*(-f*a+o*s)+n*(u*a-i*s)}function ki(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],f=r[6],c=r[7],d=r[8],m=e[0],h=e[1],p=e[2],v=e[3],g=e[4],_=e[5],b=e[6],C=e[7],x=e[8];return t[0]=m*n+h*o+p*f,t[1]=m*a+h*s+p*c,t[2]=m*i+h*u+p*d,t[3]=v*n+g*o+_*f,t[4]=v*a+g*s+_*c,t[5]=v*i+g*u+_*d,t[6]=b*n+C*o+x*f,t[7]=b*a+C*s+x*c,t[8]=b*i+C*u+x*d,t}function Ic(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],f=r[6],c=r[7],d=r[8],m=e[0],h=e[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=u,t[6]=m*n+h*o+f,t[7]=m*a+h*s+c,t[8]=m*i+h*u+d,t}function Oc(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],f=r[6],c=r[7],d=r[8],m=Math.sin(e),h=Math.cos(e);return t[0]=h*n+m*o,t[1]=h*a+m*s,t[2]=h*i+m*u,t[3]=h*o-m*n,t[4]=h*s-m*a,t[5]=h*u-m*i,t[6]=f,t[7]=c,t[8]=d,t}function Ui(t,r,e){var n=e[0],a=e[1];return t[0]=n*r[0],t[1]=n*r[1],t[2]=n*r[2],t[3]=a*r[3],t[4]=a*r[4],t[5]=a*r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t}function wc(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=e+e,s=n+n,u=a+a,f=e*o,c=n*o,d=n*s,m=a*o,h=a*s,p=a*u,v=i*o,g=i*s,_=i*u;return t[0]=1-d-p,t[3]=c-_,t[6]=m+g,t[1]=c+_,t[4]=1-f-p,t[7]=h-v,t[2]=m-g,t[5]=h+v,t[8]=1-f-d,t}function _g(t){var r=Bg();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function Bg(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ni;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(Ni||(Ni={}));var Eg=Object.freeze([1,0,0,0,1,0,0,0,1]),Nt=function(t){w(e,t);var r=_g(e);function e(n){for(var a,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return y(this,e),a=r.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(n)?a.copy(n):o.length>0?a.copy([n].concat(o)):a.identity(),a}return E(e,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return Ni}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this[4]=a[4],this[5]=a[5],this[6]=a[6],this[7]=a[7],this[8]=a[8],this.check()}},{key:"identity",value:function(){return this.copy(Eg)}},{key:"fromObject",value:function(a){return this.check()}},{key:"fromQuaternion",value:function(a){return wc(this,a),this.check()}},{key:"set",value:function(a,i,o,s,u,f,c,d,m){return this[0]=a,this[1]=i,this[2]=o,this[3]=s,this[4]=u,this[5]=f,this[6]=c,this[7]=d,this[8]=m,this.check()}},{key:"setRowMajor",value:function(a,i,o,s,u,f,c,d,m){return this[0]=a,this[1]=s,this[2]=c,this[3]=i,this[4]=u,this[5]=d,this[6]=o,this[7]=f,this[8]=m,this.check()}},{key:"determinant",value:function(){return Rc(this)}},{key:"transpose",value:function(){return Sc(this,this),this.check()}},{key:"invert",value:function(){return Mc(this,this),this.check()}},{key:"multiplyLeft",value:function(a){return ki(this,a,this),this.check()}},{key:"multiplyRight",value:function(a){return ki(this,this,a),this.check()}},{key:"rotate",value:function(a){return Oc(this,this,a),this.check()}},{key:"scale",value:function(a){return Array.isArray(a)?Ui(this,this,a):Ui(this,this,[a,a]),this.check()}},{key:"translate",value:function(a){return Ic(this,this,a),this.check()}},{key:"transform",value:function(a,i){var o;switch(a.length){case 2:o=mc(i||[-0,-0],a,this);break;case 3:o=ia(i||[-0,-0,-0],a,this);break;case 4:o=aa(i||[-0,-0,-0,-0],a,this);break;default:throw new Error("Illegal vector")}return Tt(o,a.length),o}},{key:"transformVector",value:function(a,i){return this.transform(a,i)}},{key:"transformVector2",value:function(a,i){return this.transform(a,i)}},{key:"transformVector3",value:function(a,i){return this.transform(a,i)}}],[{key:"IDENTITY",get:function(){return Tg()}},{key:"ZERO",get:function(){return xg()}}]),e}(fa);var ca,la;function xg(){return ca||(ca=new Nt([0,0,0,0,0,0,0,0,0]),Object.freeze(ca)),ca}function Tg(){return la||(la=new Nt,Object.freeze(la)),la}function Cg(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Lc(t,r){if(t===r){var e=r[1],n=r[2],a=r[3],i=r[6],o=r[7],s=r[11];t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=e,t[6]=r[9],t[7]=r[13],t[8]=n,t[9]=i,t[11]=r[14],t[12]=a,t[13]=o,t[14]=s}else t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15];return t}function Dc(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=r[4],s=r[5],u=r[6],f=r[7],c=r[8],d=r[9],m=r[10],h=r[11],p=r[12],v=r[13],g=r[14],_=r[15],b=e*s-n*o,C=e*u-a*o,x=e*f-i*o,T=n*u-a*s,R=n*f-i*s,D=a*f-i*u,V=c*v-d*p,U=c*g-m*p,N=c*_-h*p,J=d*g-m*v,L=d*_-h*v,z=m*_-h*g,H=b*z-C*L+x*J+T*N-R*U+D*V;return H?(H=1/H,t[0]=(s*z-u*L+f*J)*H,t[1]=(a*L-n*z-i*J)*H,t[2]=(v*D-g*R+_*T)*H,t[3]=(m*R-d*D-h*T)*H,t[4]=(u*N-o*z-f*U)*H,t[5]=(e*z-a*N+i*U)*H,t[6]=(g*x-p*D-_*C)*H,t[7]=(c*D-m*x+h*C)*H,t[8]=(o*L-s*N+f*V)*H,t[9]=(n*N-e*L-i*V)*H,t[10]=(p*R-v*x+_*b)*H,t[11]=(d*x-c*R-h*b)*H,t[12]=(s*U-o*J-u*V)*H,t[13]=(e*J-n*U+a*V)*H,t[14]=(v*C-p*T-g*b)*H,t[15]=(c*T-d*C+m*b)*H,t):null}function Pc(t){var r=t[0],e=t[1],n=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],f=t[8],c=t[9],d=t[10],m=t[11],h=t[12],p=t[13],v=t[14],g=t[15],_=r*o-e*i,b=r*s-n*i,C=r*u-a*i,x=e*s-n*o,T=e*u-a*o,R=n*u-a*s,D=f*p-c*h,V=f*v-d*h,U=f*g-m*h,N=c*v-d*p,J=c*g-m*p,L=d*g-m*v;return _*L-b*J+C*N+x*U-T*V+R*D}function Hi(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],f=r[6],c=r[7],d=r[8],m=r[9],h=r[10],p=r[11],v=r[12],g=r[13],_=r[14],b=r[15],C=e[0],x=e[1],T=e[2],R=e[3];return t[0]=C*n+x*s+T*d+R*v,t[1]=C*a+x*u+T*m+R*g,t[2]=C*i+x*f+T*h+R*_,t[3]=C*o+x*c+T*p+R*b,C=e[4],x=e[5],T=e[6],R=e[7],t[4]=C*n+x*s+T*d+R*v,t[5]=C*a+x*u+T*m+R*g,t[6]=C*i+x*f+T*h+R*_,t[7]=C*o+x*c+T*p+R*b,C=e[8],x=e[9],T=e[10],R=e[11],t[8]=C*n+x*s+T*d+R*v,t[9]=C*a+x*u+T*m+R*g,t[10]=C*i+x*f+T*h+R*_,t[11]=C*o+x*c+T*p+R*b,C=e[12],x=e[13],T=e[14],R=e[15],t[12]=C*n+x*s+T*d+R*v,t[13]=C*a+x*u+T*m+R*g,t[14]=C*i+x*f+T*h+R*_,t[15]=C*o+x*c+T*p+R*b,t}function Gc(t,r,e){var n=e[0],a=e[1],i=e[2],o,s,u,f,c,d,m,h,p,v,g,_;return r===t?(t[12]=r[0]*n+r[4]*a+r[8]*i+r[12],t[13]=r[1]*n+r[5]*a+r[9]*i+r[13],t[14]=r[2]*n+r[6]*a+r[10]*i+r[14],t[15]=r[3]*n+r[7]*a+r[11]*i+r[15]):(o=r[0],s=r[1],u=r[2],f=r[3],c=r[4],d=r[5],m=r[6],h=r[7],p=r[8],v=r[9],g=r[10],_=r[11],t[0]=o,t[1]=s,t[2]=u,t[3]=f,t[4]=c,t[5]=d,t[6]=m,t[7]=h,t[8]=p,t[9]=v,t[10]=g,t[11]=_,t[12]=o*n+c*a+p*i+r[12],t[13]=s*n+d*a+v*i+r[13],t[14]=u*n+m*a+g*i+r[14],t[15]=f*n+h*a+_*i+r[15]),t}function kc(t,r,e){var n=e[0],a=e[1],i=e[2];return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=r[7]*a,t[8]=r[8]*i,t[9]=r[9]*i,t[10]=r[10]*i,t[11]=r[11]*i,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function Uc(t,r,e,n){var a=n[0],i=n[1],o=n[2],s=Math.hypot(a,i,o),u,f,c,d,m,h,p,v,g,_,b,C,x,T,R,D,V,U,N,J,L,z,H,se;return s<Ye?null:(s=1/s,a*=s,i*=s,o*=s,u=Math.sin(e),f=Math.cos(e),c=1-f,d=r[0],m=r[1],h=r[2],p=r[3],v=r[4],g=r[5],_=r[6],b=r[7],C=r[8],x=r[9],T=r[10],R=r[11],D=a*a*c+f,V=i*a*c+o*u,U=o*a*c-i*u,N=a*i*c-o*u,J=i*i*c+f,L=o*i*c+a*u,z=a*o*c+i*u,H=i*o*c-a*u,se=o*o*c+f,t[0]=d*D+v*V+C*U,t[1]=m*D+g*V+x*U,t[2]=h*D+_*V+T*U,t[3]=p*D+b*V+R*U,t[4]=d*N+v*J+C*L,t[5]=m*N+g*J+x*L,t[6]=h*N+_*J+T*L,t[7]=p*N+b*J+R*L,t[8]=d*z+v*H+C*se,t[9]=m*z+g*H+x*se,t[10]=h*z+_*H+T*se,t[11]=p*z+b*H+R*se,r!==t&&(t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t)}function Nc(t,r,e){var n=Math.sin(e),a=Math.cos(e),i=r[4],o=r[5],s=r[6],u=r[7],f=r[8],c=r[9],d=r[10],m=r[11];return r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[4]=i*a+f*n,t[5]=o*a+c*n,t[6]=s*a+d*n,t[7]=u*a+m*n,t[8]=f*a-i*n,t[9]=c*a-o*n,t[10]=d*a-s*n,t[11]=m*a-u*n,t}function Hc(t,r,e){var n=Math.sin(e),a=Math.cos(e),i=r[0],o=r[1],s=r[2],u=r[3],f=r[8],c=r[9],d=r[10],m=r[11];return r!==t&&(t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=i*a-f*n,t[1]=o*a-c*n,t[2]=s*a-d*n,t[3]=u*a-m*n,t[8]=i*n+f*a,t[9]=o*n+c*a,t[10]=s*n+d*a,t[11]=u*n+m*a,t}function jc(t,r,e){var n=Math.sin(e),a=Math.cos(e),i=r[0],o=r[1],s=r[2],u=r[3],f=r[4],c=r[5],d=r[6],m=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=i*a+f*n,t[1]=o*a+c*n,t[2]=s*a+d*n,t[3]=u*a+m*n,t[4]=f*a-i*n,t[5]=c*a-o*n,t[6]=d*a-s*n,t[7]=m*a-u*n,t}function Vc(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=e+e,s=n+n,u=a+a,f=e*o,c=n*o,d=n*s,m=a*o,h=a*s,p=a*u,v=i*o,g=i*s,_=i*u;return t[0]=1-d-p,t[1]=c+_,t[2]=m-g,t[3]=0,t[4]=c-_,t[5]=1-f-p,t[6]=h+v,t[7]=0,t[8]=m+g,t[9]=h-v,t[10]=1-f-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Jc(t,r,e,n,a,i,o){var s=1/(e-r),u=1/(a-n),f=1/(i-o);return t[0]=i*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*u,t[6]=0,t[7]=0,t[8]=(e+r)*s,t[9]=(a+n)*u,t[10]=(o+i)*f,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*f,t[15]=0,t}function Sg(t,r,e,n,a){var i=1/Math.tan(r/2),o;return t[0]=i/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(o=1/(n-a),t[10]=(a+n)*o,t[14]=2*a*n*o):(t[10]=-1,t[14]=-2*n),t}var Xc=Sg;function Mg(t,r,e,n,a,i,o){var s=1/(r-e),u=1/(n-a),f=1/(i-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(r+e)*s,t[13]=(a+n)*u,t[14]=(o+i)*f,t[15]=1,t}var zc=Mg;function Wc(t,r,e,n){var a,i,o,s,u,f,c,d,m,h,p=r[0],v=r[1],g=r[2],_=n[0],b=n[1],C=n[2],x=e[0],T=e[1],R=e[2];return Math.abs(p-x)<Ye&&Math.abs(v-T)<Ye&&Math.abs(g-R)<Ye?Cg(t):(c=p-x,d=v-T,m=g-R,h=1/Math.hypot(c,d,m),c*=h,d*=h,m*=h,a=b*m-C*d,i=C*c-_*m,o=_*d-b*c,h=Math.hypot(a,i,o),h?(h=1/h,a*=h,i*=h,o*=h):(a=0,i=0,o=0),s=d*o-m*i,u=m*a-c*o,f=c*i-d*a,h=Math.hypot(s,u,f),h?(h=1/h,s*=h,u*=h,f*=h):(s=0,u=0,f=0),t[0]=a,t[1]=s,t[2]=c,t[3]=0,t[4]=i,t[5]=u,t[6]=d,t[7]=0,t[8]=o,t[9]=f,t[10]=m,t[11]=0,t[12]=-(a*p+i*v+o*g),t[13]=-(s*p+u*v+f*g),t[14]=-(c*p+d*v+m*g),t[15]=1,t)}function Ig(){var t=new Me(4);return Me!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Kc(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t}function Yc(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t}function Qc(t){var r=t[0],e=t[1],n=t[2],a=t[3];return Math.hypot(r,e,n,a)}function $c(t){var r=t[0],e=t[1],n=t[2],a=t[3];return r*r+e*e+n*n+a*a}function qc(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=e*e+n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e*o,t[1]=n*o,t[2]=a*o,t[3]=i*o,t}function Zc(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3]}function el(t,r,e,n){var a=r[0],i=r[1],o=r[2],s=r[3];return t[0]=a+n*(e[0]-a),t[1]=i+n*(e[1]-i),t[2]=o+n*(e[2]-o),t[3]=s+n*(e[3]-s),t}function tl(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3];return t[0]=e[0]*n+e[4]*a+e[8]*i+e[12]*o,t[1]=e[1]*n+e[5]*a+e[9]*i+e[13]*o,t[2]=e[2]*n+e[6]*a+e[10]*i+e[14]*o,t[3]=e[3]*n+e[7]*a+e[11]*i+e[15]*o,t}function rl(t,r,e){var n=r[0],a=r[1],i=r[2],o=e[0],s=e[1],u=e[2],f=e[3],c=f*n+s*i-u*a,d=f*a+u*n-o*i,m=f*i+o*a-s*n,h=-o*n-s*a-u*i;return t[0]=c*f+h*-o+d*-u-m*-s,t[1]=d*f+h*-s+m*-o-c*-u,t[2]=m*f+h*-u+c*-s-d*-o,t[3]=r[3],t}var CR=function(){var t=Ig();return function(r,e,n,a,i,o){var s,u;for(e||(e=4),n||(n=0),a?u=Math.min(a*e+n,r.length):u=r.length,s=n;s<u;s+=e)t[0]=r[s],t[1]=r[s+1],t[2]=r[s+2],t[3]=r[s+3],i(t,t,o),r[s]=t[0],r[s+1]=t[1],r[s+2]=t[2],r[s+3]=t[3];return r}}();function Og(t){var r=wg();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function wg(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Xi;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Xi||(Xi={}));var Fg=45*Math.PI/180,Lg=1,Vi=.1,Ji=500,Dg=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Ue=function(t){w(e,t);var r=Og(e);function e(n){var a;return y(this,e),a=r.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(n)?a.copy(n):a.identity(),a}return E(e,[{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}},{key:"INDICES",get:function(){return Xi}},{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this[4]=a[4],this[5]=a[5],this[6]=a[6],this[7]=a[7],this[8]=a[8],this[9]=a[9],this[10]=a[10],this[11]=a[11],this[12]=a[12],this[13]=a[13],this[14]=a[14],this[15]=a[15],this.check()}},{key:"set",value:function(a,i,o,s,u,f,c,d,m,h,p,v,g,_,b,C){return this[0]=a,this[1]=i,this[2]=o,this[3]=s,this[4]=u,this[5]=f,this[6]=c,this[7]=d,this[8]=m,this[9]=h,this[10]=p,this[11]=v,this[12]=g,this[13]=_,this[14]=b,this[15]=C,this.check()}},{key:"setRowMajor",value:function(a,i,o,s,u,f,c,d,m,h,p,v,g,_,b,C){return this[0]=a,this[1]=u,this[2]=m,this[3]=g,this[4]=i,this[5]=f,this[6]=h,this[7]=_,this[8]=o,this[9]=c,this[10]=p,this[11]=b,this[12]=s,this[13]=d,this[14]=v,this[15]=C,this.check()}},{key:"toRowMajor",value:function(a){return a[0]=this[0],a[1]=this[4],a[2]=this[8],a[3]=this[12],a[4]=this[1],a[5]=this[5],a[6]=this[9],a[7]=this[13],a[8]=this[2],a[9]=this[6],a[10]=this[10],a[11]=this[14],a[12]=this[3],a[13]=this[7],a[14]=this[11],a[15]=this[15],a}},{key:"identity",value:function(){return this.copy(Dg)}},{key:"fromObject",value:function(a){return this.check()}},{key:"fromQuaternion",value:function(a){return Vc(this,a),this.check()}},{key:"frustum",value:function(a){var i=a.left,o=a.right,s=a.bottom,u=a.top,f=a.near,c=f===void 0?Vi:f,d=a.far,m=d===void 0?Ji:d;return m===1/0?kg(this,i,o,s,u,c):Jc(this,i,o,s,u,c,m),this.check()}},{key:"lookAt",value:function(a){var i=a.eye,o=a.center,s=o===void 0?[0,0,0]:o,u=a.up,f=u===void 0?[0,1,0]:u;return Wc(this,i,s,f),this.check()}},{key:"ortho",value:function(a){var i=a.left,o=a.right,s=a.bottom,u=a.top,f=a.near,c=f===void 0?Vi:f,d=a.far,m=d===void 0?Ji:d;return zc(this,i,o,s,u,c,m),this.check()}},{key:"orthographic",value:function(a){var i=a.fovy,o=i===void 0?Fg:i,s=a.aspect,u=s===void 0?Lg:s,f=a.focalDistance,c=f===void 0?1:f,d=a.near,m=d===void 0?Vi:d,h=a.far,p=h===void 0?Ji:h;nl(o);var v=o/2,g=c*Math.tan(v),_=g*u;return this.ortho({left:-_,right:_,bottom:-g,top:g,near:m,far:p})}},{key:"perspective",value:function(a){var i=a.fovy,o=i===void 0?45*Math.PI/180:i,s=a.aspect,u=s===void 0?1:s,f=a.near,c=f===void 0?.1:f,d=a.far,m=d===void 0?500:d;return nl(o),Xc(this,o,u,c,m),this.check()}},{key:"determinant",value:function(){return Pc(this)}},{key:"getScale",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return a[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),a[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),a[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),a}},{key:"getTranslation",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[-0,-0,-0];return a[0]=this[12],a[1]=this[13],a[2]=this[14],a}},{key:"getRotation",value:function(a,i){a=a||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],i=i||[-0,-0,-0];var o=this.getScale(i),s=1/o[0],u=1/o[1],f=1/o[2];return a[0]=this[0]*s,a[1]=this[1]*u,a[2]=this[2]*f,a[3]=0,a[4]=this[4]*s,a[5]=this[5]*u,a[6]=this[6]*f,a[7]=0,a[8]=this[8]*s,a[9]=this[9]*u,a[10]=this[10]*f,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{key:"getRotationMatrix3",value:function(a,i){a=a||[-0,-0,-0,-0,-0,-0,-0,-0,-0],i=i||[-0,-0,-0];var o=this.getScale(i),s=1/o[0],u=1/o[1],f=1/o[2];return a[0]=this[0]*s,a[1]=this[1]*u,a[2]=this[2]*f,a[3]=this[4]*s,a[4]=this[5]*u,a[5]=this[6]*f,a[6]=this[8]*s,a[7]=this[9]*u,a[8]=this[10]*f,a}},{key:"transpose",value:function(){return Lc(this,this),this.check()}},{key:"invert",value:function(){return Dc(this,this),this.check()}},{key:"multiplyLeft",value:function(a){return Hi(this,a,this),this.check()}},{key:"multiplyRight",value:function(a){return Hi(this,this,a),this.check()}},{key:"rotateX",value:function(a){return Nc(this,this,a),this.check()}},{key:"rotateY",value:function(a){return Hc(this,this,a),this.check()}},{key:"rotateZ",value:function(a){return jc(this,this,a),this.check()}},{key:"rotateXYZ",value:function(a){return this.rotateX(a[0]).rotateY(a[1]).rotateZ(a[2])}},{key:"rotateAxis",value:function(a,i){return Uc(this,this,a,i),this.check()}},{key:"scale",value:function(a){return kc(this,this,Array.isArray(a)?a:[a,a,a]),this.check()}},{key:"translate",value:function(a){return Gc(this,this,a),this.check()}},{key:"transform",value:function(a,i){return a.length===4?(i=tl(i||[-0,-0,-0,-0],a,this),Tt(i,4),i):this.transformAsPoint(a,i)}},{key:"transformAsPoint",value:function(a,i){var o=a.length,s;switch(o){case 2:s=hc(i||[-0,-0],a,this);break;case 3:s=mr(i||[-0,-0,-0],a,this);break;default:throw new Error("Illegal vector")}return Tt(s,a.length),s}},{key:"transformAsVector",value:function(a,i){var o;switch(a.length){case 2:o=vc(i||[-0,-0],a,this);break;case 3:o=na(i||[-0,-0,-0],a,this);break;default:throw new Error("Illegal vector")}return Tt(o,a.length),o}},{key:"transformPoint",value:function(a,i){return this.transformAsPoint(a,i)}},{key:"transformVector",value:function(a,i){return this.transformAsPoint(a,i)}},{key:"transformDirection",value:function(a,i){return this.transformAsVector(a,i)}},{key:"makeRotationX",value:function(a){return this.identity().rotateX(a)}},{key:"makeTranslation",value:function(a,i,o){return this.identity().translate([a,i,o])}}],[{key:"IDENTITY",get:function(){return Gg()}},{key:"ZERO",get:function(){return Pg()}}]),e}(fa);var da,ma;function Pg(){return da||(da=new Ue([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(da)),da}function Gg(){return ma||(ma=new Ue,Object.freeze(ma)),ma}function nl(t){if(t>Math.PI*2)throw Error("expected radians")}function kg(t,r,e,n,a,i){var o=2*i/(e-r),s=2*i/(a-n),u=(e+r)/(e-r),f=(a+n)/(a-n),c=-1,d=-1,m=-2*i;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=u,t[9]=f,t[10]=c,t[11]=d,t[12]=0,t[13]=0,t[14]=m,t[15]=0,t}function al(){var t=new Me(4);return Me!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function il(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function zi(t,r,e){e=e*.5;var n=Math.sin(e);return t[0]=n*r[0],t[1]=n*r[1],t[2]=n*r[2],t[3]=Math.cos(e),t}function Wi(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],s=e[0],u=e[1],f=e[2],c=e[3];return t[0]=n*c+o*s+a*f-i*u,t[1]=a*c+o*u+i*s-n*f,t[2]=i*c+o*f+n*u-a*s,t[3]=o*c-n*s-a*u-i*f,t}function ol(t,r,e){e*=.5;var n=r[0],a=r[1],i=r[2],o=r[3],s=Math.sin(e),u=Math.cos(e);return t[0]=n*u+o*s,t[1]=a*u+i*s,t[2]=i*u-a*s,t[3]=o*u-n*s,t}function sl(t,r,e){e*=.5;var n=r[0],a=r[1],i=r[2],o=r[3],s=Math.sin(e),u=Math.cos(e);return t[0]=n*u-i*s,t[1]=a*u+o*s,t[2]=i*u+n*s,t[3]=o*u-a*s,t}function ul(t,r,e){e*=.5;var n=r[0],a=r[1],i=r[2],o=r[3],s=Math.sin(e),u=Math.cos(e);return t[0]=n*u+a*s,t[1]=a*u-n*s,t[2]=i*u+o*s,t[3]=o*u-i*s,t}function fl(t,r){var e=r[0],n=r[1],a=r[2];return t[0]=e,t[1]=n,t[2]=a,t[3]=Math.sqrt(Math.abs(1-e*e-n*n-a*a)),t}function Hr(t,r,e,n){var a=r[0],i=r[1],o=r[2],s=r[3],u=e[0],f=e[1],c=e[2],d=e[3],m,h,p,v,g;return h=a*u+i*f+o*c+s*d,h<0&&(h=-h,u=-u,f=-f,c=-c,d=-d),1-h>Ye?(m=Math.acos(h),p=Math.sin(m),v=Math.sin((1-n)*m)/p,g=Math.sin(n*m)/p):(v=1-n,g=n),t[0]=v*a+g*u,t[1]=v*i+g*f,t[2]=v*o+g*c,t[3]=v*s+g*d,t}function cl(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=e*e+n*n+a*a+i*i,s=o?1/o:0;return t[0]=-e*s,t[1]=-n*s,t[2]=-a*s,t[3]=i*s,t}function ll(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=r[3],t}function Ki(t,r){var e=r[0]+r[4]+r[8],n;if(e>0)n=Math.sqrt(e+1),t[3]=.5*n,n=.5/n,t[0]=(r[5]-r[7])*n,t[1]=(r[6]-r[2])*n,t[2]=(r[1]-r[3])*n;else{var a=0;r[4]>r[0]&&(a=1),r[8]>r[a*3+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;n=Math.sqrt(r[a*3+a]-r[i*3+i]-r[o*3+o]+1),t[a]=.5*n,n=.5/n,t[3]=(r[i*3+o]-r[o*3+i])*n,t[i]=(r[i*3+a]+r[a*3+i])*n,t[o]=(r[o*3+a]+r[a*3+o])*n}return t}var dl=Kc;var ml=Yc,hl=Zc,pl=el,vl=Qc;var gl=$c;var Al=qc;var yl=function(){var t=Li(),r=Di(1,0,0),e=Di(0,1,0);return function(n,a,i){var o=Pi(a,i);return o<-.999999?(dr(t,r,a),xc(t)<1e-6&&dr(t,e,a),yc(t,t),zi(n,t,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(dr(t,a,i),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+o,Al(n,n))}}(),jR=function(){var t=al(),r=al();return function(e,n,a,i,o,s){return Hr(t,n,o,s),Hr(r,a,i,s),Hr(e,t,r,2*s*(1-s)),e}}(),VR=function(){var t=Cc();return function(r,e,n,a){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-e[0],t[5]=-e[1],t[8]=-e[2],Al(r,Ki(r,t))}}();function Ng(t){var r=Hg();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function Hg(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jg=[0,0,0,1],Yi=function(t){w(e,t);var r=Ng(e);function e(){var n,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;return y(this,e),n=r.call(this,-0,-0,-0,-0),Array.isArray(a)&&arguments.length===1?n.copy(a):n.set(a,i,o,s),n}return E(e,[{key:"copy",value:function(a){return this[0]=a[0],this[1]=a[1],this[2]=a[2],this[3]=a[3],this.check()}},{key:"set",value:function(a,i,o,s){return this[0]=a,this[1]=i,this[2]=o,this[3]=s,this.check()}},{key:"fromObject",value:function(a){return this[0]=a.x,this[1]=a.y,this[2]=a.z,this[3]=a.w,this.check()}},{key:"fromMatrix3",value:function(a){return Ki(this,a),this.check()}},{key:"fromAxisRotation",value:function(a,i){return zi(this,a,i),this.check()}},{key:"identity",value:function(){return il(this),this.check()}},{key:"setAxisAngle",value:function(a,i){return this.fromAxisRotation(a,i)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(a){this[0]=ne(a)}},{key:"y",get:function(){return this[1]},set:function(a){this[1]=ne(a)}},{key:"z",get:function(){return this[2]},set:function(a){this[2]=ne(a)}},{key:"w",get:function(){return this[3]},set:function(a){this[3]=ne(a)}},{key:"len",value:function(){return vl(this)}},{key:"lengthSquared",value:function(){return gl(this)}},{key:"dot",value:function(a){return hl(this,a)}},{key:"rotationTo",value:function(a,i){return yl(this,a,i),this.check()}},{key:"add",value:function(a){return dl(this,this,a),this.check()}},{key:"calculateW",value:function(){return fl(this,this),this.check()}},{key:"conjugate",value:function(){return ll(this,this),this.check()}},{key:"invert",value:function(){return cl(this,this),this.check()}},{key:"lerp",value:function(a,i,o){return o===void 0?this.lerp(this,a,i):(pl(this,a,i,o),this.check())}},{key:"multiplyRight",value:function(a){return Wi(this,this,a),this.check()}},{key:"multiplyLeft",value:function(a){return Wi(this,a,this),this.check()}},{key:"normalize",value:function(){var a=this.len(),i=a>0?1/a:0;return this[0]=this[0]*i,this[1]=this[1]*i,this[2]=this[2]*i,this[3]=this[3]*i,a===0&&(this[3]=1),this.check()}},{key:"rotateX",value:function(a){return ol(this,this,a),this.check()}},{key:"rotateY",value:function(a){return sl(this,this,a),this.check()}},{key:"rotateZ",value:function(a){return ul(this,this,a),this.check()}},{key:"scale",value:function(a){return ml(this,this,a),this.check()}},{key:"slerp",value:function(a,i,o){var s,u,f;switch(arguments.length){case 1:var c=a.start;s=c===void 0?jg:c,u=a.target,f=a.ratio;break;case 2:s=this,u=a,f=i;break;default:s=a,u=i,f=o}return Hr(this,s,u,f),this.check()}},{key:"transformVector4",value:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Tc;return rl(i,a,this),Tt(i,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(a,i){return this.setAxisAngle(a,i)}},{key:"premultiply",value:function(a){return this.multiplyLeft(a)}},{key:"multiply",value:function(a){return this.multiplyRight(a)}}]),e}(cr);var Qi=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`;function Vg(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Jg(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Jg(t,r){if(t){if(typeof t=="string")return bl(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return bl(t,r)}}function bl(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Xg={lightSources:{}};function $i(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.color,e=r===void 0?[0,0,0]:r,n=t.intensity,a=n===void 0?1:n;return e.map(function(i){return i*a/255})}function zg(t){var r=t.ambientLight,e=t.pointLights,n=e===void 0?[]:e,a=t.directionalLights,i=a===void 0?[]:a,o={};return r?o["lighting_uAmbientLight.color"]=$i(r):o["lighting_uAmbientLight.color"]=[0,0,0],n.forEach(function(s,u){o["lighting_uPointLight[".concat(u,"].color")]=$i(s),o["lighting_uPointLight[".concat(u,"].position")]=s.position,o["lighting_uPointLight[".concat(u,"].attenuation")]=s.attenuation||[1,0,0]}),o.lighting_uPointLightCount=n.length,i.forEach(function(s,u){o["lighting_uDirectionalLight[".concat(u,"].color")]=$i(s),o["lighting_uDirectionalLight[".concat(u,"].direction")]=s.direction}),o.lighting_uDirectionalLightCount=i.length,o}function _l(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Xg;if("lightSources"in t){var r=t.lightSources||{},e=r.ambientLight,n=r.pointLights,a=r.directionalLights,i=e||n&&n.length>0||a&&a.length>0;return i?Object.assign({},zg({ambientLight:e,pointLights:n,directionalLights:a}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){var o={pointLights:[],directionalLights:[]},s=Vg(t.lights||[]),u;try{for(s.s();!(u=s.n()).done;){var f=u.value;switch(f.type){case"ambient":o.ambientLight=f;break;case"directional":o.directionalLights.push(f);break;case"point":o.pointLights.push(f);break;default:}}}catch(c){s.e(c)}finally{s.f()}return _l({lightSources:o})}return{}}var Bl={name:"lights",vs:Qi,fs:Qi,getUniforms:_l,defines:{MAX_LIGHTS:3}};var El=`uniform mat4 u_MVPMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_NormalMatrix;

varying vec3 pbr_vPosition;
varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
# else
varying vec3 pbr_vNormal;
# endif
#endif

void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
  vec4 pos = u_ModelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));
  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));
  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
  pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else
  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}
`;var xl=`#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)
# error PBR fragment shader: Texture LOD is not available
#endif

#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)
# error PBR fragment shader: Derivatives are not available
#endif


#if (__VERSION__ < 300)
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)
#else
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)
#endif

precision highp float;

uniform bool pbr_uUnlit;

#ifdef USE_IBL
uniform samplerCube u_DiffuseEnvSampler;
uniform samplerCube u_SpecularEnvSampler;
uniform sampler2D u_brdfLUT;
uniform vec2 u_ScaleIBLAmbient;
#endif

#ifdef HAS_BASECOLORMAP
uniform sampler2D u_BaseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_NormalSampler;
uniform float u_NormalScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_EmissiveSampler;
uniform vec3 u_EmissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_MetallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_OcclusionSampler;
uniform float u_OcclusionStrength;
#endif

#ifdef ALPHA_CUTOFF
uniform float u_AlphaCutoff;
#endif

uniform vec2 u_MetallicRoughnessValues;
uniform vec4 u_BaseColorFactor;

uniform vec3 u_Camera;
#ifdef PBR_DEBUG
uniform vec4 u_ScaleDiffBaseMR;
uniform vec4 u_ScaleFGDSpec;
#endif

varying vec3 pbr_vPosition;

varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
#else
varying vec3 pbr_vNormal;
#endif
#endif


struct PBRInfo
{
  float NdotL;
  float NdotV;
  float NdotH;
  float LdotH;
  float VdotH;
  float perceptualRoughness;
  float metalness;
  vec3 reflectance0;
  vec3 reflectance90;
  float alphaRoughness;
  vec3 diffuseColor;
  vec3 specularColor;
  vec3 n;
  vec3 v;
};

const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;

vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else
  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif
  return vec4(linOut,srgbIn.w);;
#else
  return srgbIn;
#endif
}

vec3 getNormal()
{
#ifndef HAS_TANGENTS
  vec3 pos_dx = dFdx(pbr_vPosition);
  vec3 pos_dy = dFdy(pbr_vPosition);
  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  vec3 ng = normalize(pbr_vNormal);
#else
  vec3 ng = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  vec3 b = normalize(cross(ng, t));
  mat3 tbn = mat3(t, b, ng);
#else
  mat3 tbn = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));
#else
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}


#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)
{
  float mipCount = 9.0;
  float lod = (pbrInputs.perceptualRoughness * mipCount);
  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,
    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;
  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);
  diffuse *= u_ScaleIBLAmbient.x;
  specular *= u_ScaleIBLAmbient.y;

  return diffuse + specular;
}
#endif


vec3 diffuse(PBRInfo pbrInputs)
{
  return pbrInputs.diffuseColor / M_PI;
}

vec3 specularReflection(PBRInfo pbrInputs)
{
  return pbrInputs.reflectance0 +
    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *
    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);
}



float geometricOcclusion(PBRInfo pbrInputs)
{
  float NdotL = pbrInputs.NdotL;
  float NdotV = pbrInputs.NdotV;
  float r = pbrInputs.alphaRoughness;

  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}





float microfacetDistribution(PBRInfo pbrInputs)
{
  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;
  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;
  return roughnessSq / (M_PI * f * f);
}

void PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {
  pbrInputs.NdotL = 1.0;
  pbrInputs.NdotH = 0.0;
  pbrInputs.LdotH = 0.0;
  pbrInputs.VdotH = 1.0;
}

void PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {
  vec3 n = pbrInputs.n;
  vec3 v = pbrInputs.v;
  vec3 l = normalize(lightDirection);
  vec3 h = normalize(l+v);

  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);
  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);
  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);
  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);
}

void PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {
  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInputs, light_direction);
}

vec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {
  vec3 F = specularReflection(pbrInputs);
  float G = geometricOcclusion(pbrInputs);
  float D = microfacetDistribution(pbrInputs);
  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);
  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);
  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);
}

vec4 pbr_filterColor(vec4 colorUnused)
{
#ifdef HAS_BASECOLORMAP
  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;
#else
  vec4 baseColor = u_BaseColorFactor;
#endif

#ifdef ALPHA_CUTOFF
  if (baseColor.a < u_AlphaCutoff) {
    discard;
  }
#endif

  vec3 color = vec3(0, 0, 0);

  if(pbr_uUnlit){
    color.rgb = baseColor.rgb;
  }
  else{


    float perceptualRoughness = u_MetallicRoughnessValues.y;
    float metallic = u_MetallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP

    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
#endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);

    float alphaRoughness = perceptualRoughness * perceptualRoughness;

    vec3 f0 = vec3(0.04);
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);



    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    vec3 specularEnvironmentR0 = specularColor.rgb;
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;

    vec3 n = getNormal();
    vec3 v = normalize(u_Camera - pbr_vPosition);

    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    vec3 reflection = -normalize(reflect(v, n));

    PBRInfo pbrInputs = PBRInfo(
      0.0,
      NdotV,
      0.0,
      0.0,
      0.0,
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );

#ifdef USE_LIGHTS
    PBRInfo_setAmbientLight(pbrInputs);
    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {
      if (i < lighting_uDirectionalLightCount) {
        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);
        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);
      }
    }
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {
      if (i < lighting_uPointLightCount) {
        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);
        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));
        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);
      }
    }
#endif
#ifdef USE_IBL
    color += getIBLContribution(pbrInputs, n, reflection);
#endif
#ifdef HAS_OCCLUSIONMAP
    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;
    color = mix(color, color * ao, u_OcclusionStrength);
#endif

#ifdef HAS_EMISSIVEMAP
    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;
    color += emissive;
#endif

#ifdef PBR_DEBUG





    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);
    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);
    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);
#endif

  }

  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`;var jr={name:"pbr",vs:El,fs:xl,defines:{LIGHTING_FRAGMENT:1},dependencies:[Bl]};var Tl="3.4.2";var vo=oe(ge());function Xe(t,r){if(!t)throw new Error(r||"loader assertion failed.")}var ot={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},Wg=ot.self||ot.window||ot.global||{},Kg=ot.window||ot.self||ot.global||{},Yg=ot.global||ot.self||ot.window||{},Qg=ot.document||{};var Vr=Boolean((typeof process>"u"?"undefined":$(process))!=="object"||String(process)!=="[object process]"||process.browser);var Cl=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),$g=Cl&&parseFloat(Cl[1])||0;function Sl(t,r){if(!t)throw new Error(r||"loaders.gl assertion failed.")}var st={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},x3=st.self||st.window||st.global||{},T3=st.window||st.self||st.global||{},Rl=st.global||st.self||st.window||{},C3=st.document||{};var dt=(typeof process>"u"?"undefined":$(process))!=="object"||String(process)!=="[object process]"||process.browser,Jr=typeof importScripts=="function",S3=typeof window<"u"&&typeof window.orientation<"u",Ml=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),M3=Ml&&parseFloat(Ml[1])||0;var Xr=oe(ge());var Ht=oe(Il());var qg="3.4.2",qi={};function ut(t){return Zi.apply(this,arguments)}function Zi(){return Zi=k(Xr.default.mark(function t(r){var e,n,a=arguments;return Xr.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return e=a.length>1&&a[1]!==void 0?a[1]:null,n=a.length>2&&a[2]!==void 0?a[2]:{},e&&(r=Ol(r,e,n)),qi[r]=qi[r]||Zg(r),o.next=6,qi[r];case 6:return o.abrupt("return",o.sent);case 7:case"end":return o.stop()}},t)})),Zi.apply(this,arguments)}function Ol(t,r,e){if(t.startsWith("http"))return t;var n=e.modules||{};return n[t]?n[t]:dt?e.CDN?(Sl(e.CDN.startsWith("http")),"".concat(e.CDN,"/").concat(r,"@").concat(qg,"/dist/libs/").concat(t)):Jr?"../src/libs/".concat(t):"modules/".concat(r,"/src/libs/").concat(t):"modules/".concat(r,"/dist/libs/").concat(t)}function Zg(t){return eo.apply(this,arguments)}function eo(){return eo=k(Xr.default.mark(function t(r){var e,n,a;return Xr.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!r.endsWith("wasm")){o.next=7;break}return o.next=3,fetch(r);case 3:return e=o.sent,o.next=6,e.arrayBuffer();case 6:return o.abrupt("return",o.sent);case 7:if(dt){o.next=20;break}if(o.prev=8,o.t0=Ht&&Ht.requireFromFile,!o.t0){o.next=14;break}return o.next=13,Ht.requireFromFile(r);case 13:o.t0=o.sent;case 14:return o.abrupt("return",o.t0);case 17:return o.prev=17,o.t1=o.catch(8),o.abrupt("return",null);case 20:if(!Jr){o.next=22;break}return o.abrupt("return",importScripts(r));case 22:return o.next=24,fetch(r);case 24:return n=o.sent,o.next=27,n.text();case 27:return a=o.sent,o.abrupt("return",eA(a,r));case 29:case"end":return o.stop()}},t,null,[[8,17]])})),eo.apply(this,arguments)}function eA(t,r){if(!dt)return Ht.requireFromString&&Ht.requireFromString(t,r);if(Jr)return eval.call(Rl,t),null;var e=document.createElement("script");e.id=r;try{e.appendChild(document.createTextNode(t))}catch{e.text=t}return document.body.appendChild(e),null}function Fl(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;if(typeof t=="string")return t.slice(0,r);if(ArrayBuffer.isView(t))return wl(t.buffer,t.byteOffset,r);if(t instanceof ArrayBuffer){var e=0;return wl(t,e,r)}return""}function wl(t,r,e){if(t.byteLength<=r+e)return"";for(var n=new DataView(t),a="",i=0;i<e;i++)a+=String.fromCharCode(n.getUint8(r+i));return a}function to(t){try{return JSON.parse(t)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(Fl(t),'"'))}}function zr(t,r,e){var n=e!==void 0?new Uint8Array(t).subarray(r,r+e):new Uint8Array(t).subarray(r),a=new Uint8Array(n);return a.buffer}function Ct(t,r){return Xe(t>=0),Xe(r>0),t+(r-1)&~(r-1)}function ro(t,r,e){var n;if(t instanceof ArrayBuffer)n=new Uint8Array(t);else{var a=t.byteOffset,i=t.byteLength;n=new Uint8Array(t.buffer||t.arrayBuffer,a,i)}return r.set(n,e),e+Ct(n.byteLength,4)}var tA=globalThis._parseImageNode,no=typeof Image<"u",ao=typeof ImageBitmap<"u",rA=Boolean(tA),io=Vr?!0:rA;function Ll(t){switch(t){case"auto":return ao||no||io;case"imagebitmap":return ao;case"image":return no;case"data":return io;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function Dl(){if(ao)return"imagebitmap";if(no)return"image";if(io)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function nA(t){var r=aA(t);if(!r)throw new Error("Not an image");return r}function Pl(t){switch(nA(t)){case"data":return t;case"image":case"imagebitmap":var r=document.createElement("canvas"),e=r.getContext("2d");if(!e)throw new Error("getImageData");return r.width=t.width,r.height=t.height,e.drawImage(t,0,0),e.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function aA(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&$(t)==="object"&&t.data&&t.width&&t.height?"data":null}var Wr=oe(ge());var iA=/^data:image\/svg\+xml/,oA=/\.svg((\?|#).*)?$/;function ha(t){return t&&(iA.test(t)||oA.test(t))}function Gl(t,r){if(ha(r)){var e=new TextDecoder,n=e.decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(i){throw new Error(i.message)}var a="data:image/svg+xml;base64,".concat(btoa(n));return a}return oo(t,r)}function oo(t,r){if(ha(r))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}function Kr(t,r,e){return so.apply(this,arguments)}function so(){return so=k(Wr.default.mark(function t(r,e,n){var a,i,o;return Wr.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return a=Gl(r,n),i=self.URL||self.webkitURL,o=typeof a!="string"&&i.createObjectURL(a),u.prev=3,u.next=6,sA(o||a,e);case 6:return u.abrupt("return",u.sent);case 7:return u.prev=7,o&&i.revokeObjectURL(o),u.finish(7);case 10:case"end":return u.stop()}},t,null,[[3,,7,10]])})),so.apply(this,arguments)}function sA(t,r){return uo.apply(this,arguments)}function uo(){return uo=k(Wr.default.mark(function t(r,e){var n;return Wr.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n=new Image,n.src=r,!(e.image&&e.image.decode&&n.decode)){i.next=6;break}return i.next=5,n.decode();case 5:return i.abrupt("return",n);case 6:return i.next=8,new Promise(function(o,s){try{n.onload=function(){return o(n)},n.onerror=function(u){return s(new Error("Could not load image ".concat(r,": ").concat(u)))}}catch(u){s(u)}});case 8:return i.abrupt("return",i.sent);case 9:case"end":return i.stop()}},t)})),uo.apply(this,arguments)}var Yr=oe(ge());var uA={},kl=!0;function lo(t,r,e){return fo.apply(this,arguments)}function fo(){return fo=k(Yr.default.mark(function t(r,e,n){var a,i,o;return Yr.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!ha(n)){u.next=7;break}return u.next=3,Kr(r,e,n);case 3:i=u.sent,a=i,u.next=8;break;case 7:a=oo(r,n);case 8:return o=e&&e.imagebitmap,u.next=11,fA(a,o);case 11:return u.abrupt("return",u.sent);case 12:case"end":return u.stop()}},t)})),fo.apply(this,arguments)}function fA(t){return co.apply(this,arguments)}function co(){return co=k(Yr.default.mark(function t(r){var e,n=arguments;return Yr.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(e=n.length>1&&n[1]!==void 0?n[1]:null,(cA(e)||!kl)&&(e=null),!e){i.next=13;break}return i.prev=3,i.next=6,createImageBitmap(r,e);case 6:return i.abrupt("return",i.sent);case 9:i.prev=9,i.t0=i.catch(3),console.warn(i.t0),kl=!1;case 13:return i.next=15,createImageBitmap(r);case 15:return i.abrupt("return",i.sent);case 16:case"end":return i.stop()}},t,null,[[3,9]])})),co.apply(this,arguments)}function cA(t){for(var r in t||uA)return!1;return!0}var mo=oe(ge());function Ul(t){return!hA(t,"ftyp",4)||!(t[8]&96)?null:lA(t)}function lA(t){var r=dA(t,8,12).replace("\0"," ").trim();switch(r){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function dA(t,r,e){return String.fromCharCode.apply(String,Y(t.slice(r,e)))}function mA(t){return Y(t).map(function(r){return r.charCodeAt(0)})}function hA(t,r){for(var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=mA(r),a=0;a<n.length;++a)if(n[a]!==t[a+e])return!1;return!0}var ft=!1,Qr=!0;function jt(t){var r=$r(t);return vA(r)||yA(r)||gA(r)||AA(r)||pA(r)}function pA(t){var r=new Uint8Array(t instanceof DataView?t.buffer:t),e=Ul(r);return e?{mimeType:e.mimeType,width:0,height:0}:null}function vA(t){var r=$r(t),e=r.byteLength>=24&&r.getUint32(0,ft)===2303741511;return e?{mimeType:"image/png",width:r.getUint32(16,ft),height:r.getUint32(20,ft)}:null}function gA(t){var r=$r(t),e=r.byteLength>=10&&r.getUint32(0,ft)===1195984440;return e?{mimeType:"image/gif",width:r.getUint16(6,Qr),height:r.getUint16(8,Qr)}:null}function AA(t){var r=$r(t),e=r.byteLength>=14&&r.getUint16(0,ft)===16973&&r.getUint32(2,Qr)===r.byteLength;return e?{mimeType:"image/bmp",width:r.getUint32(18,Qr),height:r.getUint32(22,Qr)}:null}function yA(t){var r=$r(t),e=r.byteLength>=3&&r.getUint16(0,ft)===65496&&r.getUint8(2)===255;if(!e)return null;for(var n=bA(),a=n.tableMarkers,i=n.sofMarkers,o=2;o+9<r.byteLength;){var s=r.getUint16(o,ft);if(i.has(s))return{mimeType:"image/jpeg",height:r.getUint16(o+5,ft),width:r.getUint16(o+7,ft)};if(!a.has(s))return null;o+=2,o+=r.getUint16(o,ft)}return null}function bA(){for(var t=new Set([65499,65476,65484,65501,65534]),r=65504;r<65520;++r)t.add(r);var e=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:e}}function $r(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}function po(t,r){return ho.apply(this,arguments)}function ho(){return ho=k(mo.default.mark(function t(r,e){var n,a,i;return mo.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=jt(r)||{},a=n.mimeType,i=globalThis._parseImageNode,Xe(i),s.next=5,i(r,a);case 5:return s.abrupt("return",s.sent);case 6:case"end":return s.stop()}},t)})),ho.apply(this,arguments)}function Ao(t,r,e){return go.apply(this,arguments)}function go(){return go=k(vo.default.mark(function t(r,e,n){var a,i,o,s,u,f;return vo.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:e=e||{},a=e.image||{},i=a.type||"auto",o=n||{},s=o.url,u=_A(i),d.t0=u,d.next=d.t0==="imagebitmap"?8:d.t0==="image"?12:d.t0==="data"?16:20;break;case 8:return d.next=10,lo(r,e,s);case 10:return f=d.sent,d.abrupt("break",21);case 12:return d.next=14,Kr(r,e,s);case 14:return f=d.sent,d.abrupt("break",21);case 16:return d.next=18,po(r,e);case 18:return f=d.sent,d.abrupt("break",21);case 20:Xe(!1);case 21:return i==="data"&&(f=Pl(f)),d.abrupt("return",f);case 23:case"end":return d.stop()}},t)})),go.apply(this,arguments)}function _A(t){switch(t){case"auto":case"data":return Dl();default:return Ll(t),t}}var BA=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],EA=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],xA={image:{type:"auto",decode:!0}},yo={id:"image",module:"images",name:"Images",version:Tl,mimeTypes:EA,extensions:BA,parse:Ao,tests:[function(t){return Boolean(jt(new DataView(t)))}],options:xA};var TA=oe(ge());var bo={};function _o(t){if(bo[t]===void 0){var r=Vr?SA(t):CA(t);bo[t]=r}return bo[t]}function CA(t){var r=["image/png","image/jpeg","image/gif"],e=globalThis._parseImageNode,n=globalThis._imageFormatsNode,a=n===void 0?r:n;return Boolean(e)&&a.includes(t)}function SA(t){switch(t){case"image/avif":case"image/webp":return MA(t);default:return!0}}function MA(t){try{var r=document.createElement("canvas"),e=r.toDataURL(t);return e.indexOf("data:".concat(t))===0}catch{return!1}}var ct=function(){function t(){y(this,t);var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=r.id;this.id=e||Oe(this.constructor.name),this.display=!0,this.position=new Qe,this.rotation=new Qe,this.scale=new Qe(1,1,1),this.matrix=new Ue,this.userData={},this.props={},this._setScenegraphNodeProps(r)}return E(t,[{key:"delete",value:function(){}},{key:"setProps",value:function(e){return this._setScenegraphNodeProps(e),this}},{key:"toString",value:function(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}},{key:"getBounds",value:function(){return null}},{key:"setPosition",value:function(e){return M(e.length===3,"setPosition requires vector argument"),this.position=e,this}},{key:"setRotation",value:function(e){return M(e.length===3,"setRotation requires vector argument"),this.rotation=e,this}},{key:"setScale",value:function(e){return M(e.length===3,"setScale requires vector argument"),this.scale=e,this}},{key:"setMatrix",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;n?this.matrix.copy(e):this.matrix=e}},{key:"setMatrixComponents",value:function(e){var n=e.position,a=e.rotation,i=e.scale,o=e.update,s=o===void 0?!0:o;return n&&this.setPosition(n),a&&this.setRotation(a),i&&this.setScale(i),s&&this.updateMatrix(),this}},{key:"updateMatrix",value:function(){var e=this.position,n=this.rotation,a=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(n),this.matrix.scale(a),this}},{key:"update",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.position,a=e.rotation,i=e.scale;return n&&this.setPosition(n),a&&this.setRotation(a),i&&this.setScale(i),this.updateMatrix(),this}},{key:"getCoordinateUniforms",value:function(e,n){M(e),n=n||this.matrix;var a=new Ue(e).multiplyRight(n),i=a.invert(),o=i.transpose();return{viewMatrix:e,modelMatrix:n,objectMatrix:n,worldMatrix:a,worldInverseMatrix:i,worldInverseTransposeMatrix:o}}},{key:"_setScenegraphNodeProps",value:function(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}]),t}();function RA(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=IA(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function IA(t,r){if(t){if(typeof t=="string")return Nl(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Nl(t,r)}}function Nl(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function OA(t){var r=wA();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function wA(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var pa=function(t){w(e,t);var r=OA(e);function e(){var n;y(this,e);var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};a=Array.isArray(a)?{children:a}:a;var i=a,o=i.children,s=o===void 0?[]:o;return F.assert(s.every(function(u){return u instanceof ct}),"every child must an instance of ScenegraphNode"),n=r.call(this,a),n.children=s,n}return E(e,[{key:"add",value:function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];for(var s=0,u=i;s<u.length;s++){var f=u[s];Array.isArray(f)?this.add.apply(this,Y(f)):this.children.push(f)}return this}},{key:"remove",value:function(a){var i=this.children,o=i.indexOf(a);return o>-1&&i.splice(o,1),this}},{key:"removeAll",value:function(){return this.children=[],this}},{key:"delete",value:function(){this.children.forEach(function(a){return a.delete()}),this.removeAll(),ve(O(e.prototype),"delete",this).call(this)}},{key:"getBounds",value:function(){var a=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse(function(i,o){var s=o.worldMatrix,u=i.getBounds();if(u){var f=ae(u,2),c=f[0],d=f[1],m=new Qe(c).add(d).divide([2,2,2]);s.transformAsPoint(m,m);var h=new Qe(d).subtract(c).divide([2,2,2]);s.transformAsVector(h,h);for(var p=0;p<8;p++)for(var v=new Qe(p&1?-1:1,p&2?-1:1,p&4?-1:1).multiply(h).add(m),g=0;g<3;g++)a[0][g]=Math.min(a[0][g],v[g]),a[1][g]=Math.max(a[1][g],v[g])}}),Number.isFinite(a[0][0])?a:null}},{key:"traverse",value:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.worldMatrix,s=o===void 0?new Ue:o,u=new Ue(s).multiplyRight(this.matrix),f=RA(this.children),c;try{for(f.s();!(c=f.n()).done;){var d=c.value;d instanceof e?d.traverse(a,{worldMatrix:u}):a(d,{worldMatrix:u})}}catch(m){f.e(m)}finally{f.f()}}}]),e}(ct);var FA={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},LA={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Hl(t){if(!t._animation){var r=LA[t.componentType],e=FA[t.type],n=e*t.count,a=t.bufferView.data,i=a.buffer,o=a.byteOffset,s=new r(i,o+(t.byteOffset||0),n);if(e===1)t._animation=Array.from(s);else{for(var u=[],f=0;f<s.length;f+=e)u.push(Array.from(s.slice(f,f+e)));t._animation=u}}return t._animation}var DA=new Ue;function PA(t,r){if(r.matrix.identity(),t.translation&&r.matrix.translate(t.translation),t.rotation){var e=DA.fromQuaternion(t.rotation);r.matrix.multiplyRight(e)}t.scale&&r.matrix.scale(t.scale)}var Bo=new Yi;function GA(t,r,e,n,a){if(r==="rotation"){Bo.slerp({start:e,target:n,ratio:a});for(var i=0;i<Bo.length;i++)t[r][i]=Bo[i]}else for(var o=0;o<e.length;o++)t[r][o]=a*n[o]+(1-a)*e[o]}function kA(t,r,e){for(var n=e.p0,a=e.outTangent0,i=e.inTangent1,o=e.p1,s=e.tDiff,u=e.ratio,f=0;f<t[r].length;f++){var c=a[f]*s,d=i[f]*s;t[r][f]=(2*Math.pow(u,3)-3*Math.pow(u,2)+1)*n[f]+(Math.pow(u,3)-2*Math.pow(u,2)+u)*c+(-2*Math.pow(u,3)+3*Math.pow(u,2))*o[f]+(Math.pow(u,3)-Math.pow(u,2))*d}}function UA(t,r,e){for(var n=0;n<e.length;n++)t[r][n]=e[n]}function NA(t,r,e,n){var a=r.input,i=r.interpolation,o=r.output,s=a[a.length-1],u=t%s,f=a.findIndex(function(x){return x>=u}),c=Math.max(0,f-1);if(!Array.isArray(e[n]))switch(n){case"translation":e[n]=[0,0,0];break;case"rotation":e[n]=[0,0,0,1];break;case"scale":e[n]=[1,1,1];break;default:F.warn("Bad animation path ".concat(n))()}M(e[n].length===o[c].length);var d=a[c],m=a[f];switch(i){case"STEP":UA(e,n,o[c]);break;case"LINEAR":if(m>d){var h=(u-d)/(m-d);GA(e,n,o[c],o[f],h)}break;case"CUBICSPLINE":if(m>d){var p=(u-d)/(m-d),v=m-d,g=o[3*c+1],_=o[3*c+2],b=o[3*f+0],C=o[3*f+1];kA(e,n,{p0:g,outTangent0:_,inTangent1:b,p1:C,tDiff:v,ratio:p})}break;default:F.warn("Interpolation ".concat(i," not supported"))();break}}var HA=function(){function t(r){y(this,t),this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,r)}return E(t,[{key:"animate",value:function(e){if(this.playing){var n=e/1e3,a=(n-this.startTime)*this.speed;this.channels.forEach(function(i){var o=i.sampler,s=i.target,u=i.path;NA(a,o,s,u),PA(s,s._node)})}}}]),t}(),jl=function(){function t(r){y(this,t),this.animations=r.animations.map(function(e,n){var a=e.name||"Animation-".concat(n),i=e.samplers.map(function(s){var u=s.input,f=s.interpolation,c=f===void 0?"LINEAR":f,d=s.output;return{input:Hl(r.accessors[u]),interpolation:c,output:Hl(r.accessors[d])}}),o=e.channels.map(function(s){var u=s.sampler,f=s.target;return{sampler:i[u],target:r.nodes[f.node],path:f.path}});return new HA({name:a,channels:o})})}return E(t,[{key:"animate",value:function(e){this.setTime(e)}},{key:"setTime",value:function(e){this.animations.forEach(function(n){return n.animate(e)})}},{key:"getAnimations",value:function(){return this.animations}}]),t}();function Vl(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=jA(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function jA(t,r){if(t){if(typeof t=="string")return Jl(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Jl(t,r)}}function Jl(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Xl=function(){function t(r){y(this,t),this.gl=r,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}return E(t,[{key:"addDefaultModule",value:function(e){this._defaultModules.find(function(n){return n.name===e.name})||this._defaultModules.push(e),this.stateHash++}},{key:"removeDefaultModule",value:function(e){var n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(function(a){return a.name!==n}),this.stateHash++}},{key:"addShaderHook",value:function(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}},{key:"get",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=n.vs,i=a===void 0?"":a,o=n.fs,s=o===void 0?"":o,u=n.defines,f=u===void 0?{}:u,c=n.inject,d=c===void 0?{}:c,m=n.varyings,h=m===void 0?[]:m,p=n.bufferMode,v=p===void 0?35981:p,g=n.transpileToGLSL100,_=g===void 0?!1:g,b=this._getModuleList(n.modules),C=this._getHash(i),x=this._getHash(s),T=b.map(function(G){return e._getHash(G.name)}).sort(),R=h.map(function(G){return e._getHash(G)}),D=Object.keys(f).sort(),V=Object.keys(d).sort(),U=[],N=[],J=Vl(D),L;try{for(J.s();!(L=J.n()).done;){var z=L.value;U.push(this._getHash(z)),U.push(this._getHash(f[z]))}}catch(G){J.e(G)}finally{J.f()}var H=Vl(V),se;try{for(H.s();!(se=H.n()).done;){var B=se.value;N.push(this._getHash(B)),N.push(this._getHash(d[B]))}}catch(G){H.e(G)}finally{H.f()}var A="".concat(C,"/").concat(x,"D").concat(U.join("/"),"M").concat(T.join("/"),"I").concat(N.join("/"),"V").concat(R.join("/"),"H").concat(this.stateHash,"B").concat(v).concat(_?"T":"");if(!this._programCache[A]){var I=Oi(this.gl,{vs:i,fs:s,modules:b,inject:d,defines:f,hookFunctions:this._hookFunctions,transpileToGLSL100:_});this._programCache[A]=new wr(this.gl,{hash:A,vs:I.vs,fs:I.fs,varyings:h,bufferMode:v}),this._getUniforms[A]=I.getUniforms||function(G){},this._useCounts[A]=0}return this._useCounts[A]++,this._programCache[A]}},{key:"getUniforms",value:function(e){return this._getUniforms[e.hash]||null}},{key:"release",value:function(e){var n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}},{key:"_getHash",value:function(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}},{key:"_getModuleList",value:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=new Array(this._defaultModules.length+e.length),a={},i=0,o=0,s=this._defaultModules.length;o<s;++o){var u=this._defaultModules[o],f=u.name;n[i++]=u,a[f]=!0}for(var c=0,d=e.length;c<d;++c){var m=e[c],h=m.name;a[h]||(n[i++]=m,a[h]=!0)}return n.length=i,n}}],[{key:"getDefaultProgramManager",value:function(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new t(e),e.luma.defaultProgramManager}}]),t}();function zl(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function VA(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?zl(Object(e),!0).forEach(function(n){l(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):zl(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}var JA={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function Wl(t,r,e){var n={},a=r.indices;for(var i in r.attributes){var o=r.attributes[i],s=XA(i,e);if(i==="indices")a=o;else if(o.constant)n[s]=o.value;else{var u=o.value,f=VA({},o);delete f.value,n[s]=[new le(t,u),f],zA(i,f)}}if(a){var c=a.value||a;M(c instanceof Uint16Array||c instanceof Uint32Array,'attribute array for "indices" must be of integer type');var d={size:1,isIndexed:a.isIndexed===void 0?!0:a.isIndexed};n.indices=[new le(t,{data:c,target:34963}),d]}return n}function XA(t,r){var e=r||{},n=e.attributeMap,a=n===void 0?JA:n;return a&&a[t]||t}function zA(t,r){var e;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":e="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":e="vectors";break;default:}switch(e){case"vectors":r.size=r.size||3;break;case"uvs":r.size=r.size||2;break;default:}M(Number.isFinite(r.size),"attribute ".concat(t," needs size"))}var hr=2,WA=1e4,KA="Model needs drawMode and vertexCount",Kl=function(){},YA={},va=function(){function t(r){y(this,t);var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.id,a=n===void 0?Oe("model"):n;M(er(r)),this.id=a,this.gl=r,this.id=e.id||Oe("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}return E(t,[{key:"initialize",value:function(e){this.props={},this.programManager=e.programManager||Xl.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;var n=e.program,a=n===void 0?null:n,i=e.vs,o=e.fs,s=e.modules,u=e.defines,f=e.inject,c=e.varyings,d=e.bufferMode,m=e.transpileToGLSL100;this.programProps={program:a,vs:i,fs:o,modules:s,defines:u,inject:f,varyings:c,bufferMode:d,transpileToGLSL100:m},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},M(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),KA)}},{key:"setProps",value:function(e){this._setModelProps(e)}},{key:"delete",value:function(){for(var e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}},{key:"getDrawMode",value:function(){return this.drawMode}},{key:"getVertexCount",value:function(){return this.vertexCount}},{key:"getInstanceCount",value:function(){return this.instanceCount}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getProgram",value:function(){return this.program}},{key:"setProgram",value:function(e){var n=e.program,a=e.vs,i=e.fs,o=e.modules,s=e.defines,u=e.inject,f=e.varyings,c=e.bufferMode,d=e.transpileToGLSL100;this.programProps={program:n,vs:a,fs:i,modules:o,defines:s,inject:u,varyings:f,bufferMode:c,transpileToGLSL100:d},this._programDirty=!0}},{key:"getUniforms",value:function(){return this.uniforms}},{key:"setDrawMode",value:function(e){return this.drawMode=e,this}},{key:"setVertexCount",value:function(e){return M(Number.isFinite(e)),this.vertexCount=e,this}},{key:"setInstanceCount",value:function(e){return M(Number.isFinite(e)),this.instanceCount=e,this}},{key:"setGeometry",value:function(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=Wl(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}},{key:"setAttributes",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(nr(e))return this;var n={};for(var a in e){var i=e[a];n[a]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}},{key:"setUniforms",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}},{key:"getModuleUniforms",value:function(e){this._checkProgram();var n=this.programManager.getUniforms(this.program);return n?n(e):{}}},{key:"updateModuleSettings",value:function(e){var n=this.getModuleUniforms(e||{});return this.setUniforms(n)}},{key:"clear",value:function(e){return Rr(this.program.gl,e),this}},{key:"draw",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();var n=e.moduleSettings,a=n===void 0?null:n,i=e.framebuffer,o=e.uniforms,s=o===void 0?{}:o,u=e.attributes,f=u===void 0?{}:u,c=e.transformFeedback,d=c===void 0?this.transformFeedback:c,m=e.parameters,h=m===void 0?{}:m,p=e.vertexArray,v=p===void 0?this.vertexArray:p;this.setAttributes(f),this.updateModuleSettings(a),this.setUniforms(s);var g;F.priority>=hr&&(g=this._logDrawCallStart(hr));var _=this.vertexArray.getDrawParams(),b=this.props,C=b.isIndexed,x=C===void 0?_.isIndexed:C,T=b.indexType,R=T===void 0?_.indexType:T,D=b.indexOffset,V=D===void 0?_.indexOffset:D,U=b.vertexArrayInstanced,N=U===void 0?_.isInstanced:U;N&&!this.isInstanced&&F.warn("Found instanced attributes on non-instanced model",this.id)();var J=this.isInstanced,L=this.instanceCount,z=this.props,H=z.onBeforeRender,se=H===void 0?Kl:H,B=z.onAfterRender,A=B===void 0?Kl:B;se(),this.program.setUniforms(this.uniforms);var I=this.program.draw(Object.assign(YA,e,{logPriority:g,uniforms:null,framebuffer:i,parameters:h,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:v,transformFeedback:d,isIndexed:x,indexType:R,isInstanced:J,instanceCount:L,offset:x?V:0}));return A(),F.priority>=hr&&this._logDrawCallEnd(g,v,i),I}},{key:"transform",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.discard,a=n===void 0?!0:n,i=e.feedbackBuffers,o=e.unbindModels,s=o===void 0?[]:o,u=e.parameters;i&&this._setFeedbackBuffers(i),a&&(u=Object.assign({},u,l({},35977,a))),s.forEach(function(f){return f.vertexArray.unbindBuffers()});try{this.draw(Object.assign({},e,{parameters:u}))}finally{s.forEach(function(f){return f.vertexArray.bindBuffers()})}return this}},{key:"render",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return F.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}},{key:"_setModelProps",value:function(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}},{key:"_checkProgram",value:function(){var e=this._programDirty||this.programManager.stateHash!==this._programManagerState;if(e){var n=this.programProps.program;if(n)this._managedProgram=!1;else{var a=this.programProps,i=a.vs,o=a.fs,s=a.modules,u=a.inject,f=a.defines,c=a.varyings,d=a.bufferMode,m=a.transpileToGLSL100;n=this.programManager.get({vs:i,fs:o,modules:s,inject:u,defines:f,varyings:c,bufferMode:d,transpileToGLSL100:m}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}M(n instanceof wr,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new fi(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}}},{key:"_deleteGeometryBuffers",value:function(){for(var e in this.geometryBuffers){var n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof le&&n.delete()}}},{key:"_setAnimationProps",value:function(e){this.animated&&M(e,"Model.draw(): animated uniforms but no animationProps")}},{key:"_setFeedbackBuffers",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(nr(e))return this;var n=this.program.gl;return this.transformFeedback=this.transformFeedback||new ui(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}},{key:"_logDrawCallStart",value:function(e){var n=e>3?0:WA;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),F.group(hr,">>> DRAWING MODEL ".concat(this.id),{collapsed:F.level<=2})(),e}},{key:"_logDrawCallEnd",value:function(e,n,a,i){if(e!==void 0){var o=di({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),s=Ln({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,a)}),u=s.table,f=s.unusedTable,c=s.unusedCount,d=Ln({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,a),undefinedOnly:!0}),m=d.table,h=d.count;h>0&&F.log("MISSING UNIFORMS",Object.keys(m))(),c>0&&F.log("UNUSED UNIFORMS",Object.keys(f))();var p=mi(this.vertexArray.configuration);F.table(e,o)(),F.table(e,u)(),F.table(e+1,p)(),i&&i.log({logLevel:hr,message:"Rendered to ".concat(i.id)}),F.groupEnd(hr)()}}}]),t}();function QA(t){var r=$A();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function $A(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Yl=function(t){w(e,t);var r=QA(e);function e(n){var a;y(this,e);var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return a=r.call(this,i),a.onBeforeRender=null,a.AfterRender=null,n instanceof va?(a.model=n,a._setModelNodeProps(i)):a.model=new va(n,i),a.bounds=null,a.managedResources=i.managedResources||[],a}return E(e,[{key:"setProps",value:function(a){return ve(O(e.prototype),"setProps",this).call(this,a),this._setModelNodeProps(a),this}},{key:"getBounds",value:function(){return this.bounds}},{key:"delete",value:function(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(function(a){return a.delete()}),this.managedResources=[]}},{key:"draw",value:function(){var a;return(a=this.model).draw.apply(a,arguments)}},{key:"setUniforms",value:function(){var a;return(a=this.model).setUniforms.apply(a,arguments),this}},{key:"setAttributes",value:function(){var a;return(a=this.model).setAttributes.apply(a,arguments),this}},{key:"updateModuleSettings",value:function(){var a;return(a=this.model).updateModuleSettings.apply(a,arguments),this}},{key:"_setModelNodeProps",value:function(a){this.model.setProps(a)}}]),e}(ct);function Ql(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function Eo(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Ql(Object(e),!0).forEach(function(n){l(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Ql(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}var $l=function(){function t(r,e){y(this,t);var n=e.attributes,a=e.material,i=e.pbrDebug,o=e.imageBasedLightingEnvironment,s=e.lights,u=e.useTangents;this.gl=r,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},or(r,ue.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),i&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(n.NORMAL,"HAS_NORMALS"),this.defineIfPresent(n.TANGENT&&u,"HAS_TANGENTS"),this.defineIfPresent(n.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(s,"USE_LIGHTS"),this.defineIfPresent(i,"PBR_DEBUG"),a&&this.parseMaterial(a)}return E(t,[{key:"defineIfPresent",value:function(e,n){e&&(this.defines[n]=1)}},{key:"parseTexture",value:function(e,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},o=e.texture.source.image,s,u={};o.compressed?(s=o,u=l({},this.gl.TEXTURE_MIN_FILTER,o.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR)):s={data:o};var f=new Dt(this.gl,Eo({id:e.name||e.id,parameters:Eo(Eo({},i),u),pixelStore:l({},this.gl.UNPACK_FLIP_Y_WEBGL,!1)},s));this.uniforms[n]=f,this.defineIfPresent(a,a),this.generatedTextures.push(f)}},{key:"parsePbrMetallicRoughness",value:function(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");var n=e.metallicFactor,a=n===void 0?1:n,i=e.roughnessFactor,o=i===void 0?1:i;this.uniforms.u_MetallicRoughnessValues=[a,o]}},{key:"parseMaterial",value:function(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");var n=e.normalTexture.scale,a=n===void 0?1:n;this.uniforms.u_NormalScale=a}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");var i=e.occlusionTexture.strength,o=i===void 0?1:i;this.uniforms.u_OcclusionStrength=o}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),e.alphaMode==="MASK"){var s=e.alphaCutoff,u=s===void 0?.5:s;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=u}else e.alphaMode==="BLEND"&&(F.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}},{key:"delete",value:function(){this.generatedTextures.forEach(function(e){return e.delete()})}}]),t}();var qA=`
#if (__VERSION__ < 300)
  #define _attr attribute
#else
  #define _attr in
#endif

  _attr vec4 POSITION;

  #ifdef HAS_NORMALS
    _attr vec4 NORMAL;
  #endif

  #ifdef HAS_TANGENTS
    _attr vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    _attr vec2 TEXCOORD_0;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = NORMAL;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = TEXCOORD_0;
    #endif

    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * POSITION;
  }
`,ZA=`
#if (__VERSION__ < 300)
  #define fragmentColor gl_FragColor
#else
  out vec4 fragmentColor;
#endif

  void main(void) {
    fragmentColor = pbr_filterColor(vec4(0));
  }
`;function ql(t,r){return X(t)?`#version 300 es
`.concat(r):r}function xo(t,r){var e=r.id,n=r.drawMode,a=r.vertexCount,i=r.attributes,o=r.modelOptions,s=new $l(t,r);F.info(4,"createGLTFModel defines: ",s.defines)();var u=[];u.push.apply(u,Y(s.generatedTextures)),u.push.apply(u,Y(Object.values(i).map(function(c){return c.buffer})));var f=new Yl(t,Object.assign({id:e,drawMode:n,vertexCount:a,modules:[jr],defines:s.defines,parameters:s.parameters,vs:ql(t,qA),fs:ql(t,ZA),managedResources:u},o));return f.setProps({attributes:i}),f.setUniforms(s.uniforms),f}var ey={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ty={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1},Zl=function(){function t(r){y(this,t);var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=r,this.options=Object.assign({},ty,e)}return E(t,[{key:"instantiate",value:function(e){var n=this;this.gltf=e;var a=(e.scenes||[]).map(function(i){return n.createScene(i)});return a}},{key:"createAnimator",value:function(){return Array.isArray(this.gltf.animations)?new jl(this.gltf):null}},{key:"createScene",value:function(e){var n=this,a=e.nodes||[],i=a.map(function(s){return n.createNode(s)}),o=new pa({id:e.name||e.id,children:i});return o}},{key:"createNode",value:function(e){var n=this;if(!e._node){var a=e.children||[],i=a.map(function(u){return n.createNode(u)});e.mesh&&i.push(this.createMesh(e.mesh));var o=new pa({id:e.name||e.id,children:i});if(e.matrix)o.setMatrix(e.matrix);else{if(o.matrix.identity(),e.translation&&o.matrix.translate(e.translation),e.rotation){var s=new Ue().fromQuaternion(e.rotation);o.matrix.multiplyRight(s)}e.scale&&o.matrix.scale(e.scale)}e._node=o}return e._node}},{key:"createMesh",value:function(e){var n=this;if(!e._mesh){var a=e.primitives||[],i=a.map(function(s,u){return n.createPrimitive(s,u,e)}),o=new pa({id:e.name||e.id,children:i});e._mesh=o}return e._mesh}},{key:"getVertexCount",value:function(e){F.warn("getVertexCount() not found")()}},{key:"createPrimitive",value:function(e,n,a){var i=xo(this.gl,Object.assign({id:e.name||"".concat(a.name||a.id,"-primitive-").concat(n),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options));return i.bounds=[e.attributes.POSITION.min,e.attributes.POSITION.max],i}},{key:"createAttributes",value:function(e,n){var a=this,i={};return Object.keys(e).forEach(function(o){i[o]=a.createAccessor(e[o],a.createBuffer(e[o],a.gl.ARRAY_BUFFER))}),n&&(i.indices=this.createAccessor(n,this.createBuffer(n,this.gl.ELEMENT_ARRAY_BUFFER))),F.info(4,"glTF Attributes",{attributes:e,indices:n,generated:i})(),i}},{key:"createBuffer",value:function(e,n){e.bufferView||(e.bufferView={});var a=e.bufferView;return a.lumaBuffers||(a.lumaBuffers={}),a.lumaBuffers[n]||(a.lumaBuffers[n]=new le(this.gl,{id:"from-".concat(a.id),data:a.data||e.value,target:n})),a.lumaBuffers[n]}},{key:"createAccessor",value:function(e,n){return new we({buffer:n,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:ey[e.type]})}},{key:"createSampler",value:function(e){return e}},{key:"needsPOT",value:function(){return!1}}]),t}();function ga(t,r,e){var n=new Zl(t,e),a=n.instantiate(r),i=n.createAnimator();return{scenes:a,animator:i}}var ws=oe(ge());var ed="3.4.2";var pt=oe(ge());var td="3.4.2";var Lo=oe(ge());var mt=oe(ge());var rd="3.4.2",ry="https://unpkg.com/@loaders.gl/textures@".concat(rd,"/dist/libs/basis_encoder.wasm"),ny="https://unpkg.com/@loaders.gl/textures@".concat(rd,"/dist/libs/basis_encoder.js"),To;function Oo(t){return So.apply(this,arguments)}function So(){return So=k(mt.default.mark(function t(r){var e;return mt.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e=r.modules||{},!e.basis){a.next=3;break}return a.abrupt("return",e.basis);case 3:return To=To||ay(r),a.next=6,To;case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}},t)})),So.apply(this,arguments)}function ay(t){return Mo.apply(this,arguments)}function Mo(){return Mo=k(mt.default.mark(function t(r){var e,n,a,i;return mt.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return e=null,n=null,s.t0=Promise,s.next=5,ut("basis_transcoder.js","textures",r);case 5:return s.t1=s.sent,s.next=8,ut("basis_transcoder.wasm","textures",r);case 8:return s.t2=s.sent,s.t3=[s.t1,s.t2],s.next=12,s.t0.all.call(s.t0,s.t3);case 12:return a=s.sent,i=ae(a,2),e=i[0],n=i[1],e=e||globalThis.BASIS,s.next=19,iy(e,n);case 19:return s.abrupt("return",s.sent);case 20:case"end":return s.stop()}},t)})),Mo.apply(this,arguments)}function iy(t,r){var e={};return r&&(e.wasmBinary=r),new Promise(function(n){t(e).then(function(a){var i=a.BasisFile,o=a.initializeBasis;o(),n({BasisFile:i})})})}var Co;function wo(t){return Ro.apply(this,arguments)}function Ro(){return Ro=k(mt.default.mark(function t(r){var e;return mt.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e=r.modules||{},!e.basisEncoder){a.next=3;break}return a.abrupt("return",e.basisEncoder);case 3:return Co=Co||oy(r),a.next=6,Co;case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}},t)})),Ro.apply(this,arguments)}function oy(t){return Io.apply(this,arguments)}function Io(){return Io=k(mt.default.mark(function t(r){var e,n,a,i;return mt.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return e=null,n=null,s.t0=Promise,s.next=5,ut(ny,"textures",r);case 5:return s.t1=s.sent,s.next=8,ut(ry,"textures",r);case 8:return s.t2=s.sent,s.t3=[s.t1,s.t2],s.next=12,s.t0.all.call(s.t0,s.t3);case 12:return a=s.sent,i=ae(a,2),e=i[0],n=i[1],e=e||globalThis.BASIS,s.next=19,sy(e,n);case 19:return s.abrupt("return",s.sent);case 20:case"end":return s.stop()}},t)})),Io.apply(this,arguments)}function sy(t,r){var e={};return r&&(e.wasmBinary=r),new Promise(function(n){t(e).then(function(a){var i=a.BasisFile,o=a.KTX2File,s=a.initializeBasis,u=a.BasisEncoder;s(),n({BasisFile:i,KTX2File:o,BasisEncoder:u})})})}var Vt={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919};function uy(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=fy(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function fy(t,r){if(t){if(typeof t=="string")return nd(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return nd(t,r)}}function nd(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var cy=["","WEBKIT_","MOZ_"],ad={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"},Aa=null;function id(t){if(!Aa){t=t||ly()||void 0,Aa=new Set;var r=uy(cy),e;try{for(r.s();!(e=r.n()).done;){var n=e.value;for(var a in ad)if(t&&t.getExtension("".concat(n).concat(a))){var i=ad[a];Aa.add(i)}}}catch(o){r.e(o)}finally{r.f()}}return Aa}function ly(){try{var t=document.createElement("canvas");return t.getContext("webgl")}catch{return null}}var vw=new Uint8Array([0]);var od,sd,ud,fd,cd,ld,dd,md;(function(t){t[t.NONE=0]="NONE",t[t.BASISLZ=1]="BASISLZ",t[t.ZSTD=2]="ZSTD",t[t.ZLIB=3]="ZLIB"})(od||(od={})),function(t){t[t.BASICFORMAT=0]="BASICFORMAT"}(sd||(sd={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.ETC1S=163]="ETC1S",t[t.UASTC=166]="UASTC"}(ud||(ud={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SRGB=1]="SRGB"}(fd||(fd={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LINEAR=1]="LINEAR",t[t.SRGB=2]="SRGB",t[t.ITU=3]="ITU",t[t.NTSC=4]="NTSC",t[t.SLOG=5]="SLOG",t[t.SLOG2=6]="SLOG2"}(cd||(cd={})),function(t){t[t.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",t[t.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(ld||(ld={})),function(t){t[t.RGB=0]="RGB",t[t.RRR=3]="RRR",t[t.GGG=4]="GGG",t[t.AAA=15]="AAA"}(dd||(dd={})),function(t){t[t.RGB=0]="RGB",t[t.RGBA=3]="RGBA",t[t.RRR=4]="RRR",t[t.RRRG=5]="RRRG"}(md||(md={}));var Ne=[171,75,84,88,32,50,48,187,13,10,26,10];function hd(t){var r=new Uint8Array(t),e=r.byteLength<Ne.length||r[0]!==Ne[0]||r[1]!==Ne[1]||r[2]!==Ne[2]||r[3]!==Ne[3]||r[4]!==Ne[4]||r[5]!==Ne[5]||r[6]!==Ne[6]||r[7]!==Ne[7]||r[8]!==Ne[8]||r[9]!==Ne[9]||r[10]!==Ne[10]||r[11]!==Ne[11];return!e}var dy={etc1:{basisFormat:0,compressed:!0,format:Vt.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:Vt.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:Vt.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:Vt.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:Vt.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:Vt.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};function Po(t,r){return Do.apply(this,arguments)}function Do(){return Do=k(Lo.default.mark(function t(r,e){var n,a,i,o,s,u;return Lo.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(e.basis.containerFormat!=="auto"){c.next=11;break}if(!hd(r)){c.next=6;break}return c.next=4,wo(e);case 4:return n=c.sent,c.abrupt("return",pd(n.KTX2File,r,e));case 6:return c.next=8,Oo(e);case 8:return a=c.sent,i=a.BasisFile,c.abrupt("return",Fo(i,r,e));case 11:c.t0=e.basis.module,c.next=c.t0==="encoder"?14:(c.t0==="transcoder",22);break;case 14:return c.next=16,wo(e);case 16:o=c.sent,c.t1=e.basis.containerFormat,c.next=c.t1==="ktx2"?20:(c.t1==="basis",21);break;case 20:return c.abrupt("return",pd(o.KTX2File,r,e));case 21:return c.abrupt("return",Fo(o.BasisFile,r,e));case 22:return c.next=24,Oo(e);case 24:return s=c.sent,u=s.BasisFile,c.abrupt("return",Fo(u,r,e));case 27:case"end":return c.stop()}},t)})),Do.apply(this,arguments)}function Fo(t,r,e){var n=new t(new Uint8Array(r));try{if(!n.startTranscoding())throw new Error("Failed to start basis transcoding");for(var a=n.getNumImages(),i=[],o=0;o<a;o++){for(var s=n.getNumLevels(o),u=[],f=0;f<s;f++)u.push(my(n,o,f,e));i.push(u)}return i}finally{n.close(),n.delete()}}function my(t,r,e,n){var a=t.getImageWidth(r,e),i=t.getImageHeight(r,e),o=t.getHasAlpha(),s=vd(n,o),u=s.compressed,f=s.format,c=s.basisFormat,d=t.getImageTranscodedSizeInBytes(r,e,c),m=new Uint8Array(d);if(!t.transcodeImage(m,r,e,c,0,0))throw new Error("failed to start Basis transcoding");return{width:a,height:i,data:m,compressed:u,format:f,hasAlpha:o}}function pd(t,r,e){var n=new t(new Uint8Array(r));try{if(!n.startTranscoding())throw new Error("failed to start KTX2 transcoding");for(var a=n.getLevels(),i=[],o=0;o<a;o++){i.push(hy(n,o,e));break}return[i]}finally{n.close(),n.delete()}}function hy(t,r,e){var n=t.getImageLevelInfo(r,0,0),a=n.alphaFlag,i=n.height,o=n.width,s=vd(e,a),u=s.compressed,f=s.format,c=s.basisFormat,d=t.getImageTranscodedSizeInBytes(r,0,0,c),m=new Uint8Array(d);if(!t.transcodeImage(m,r,0,0,c,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:o,height:i,data:m,compressed:u,levelSize:d,hasAlpha:a,format:f}}function vd(t,r){var e=t&&t.basis&&t.basis.format;return e==="auto"&&(e=ya()),$(e)==="object"&&(e=r?e.alpha:e.noAlpha),e=e.toLowerCase(),dy[e]}function ya(){var t=id();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}function gd(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function Ad(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?gd(Object(e),!0).forEach(function(n){l(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):gd(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}var yd={name:"Basis",id:dt?"basis":"basis-nodejs",module:"textures",version:td,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},Go=Ad(Ad({},yd),{},{parse:Po});function Te(t,r){if(!t)throw new Error(r||"assert failed: gltf")}function ko(t,r){var e=t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:");if(e)return t;var n=r.baseUri||r.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url ".concat(t));return n.substr(0,n.lastIndexOf("/")+1)+t}function bd(t,r,e){var n=t.bufferViews[e];Te(n);var a=n.buffer,i=r[a];Te(i);var o=(n.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,o,n.byteLength)}var _s=oe(ge());var zo={};Ze(zo,{decode:()=>Py,name:()=>Dy});var qr=oe(ge());var _d=["SCALAR","VEC2","VEC3","VEC4"],py=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],vy=new Map(py),gy={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ay={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},yy={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function ba(t){var r=_d[t-1];return r||_d[0]}function _a(t){var r=vy.get(t.constructor);if(!r)throw new Error("Illegal typed array");return r}function pr(t,r){var e=yy[t.componentType],n=gy[t.type],a=Ay[t.componentType],i=t.count*n,o=t.count*n*a;return Te(o>=0&&o<=r.byteLength),{ArrayType:e,length:i,byteLength:o}}function Bd(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=by(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function by(t,r){if(t){if(typeof t=="string")return Ed(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ed(t,r)}}function Ed(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function xd(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function _y(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?xd(Object(e),!0).forEach(function(n){l(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):xd(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}var By={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]},he=function(){function t(r){y(this,t),l(this,"gltf",void 0),l(this,"sourceBuffers",void 0),l(this,"byteLength",void 0),this.gltf=r||{json:_y({},By),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}return E(t,[{key:"json",get:function(){return this.gltf.json}},{key:"getApplicationData",value:function(e){var n=this.json[e];return n}},{key:"getExtraData",value:function(e){var n=this.json.extras||{};return n[e]}},{key:"getExtension",value:function(e){var n=this.getUsedExtensions().find(function(i){return i===e}),a=this.json.extensions||{};return n?a[e]||!0:null}},{key:"getRequiredExtension",value:function(e){var n=this.getRequiredExtensions().find(function(a){return a===e});return n?this.getExtension(e):null}},{key:"getRequiredExtensions",value:function(){return this.json.extensionsRequired||[]}},{key:"getUsedExtensions",value:function(){return this.json.extensionsUsed||[]}},{key:"getRemovedExtensions",value:function(){return this.json.extensionsRemoved||[]}},{key:"getObjectExtension",value:function(e,n){var a=e.extensions||{};return a[n]}},{key:"getScene",value:function(e){return this.getObject("scenes",e)}},{key:"getNode",value:function(e){return this.getObject("nodes",e)}},{key:"getSkin",value:function(e){return this.getObject("skins",e)}},{key:"getMesh",value:function(e){return this.getObject("meshes",e)}},{key:"getMaterial",value:function(e){return this.getObject("materials",e)}},{key:"getAccessor",value:function(e){return this.getObject("accessors",e)}},{key:"getTexture",value:function(e){return this.getObject("textures",e)}},{key:"getSampler",value:function(e){return this.getObject("samplers",e)}},{key:"getImage",value:function(e){return this.getObject("images",e)}},{key:"getBufferView",value:function(e){return this.getObject("bufferViews",e)}},{key:"getBuffer",value:function(e){return this.getObject("buffers",e)}},{key:"getObject",value:function(e,n){if($(n)==="object")return n;var a=this.json[e]&&this.json[e][n];if(!a)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(n,"]"));return a}},{key:"getTypedArrayForBufferView",value:function(e){e=this.getBufferView(e);var n=e.buffer,a=this.gltf.buffers[n];Te(a);var i=(e.byteOffset||0)+a.byteOffset;return new Uint8Array(a.arrayBuffer,i,e.byteLength)}},{key:"getTypedArrayForAccessor",value:function(e){e=this.getAccessor(e);var n=this.getBufferView(e.bufferView),a=this.getBuffer(n.buffer),i=a.data,o=pr(e,n),s=o.ArrayType,u=o.length,f=n.byteOffset+e.byteOffset;return new s(i,f,u)}},{key:"getTypedArrayForImageData",value:function(e){e=this.getAccessor(e);var n=this.getBufferView(e.bufferView),a=this.getBuffer(n.buffer),i=a.data,o=n.byteOffset||0;return new Uint8Array(i,o,n.byteLength)}},{key:"addApplicationData",value:function(e,n){return this.json[e]=n,this}},{key:"addExtraData",value:function(e,n){return this.json.extras=this.json.extras||{},this.json.extras[e]=n,this}},{key:"addObjectExtension",value:function(e,n,a){return e.extensions=e.extensions||{},e.extensions[n]=a,this.registerUsedExtension(n),this}},{key:"setObjectExtension",value:function(e,n,a){var i=e.extensions||{};i[n]=a}},{key:"removeObjectExtension",value:function(e,n){var a=e.extensions||{},i=a[n];return delete a[n],i}},{key:"addExtension",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Te(n),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=n,this.registerUsedExtension(e),n}},{key:"addRequiredExtension",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Te(n),this.addExtension(e,n),this.registerRequiredExtension(e),n}},{key:"registerUsedExtension",value:function(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(function(n){return n===e})||this.json.extensionsUsed.push(e)}},{key:"registerRequiredExtension",value:function(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(function(n){return n===e})||this.json.extensionsRequired.push(e)}},{key:"removeExtension",value:function(e){if(this.getExtension(e)){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e],Array.isArray(this.json.extensionsRemoved)||(this.json.extensionsRemoved=[]);var n=this.json.extensionsRemoved;n.includes(e)||n.push(e)}}},{key:"setDefaultScene",value:function(e){this.json.scene=e}},{key:"addScene",value:function(e){var n=e.nodeIndices;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}},{key:"addNode",value:function(e){var n=e.meshIndex,a=e.matrix;this.json.nodes=this.json.nodes||[];var i={mesh:n};return a&&(i.matrix=a),this.json.nodes.push(i),this.json.nodes.length-1}},{key:"addMesh",value:function(e){var n=e.attributes,a=e.indices,i=e.material,o=e.mode,s=o===void 0?4:o,u=this._addAttributes(n),f={primitives:[{attributes:u,mode:s}]};if(a){var c=this._addIndices(a);f.primitives[0].indices=c}return Number.isFinite(i)&&(f.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(f),this.json.meshes.length-1}},{key:"addPointCloud",value:function(e){var n=this._addAttributes(e),a={primitives:[{attributes:n,mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}},{key:"addImage",value:function(e,n){var a=jt(e),i=n||a?.mimeType,o=this.addBufferView(e),s={bufferView:o,mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(s),this.json.images.length-1}},{key:"addBufferView",value:function(e){var n=e.byteLength;Te(Number.isFinite(n)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);var a={buffer:0,byteOffset:this.byteLength,byteLength:n};return this.byteLength+=Ct(n,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(a),this.json.bufferViews.length-1}},{key:"addAccessor",value:function(e,n){var a={bufferView:e,type:ba(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(a),this.json.accessors.length-1}},{key:"addBinaryBuffer",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{size:3},a=this.addBufferView(e),i={min:n.min,max:n.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(e,n.size));var o={size:n.size,componentType:_a(e),count:Math.round(e.length/n.size),min:i.min,max:i.max};return this.addAccessor(a,Object.assign(o,n))}},{key:"addTexture",value:function(e){var n=e.imageIndex,a={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(a),this.json.textures.length-1}},{key:"addMaterial",value:function(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}},{key:"createBinaryChunk",value:function(){var e,n;this.gltf.buffers=[];var a=this.byteLength,i=new ArrayBuffer(a),o=new Uint8Array(i),s=0,u=Bd(this.sourceBuffers||[]),f;try{for(u.s();!(f=u.n()).done;){var c=f.value;s=ro(c,o,s)}}catch(d){u.e(d)}finally{u.f()}(e=this.json)!==null&&e!==void 0&&(n=e.buffers)!==null&&n!==void 0&&n[0]?this.json.buffers[0].byteLength=a:this.json.buffers=[{byteLength:a}],this.gltf.binary=i,this.sourceBuffers=[i]}},{key:"_removeStringFromArray",value:function(e,n){for(var a=!0;a;){var i=e.indexOf(n);i>-1?e.splice(i,1):a=!1}}},{key:"_addAttributes",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n={};for(var a in e){var i=e[a],o=this._getGltfAttributeName(a),s=this.addBinaryBuffer(i.value,i);n[o]=s}return n}},{key:"_addIndices",value:function(e){return this.addBinaryBuffer(e,{size:1})}},{key:"_getGltfAttributeName",value:function(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}},{key:"_getAccessorMinMax",value:function(e,n){var a={min:null,max:null};if(e.length<n)return a;a.min=[],a.max=[];var i=e.subarray(0,n),o=Bd(i),s;try{for(o.s();!(s=o.n()).done;){var u=s.value;a.min.push(u),a.max.push(u)}}catch(d){o.e(d)}finally{o.f()}for(var f=n;f<e.length;f+=n)for(var c=0;c<n;c++)a.min[0+c]=Math.min(a.min[0+c],e[f+c]),a.max[0+c]=Math.max(a.max[0+c],e[f+c]);return a}}]),t}();var Jt=oe(ge()),eF=(typeof WebAssembly>"u"?"undefined":$(WebAssembly))!=="object",Ey="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",xy="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",Ty=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),Cy=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),Sy={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},My={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};function Td(t,r,e,n,a){return No.apply(this,arguments)}function No(){return No=k(Jt.default.mark(function t(r,e,n,a,i){var o,s,u=arguments;return Jt.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=u.length>5&&u[5]!==void 0?u[5]:"NONE",c.next=3,Ry();case 3:s=c.sent,wy(s,s.exports[My[i]],r,e,n,a,s.exports[Sy[o||"NONE"]]);case 5:case"end":return c.stop()}},t)})),No.apply(this,arguments)}var Uo;function Ry(){return Ho.apply(this,arguments)}function Ho(){return Ho=k(Jt.default.mark(function t(){return Jt.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Uo||(Uo=Iy()),e.abrupt("return",Uo);case 2:case"end":return e.stop()}},t)})),Ho.apply(this,arguments)}function Iy(){return jo.apply(this,arguments)}function jo(){return jo=k(Jt.default.mark(function t(){var r,e;return Jt.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=Ey,WebAssembly.validate(Ty)&&(r=xy,console.log("Warning: meshopt_decoder is using experimental SIMD support")),a.next=4,WebAssembly.instantiate(Oy(r),{});case 4:return e=a.sent,a.next=7,e.instance.exports.__wasm_call_ctors();case 7:return a.abrupt("return",e.instance);case 8:case"end":return a.stop()}},t)})),jo.apply(this,arguments)}function Oy(t){for(var r=new Uint8Array(t.length),e=0;e<t.length;++e){var n=t.charCodeAt(e);r[e]=n>96?n-71:n>64?n-65:n>47?n+4:n>46?63:62}for(var a=0,i=0;i<t.length;++i)r[a++]=r[i]<60?Cy[r[i]]:(r[i]-60)*64+r[++i];return r.buffer.slice(0,a)}function wy(t,r,e,n,a,i,o){var s=t.exports.sbrk,u=n+3&-4,f=s(u*a),c=s(i.length),d=new Uint8Array(t.exports.memory.buffer);d.set(i,c);var m=r(f,n,a,c,i.length);if(m===0&&o&&o(f,u,a),e.set(d.subarray(f,f+n*a)),s(f-s(0)),m!==0)throw new Error("Malformed buffer data: ".concat(m))}function Fy(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Ly(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Ly(t,r){if(t){if(typeof t=="string")return Cd(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Cd(t,r)}}function Cd(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Xo="EXT_meshopt_compression",Dy=Xo;function Py(t,r){return Vo.apply(this,arguments)}function Vo(){return Vo=k(qr.default.mark(function t(r,e){var n,a,i,o,s,u;return qr.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(a=new he(r),e!=null&&(n=e.gltf)!==null&&n!==void 0&&n.decompressMeshes){c.next=3;break}return c.abrupt("return");case 3:i=[],o=Fy(r.json.bufferViews||[]);try{for(o.s();!(s=o.n()).done;)u=s.value,i.push(Gy(a,u))}catch(d){o.e(d)}finally{o.f()}return c.next=8,Promise.all(i);case 8:a.removeExtension(Xo);case 9:case"end":return c.stop()}},t)})),Vo.apply(this,arguments)}function Gy(t,r){return Jo.apply(this,arguments)}function Jo(){return Jo=k(qr.default.mark(function t(r,e){var n,a,i,o,s,u,f,c,d,m,h,p,v,g;return qr.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(n=r.getObjectExtension(e,Xo),!n){b.next=9;break}return a=n.byteOffset,i=a===void 0?0:a,o=n.byteLength,s=o===void 0?0:o,u=n.byteStride,f=n.count,c=n.mode,d=n.filter,m=d===void 0?"NONE":d,h=n.buffer,p=r.gltf.buffers[h],v=new Uint8Array(p.arrayBuffer,p.byteOffset+i,s),g=new Uint8Array(r.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength),b.next=8,Td(g,f,u,v,c,m);case 8:return b.abrupt("return",g);case 9:return b.abrupt("return",null);case 10:case"end":return b.stop()}},t)})),Jo.apply(this,arguments)}var Wo={};Ze(Wo,{name:()=>Ny,preprocess:()=>Hy});function ky(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Uy(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Uy(t,r){if(t){if(typeof t=="string")return Sd(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Sd(t,r)}}function Sd(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var vr="EXT_texture_webp",Ny=vr;function Hy(t,r){var e=new he(t);if(!_o("image/webp")){if(e.getRequiredExtensions().includes(vr))throw new Error("gltf: Required extension ".concat(vr," not supported by browser"));return}var n=e.json,a=ky(n.textures||[]),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.getObjectExtension(o,vr);s&&(o.source=s.source),e.removeObjectExtension(o,vr)}}catch(u){a.e(u)}finally{a.f()}e.removeExtension(vr)}var Ko={};Ze(Ko,{name:()=>Jy,preprocess:()=>Xy});function jy(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Vy(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Vy(t,r){if(t){if(typeof t=="string")return Md(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Md(t,r)}}function Md(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Ba="KHR_texture_basisu",Jy=Ba;function Xy(t,r){var e=new he(t),n=e.json,a=jy(n.textures||[]),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.getObjectExtension(o,Ba);s&&(o.source=s.source),e.removeObjectExtension(o,Ba)}}catch(u){a.e(u)}finally{a.f()}e.removeExtension(Ba)}var as={};Ze(as,{decode:()=>v0,encode:()=>g0,name:()=>h0,preprocess:()=>p0});var Xt=oe(ge());var qo=oe(ge());var Rd="3.4.2";var zy={draco:{decoderType:(typeof WebAssembly>"u"?"undefined":$(WebAssembly))==="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},Id={name:"Draco",id:dt?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:Rd,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:zy};function wd(t,r,e){var n=Fd(r.metadata),a=[],i=Wy(r.attributes);for(var o in t){var s=t[o],u=Od(o,s,i[o]);a.push(u)}if(e){var f=Od("indices",e);a.push(f)}return new Lr(a,n)}function Wy(t){var r={};for(var e in t){var n=t[e];r[n.name||"undefined"]=n}return r}function Od(t,r,e){var n=e?Fd(e.metadata):void 0,a=yi(t,r,n);return a}function Fd(t){var r=new Map;for(var e in t)r.set("".concat(e,".string"),JSON.stringify(t[e]));return r}function Ky(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Yy(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Yy(t,r){if(t){if(typeof t=="string")return Ld(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ld(t,r)}}function Ld(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Dd(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function Pd(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Dd(Object(e),!0).forEach(function(n){l(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Dd(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}var Gd={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},Qy={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},$y=4,kd=function(){function t(r){y(this,t),l(this,"draco",void 0),l(this,"decoder",void 0),l(this,"metadataQuerier",void 0),this.draco=r,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}return E(t,[{key:"destroy",value:function(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}},{key:"parseSync",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=new this.draco.DecoderBuffer;a.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(n);var i=this.decoder.GetEncodedGeometryType(a),o=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{var s;switch(i){case this.draco.TRIANGULAR_MESH:s=this.decoder.DecodeBufferToMesh(a,o);break;case this.draco.POINT_CLOUD:s=this.decoder.DecodeBufferToPointCloud(a,o);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!s.ok()||!o.ptr){var u="DRACO decompression failed: ".concat(s.error_msg());throw new Error(u)}var f=this._getDracoLoaderData(o,i,n),c=this._getMeshData(o,f,n),d=Fr(c.attributes),m=wd(c.attributes,f,c.indices),h=Pd(Pd({loader:"draco",loaderData:f,header:{vertexCount:o.num_points(),boundingBox:d}},c),{},{schema:m});return h}finally{this.draco.destroy(a),o&&this.draco.destroy(o)}}},{key:"_getDracoLoaderData",value:function(e,n,a){var i=this._getTopLevelMetadata(e),o=this._getDracoAttributes(e,a);return{geometry_type:n,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:i,attributes:o}}},{key:"_getDracoAttributes",value:function(e,n){for(var a={},i=0;i<e.num_attributes();i++){var o=this.decoder.GetAttribute(e,i),s=this._getAttributeMetadata(e,i);a[o.unique_id()]={unique_id:o.unique_id(),attribute_type:o.attribute_type(),data_type:o.data_type(),num_components:o.num_components(),byte_offset:o.byte_offset(),byte_stride:o.byte_stride(),normalized:o.normalized(),attribute_index:i,metadata:s};var u=this._getQuantizationTransform(o,n);u&&(a[o.unique_id()].quantization_transform=u);var f=this._getOctahedronTransform(o,n);f&&(a[o.unique_id()].octahedron_transform=f)}return a}},{key:"_getMeshData",value:function(e,n,a){var i=this._getMeshAttributes(n,e,a),o=i.POSITION;if(!o)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(a.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:i}}},{key:"_getMeshAttributes",value:function(e,n,a){for(var i={},o=0,s=Object.values(e.attributes);o<s.length;o++){var u=s[o],f=this._deduceAttributeName(u,a);u.name=f;var c=this._getAttributeValues(n,u),d=c.value,m=c.size;i[f]={value:d,size:m,byteOffset:u.byte_offset,byteStride:u.byte_stride,normalized:u.normalized}}return i}},{key:"_getTriangleListIndices",value:function(e){var n=e.num_faces(),a=n*3,i=a*$y,o=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(e,i,o),new Uint32Array(this.draco.HEAPF32.buffer,o,a).slice()}finally{this.draco._free(o)}}},{key:"_getTriangleStripIndices",value:function(e){var n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,n),e0(n)}finally{this.draco.destroy(n)}}},{key:"_getAttributeValues",value:function(e,n){var a=Qy[n.data_type],i=n.num_components,o=e.num_points(),s=o*i,u=s*a.BYTES_PER_ELEMENT,f=qy(this.draco,a),c,d=this.draco._malloc(u);try{var m=this.decoder.GetAttribute(e,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,m,f,u,d),c=new a(this.draco.HEAPF32.buffer,d,s).slice()}finally{this.draco._free(d)}return{value:c,size:i}}},{key:"_deduceAttributeName",value:function(e,n){for(var a=e.unique_id,i=0,o=Object.entries(n.extraAttributes||{});i<o.length;i++){var s=ae(o[i],2),u=s[0],f=s[1];if(f===a)return u}var c=e.attribute_type;for(var d in Gd){var m=this.draco[d];if(m===c)return Gd[d]}var h=n.attributeNameEntry||"name";return e.metadata[h]?e.metadata[h].string:"CUSTOM_ATTRIBUTE_".concat(a)}},{key:"_getTopLevelMetadata",value:function(e){var n=this.decoder.GetMetadata(e);return this._getDracoMetadata(n)}},{key:"_getAttributeMetadata",value:function(e,n){var a=this.decoder.GetAttributeMetadata(e,n);return this._getDracoMetadata(a)}},{key:"_getDracoMetadata",value:function(e){if(!e||!e.ptr)return{};for(var n={},a=this.metadataQuerier.NumEntries(e),i=0;i<a;i++){var o=this.metadataQuerier.GetEntryName(e,i);n[o]=this._getDracoMetadataField(e,o)}return n}},{key:"_getDracoMetadataField",value:function(e,n){var a=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,n,a);var i=Zy(a);return{int:this.metadataQuerier.GetIntEntry(e,n),string:this.metadataQuerier.GetStringEntry(e,n),double:this.metadataQuerier.GetDoubleEntry(e,n),intArray:i}}finally{this.draco.destroy(a)}}},{key:"_disableAttributeTransforms",value:function(e){var n=e.quantizedAttributes,a=n===void 0?[]:n,i=e.octahedronAttributes,o=i===void 0?[]:i,s=[].concat(Y(a),Y(o)),u=Ky(s),f;try{for(u.s();!(f=u.n()).done;){var c=f.value;this.decoder.SkipAttributeTransform(this.draco[c])}}catch(d){u.e(d)}finally{u.f()}}},{key:"_getQuantizationTransform",value:function(e,n){var a=this,i=n.quantizedAttributes,o=i===void 0?[]:i,s=e.attribute_type(),u=o.map(function(c){return a.decoder[c]}).includes(s);if(u){var f=new this.draco.AttributeQuantizationTransform;try{if(f.InitFromAttribute(e))return{quantization_bits:f.quantization_bits(),range:f.range(),min_values:new Float32Array([1,2,3]).map(function(c){return f.min_value(c)})}}finally{this.draco.destroy(f)}}return null}},{key:"_getOctahedronTransform",value:function(e,n){var a=this,i=n.octahedronAttributes,o=i===void 0?[]:i,s=e.attribute_type(),u=o.map(function(c){return a.decoder[c]}).includes(s);if(u){var f=new this.draco.AttributeQuantizationTransform;try{if(f.InitFromAttribute(e))return{quantization_bits:f.quantization_bits()}}finally{this.draco.destroy(f)}}return null}}]),t}();function qy(t,r){switch(r){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}function Zy(t){for(var r=t.size(),e=new Int32Array(r),n=0;n<r;n++)e[n]=t.GetValue(n);return e}function e0(t){for(var r=t.size(),e=new Int32Array(r),n=0;n<r;n++)e[n]=t.GetValue(n);return e}var en=oe(ge());function Ud(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function Nd(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Ud(Object(e),!0).forEach(function(n){l(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Ud(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}var t0="1.5.5",r0="1.4.1",$o="https://www.gstatic.com/draco/versioned/decoders/".concat(t0),n0="".concat($o,"/draco_decoder.js"),a0="".concat($o,"/draco_wasm_wrapper.js"),i0="".concat($o,"/draco_decoder.wasm"),RF="https://raw.githubusercontent.com/google/draco/".concat(r0,"/javascript/draco_encoder.js"),Zr;function Hd(t){return Yo.apply(this,arguments)}function Yo(){return Yo=k(en.default.mark(function t(r){var e;return en.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=r.modules||{},e.draco3d?Zr=Zr||e.draco3d.createDecoderModule({}).then(function(i){return{draco:i}}):Zr=Zr||o0(r),a.next=4,Zr;case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},t)})),Yo.apply(this,arguments)}function o0(t){return Qo.apply(this,arguments)}function Qo(){return Qo=k(en.default.mark(function t(r){var e,n,a,i;return en.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:s.t0=r.draco&&r.draco.decoderType,s.next=s.t0==="js"?3:(s.t0==="wasm",7);break;case 3:return s.next=5,ut(n0,"draco",r);case 5:return e=s.sent,s.abrupt("break",21);case 7:return s.t1=Promise,s.next=10,ut(a0,"draco",r);case 10:return s.t2=s.sent,s.next=13,ut(i0,"draco",r);case 13:return s.t3=s.sent,s.t4=[s.t2,s.t3],s.next=17,s.t1.all.call(s.t1,s.t4);case 17:a=s.sent,i=ae(a,2),e=i[0],n=i[1];case 21:return e=e||globalThis.DracoDecoderModule,s.next=24,s0(e,n);case 24:return s.abrupt("return",s.sent);case 25:case"end":return s.stop()}},t)})),Qo.apply(this,arguments)}function s0(t,r){var e={};return r&&(e.wasmBinary=r),new Promise(function(n){t(Nd(Nd({},e),{},{onModuleLoaded:function(i){return n({draco:i})}}))})}function jd(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function Vd(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?jd(Object(e),!0).forEach(function(n){l(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):jd(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}var Jd=Vd(Vd({},Id),{},{parse:u0});function u0(t,r){return Zo.apply(this,arguments)}function Zo(){return Zo=k(qo.default.mark(function t(r,e){var n,a,i;return qo.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Hd(e);case 2:return n=s.sent,a=n.draco,i=new kd(a),s.prev=5,s.abrupt("return",i.parseSync(r,e?.draco));case 7:return s.prev=7,i.destroy(),s.finish(7);case 10:case"end":return s.stop()}},t,null,[[5,,7,10]])})),Zo.apply(this,arguments)}function Xd(t){var r={};for(var e in t){var n=t[e];if(e!=="indices"){var a=es(n);r[e]=a}}return r}function es(t){var r=f0(t),e=r.buffer,n=r.size,a=r.count,i={value:e,size:n,byteOffset:0,count:a,type:ba(n),componentType:_a(e)};return i}function f0(t){var r=t,e=1,n=0;return t&&t.value&&(r=t.value,e=t.size||1),r&&(ArrayBuffer.isView(r)||(r=c0(r,Float32Array)),n=r.length/e),{buffer:r,size:e,count:n}}function c0(t,r){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return t?Array.isArray(t)?new r(t):e&&!(t instanceof r)?new r(t):t:null}function zd(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function l0(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?zd(Object(e),!0).forEach(function(n){l(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):zd(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}var d0=Xt.default.mark(ns);function tn(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=m0(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function m0(t,r){if(t){if(typeof t=="string")return Wd(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Wd(t,r)}}function Wd(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var zt="KHR_draco_mesh_compression",h0=zt;function p0(t,r,e){var n=new he(t),a=tn(ns(n)),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;n.getObjectExtension(o,zt)}}catch(s){a.e(s)}finally{a.f()}}function v0(t,r,e){return ts.apply(this,arguments)}function ts(){return ts=k(Xt.default.mark(function t(r,e,n){var a,i,o,s,u,f;return Xt.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(e!=null&&(a=e.gltf)!==null&&a!==void 0&&a.decompressMeshes){d.next=2;break}return d.abrupt("return");case 2:i=new he(r),o=[],s=tn(ns(i));try{for(s.s();!(u=s.n()).done;)f=u.value,i.getObjectExtension(f,zt)&&o.push(A0(i,f,e,n))}catch(m){s.e(m)}finally{s.f()}return d.next=8,Promise.all(o);case 8:i.removeExtension(zt);case 9:case"end":return d.stop()}},t)})),ts.apply(this,arguments)}function g0(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=new he(t),n=tn(e.json.meshes||[]),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;y0(i,r),e.addRequiredExtension(zt)}}catch(o){n.e(o)}finally{n.f()}}function A0(t,r,e,n){return rs.apply(this,arguments)}function rs(){return rs=k(Xt.default.mark(function t(r,e,n,a){var i,o,s,u,f,c,d,m,h,p,v,g,_,b;return Xt.default.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(i=r.getObjectExtension(e,zt),i){x.next=3;break}return x.abrupt("return");case 3:return o=r.getTypedArrayForBufferView(i.bufferView),s=zr(o.buffer,o.byteOffset),u=a.parse,f=l0({},n),delete f["3d-tiles"],x.next=10,u(s,Jd,f,a);case 10:for(c=x.sent,d=Xd(c.attributes),m=0,h=Object.entries(d);m<h.length;m++)p=ae(h[m],2),v=p[0],g=p[1],v in e.attributes&&(_=e.attributes[v],b=r.getAccessor(_),b!=null&&b.min&&b!==null&&b!==void 0&&b.max&&(g.min=b.min,g.max=b.max));e.attributes=d,c.indices&&(e.indices=es(c.indices)),b0(e);case 16:case"end":return x.stop()}},t)})),rs.apply(this,arguments)}function y0(t,r){var e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:4,a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(!a.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");var o=a.DracoWriter.encodeSync({attributes:t}),s=i==null||(e=i.parseSync)===null||e===void 0?void 0:e.call(i,{attributes:t}),u=a._addFauxAttributes(s.attributes),f=a.addBufferView(o),c={primitives:[{attributes:u,mode:n,extensions:l({},zt,{bufferView:f,attributes:u})}]};return c}function b0(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function ns(t){var r,e,n,a,i,o;return Xt.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r=tn(t.json.meshes||[]),u.prev=1,r.s();case 3:if((e=r.n()).done){u.next=24;break}n=e.value,a=tn(n.primitives),u.prev=6,a.s();case 8:if((i=a.n()).done){u.next=14;break}return o=i.value,u.next=12,o;case 12:u.next=8;break;case 14:u.next=19;break;case 16:u.prev=16,u.t0=u.catch(6),a.e(u.t0);case 19:return u.prev=19,a.f(),u.finish(19);case 22:u.next=3;break;case 24:u.next=29;break;case 26:u.prev=26,u.t1=u.catch(1),r.e(u.t1);case 29:return u.prev=29,r.f(),u.finish(29);case 32:case"end":return u.stop()}},d0,null,[[1,26,29,32],[6,16,19,22]])}var us={};Ze(us,{decode:()=>T0,name:()=>B0});var is=oe(ge());var Kd={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Yd={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4};function Qd(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=_0(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function _0(t,r){if(t){if(typeof t=="string")return $d(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return $d(t,r)}}function $d(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var ss="KHR_texture_transform",B0=ss,Ea=new Qe,E0=new Nt,x0=new Nt;function T0(t,r){return os.apply(this,arguments)}function os(){return os=k(is.default.mark(function t(r,e){var n,a,i,o;return is.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(n=new he(r),a=n.getExtension(ss),a){u.next=4;break}return u.abrupt("return");case 4:for(i=r.json.materials||[],o=0;o<i.length;o++)C0(o,r);case 6:case"end":return u.stop()}},t)})),os.apply(this,arguments)}function C0(t,r){var e,n,a,i=[],o=(e=r.json.materials)===null||e===void 0?void 0:e[t],s=o==null||(n=o.pbrMetallicRoughness)===null||n===void 0?void 0:n.baseColorTexture;s&&rn(r,t,s,i);var u=o?.emissiveTexture;u&&rn(r,t,u,i);var f=o?.normalTexture;f&&rn(r,t,f,i);var c=o?.occlusionTexture;c&&rn(r,t,c,i);var d=o==null||(a=o.pbrMetallicRoughness)===null||a===void 0?void 0:a.metallicRoughnessTexture;d&&rn(r,t,d,i)}function rn(t,r,e,n){var a=S0(e,n);if(a){var i=t.json.meshes||[],o=Qd(i),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,f=Qd(u.primitives),c;try{for(f.s();!(c=f.n()).done;){var d=c.value,m=d.material;Number.isFinite(m)&&r===m&&M0(t,d,a)}}catch(h){f.e(h)}finally{f.f()}}}catch(h){o.e(h)}finally{o.f()}}}function S0(t,r){var e,n=(e=t.extensions)===null||e===void 0?void 0:e[ss],a=t.texCoord,i=a===void 0?0:a,o=n.texCoord,s=o===void 0?i:o,u=r.findIndex(function(c){var d=ae(c,2),m=d[0],h=d[1];return m===i&&h===s})!==-1;if(!u){var f=O0(n);return i!==s&&(t.texCoord=s),r.push([i,s]),{originalTexCoord:i,texCoord:s,matrix:f}}return null}function M0(t,r,e){var n=e.originalTexCoord,a=e.texCoord,i=e.matrix,o=r.attributes["TEXCOORD_".concat(n)];if(Number.isFinite(o)){var s,u=(s=t.json.accessors)===null||s===void 0?void 0:s[o];if(u&&u.bufferView){var f,c=(f=t.json.bufferViews)===null||f===void 0?void 0:f[u.bufferView];if(c){for(var d=t.buffers[c.buffer],m=d.arrayBuffer,h=d.byteOffset,p=(h||0)+(u.byteOffset||0)+(c.byteOffset||0),v=pr(u,c),g=v.ArrayType,_=v.length,b=Yd[u.componentType],C=Kd[u.type],x=c.byteStride||b*C,T=new Float32Array(_),R=0;R<u.count;R++){var D=new g(m,p+R*x,2);Ea.set(D[0],D[1],1),Ea.transformByMatrix3(i),T.set([Ea[0],Ea[1]],R*C)}n===a?R0(u,c,t.buffers,T):I0(a,u,r,t,T)}}}}function R0(t,r,e,n){t.componentType=5126,e.push({arrayBuffer:n.buffer,byteOffset:0,byteLength:n.buffer.byteLength}),r.buffer=e.length-1,r.byteLength=n.buffer.byteLength,r.byteOffset=0,delete r.byteStride}function I0(t,r,e,n,a){n.buffers.push({arrayBuffer:a.buffer,byteOffset:0,byteLength:a.buffer.byteLength});var i=n.json.bufferViews;if(i){i.push({buffer:n.buffers.length-1,byteLength:a.buffer.byteLength,byteOffset:0});var o=n.json.accessors;o&&(o.push({bufferView:i?.length-1,byteOffset:0,componentType:5126,count:r.count,type:"VEC2"}),e.attributes["TEXCOORD_".concat(t)]=o.length-1)}}function O0(t){var r=t.offset,e=r===void 0?[0,0]:r,n=t.rotation,a=n===void 0?0:n,i=t.scale,o=i===void 0?[1,1]:i,s=new Nt().set(1,0,0,0,1,0,e[0],e[1],1),u=E0.set(Math.cos(a),Math.sin(a),0,-Math.sin(a),Math.cos(a),0,0,0,1),f=x0.set(o[0],0,0,0,o[1],0,0,0,1);return s.multiplyRight(u).multiplyRight(f)}var ls={};Ze(ls,{decode:()=>L0,encode:()=>D0,name:()=>F0});var nn=oe(ge());function Zd(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=w0(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function w0(t,r){if(t){if(typeof t=="string")return qd(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return qd(t,r)}}function qd(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Wt="KHR_lights_punctual",F0=Wt;function L0(t){return fs.apply(this,arguments)}function fs(){return fs=k(nn.default.mark(function t(r){var e,n,a,i,o,s,u;return nn.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:e=new he(r),n=e.json,a=e.getExtension(Wt),a&&(e.json.lights=a.lights,e.removeExtension(Wt)),i=Zd(n.nodes||[]);try{for(i.s();!(o=i.n()).done;)s=o.value,u=e.getObjectExtension(s,Wt),u&&(s.light=u.light),e.removeObjectExtension(s,Wt)}catch(d){i.e(d)}finally{i.f()}case 6:case"end":return c.stop()}},t)})),fs.apply(this,arguments)}function D0(t){return cs.apply(this,arguments)}function cs(){return cs=k(nn.default.mark(function t(r){var e,n,a,i,o,s,u;return nn.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(e=new he(r),n=e.json,n.lights&&(a=e.addExtension(Wt),Te(!a.lights),a.lights=n.lights,delete n.lights),e.json.lights){i=Zd(e.json.lights);try{for(i.s();!(o=i.n()).done;)s=o.value,u=s.node,e.addObjectExtension(u,Wt,s)}catch(d){i.e(d)}finally{i.f()}delete e.json.lights}case 4:case"end":return c.stop()}},t)})),cs.apply(this,arguments)}var hs={};Ze(hs,{decode:()=>k0,encode:()=>U0,name:()=>G0});var ds=oe(ge());function tm(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=P0(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function P0(t,r){if(t){if(typeof t=="string")return em(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return em(t,r)}}function em(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var an="KHR_materials_unlit",G0=an;function k0(t){return ms.apply(this,arguments)}function ms(){return ms=k(ds.default.mark(function t(r){var e,n,a,i,o,s;return ds.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:e=new he(r),n=e.json,a=tm(n.materials||[]);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.extensions&&o.extensions.KHR_materials_unlit,s&&(o.unlit=!0),e.removeObjectExtension(o,an)}catch(c){a.e(c)}finally{a.f()}e.removeExtension(an);case 5:case"end":return f.stop()}},t)})),ms.apply(this,arguments)}function U0(t){var r=new he(t),e=r.json;if(r.materials){var n=tm(e.materials||[]),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;i.unlit&&(delete i.unlit,r.addObjectExtension(i,an,{}),r.addExtension(an))}}catch(o){n.e(o)}finally{n.f()}}}var gs={};Ze(gs,{decode:()=>V0,encode:()=>J0,name:()=>j0});var sn=oe(ge());function N0(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=H0(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function H0(t,r){if(t){if(typeof t=="string")return rm(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return rm(t,r)}}function rm(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var on="KHR_techniques_webgl",j0=on;function V0(t){return ps.apply(this,arguments)}function ps(){return ps=k(sn.default.mark(function t(r){var e,n,a,i,o,s,u,f;return sn.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(e=new he(r),n=e.json,a=e.getExtension(on),a){i=X0(a,e),o=N0(n.materials||[]);try{for(o.s();!(s=o.n()).done;)u=s.value,f=e.getObjectExtension(u,on),f&&(u.technique=Object.assign({},f,i[f.technique]),u.technique.values=z0(u.technique,e)),e.removeObjectExtension(u,on)}catch(m){o.e(m)}finally{o.f()}e.removeExtension(on)}case 4:case"end":return d.stop()}},t)})),ps.apply(this,arguments)}function J0(t,r){return vs.apply(this,arguments)}function vs(){return vs=k(sn.default.mark(function t(r,e){return sn.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:case"end":return a.stop()}},t)})),vs.apply(this,arguments)}function X0(t,r){var e=t.programs,n=e===void 0?[]:e,a=t.shaders,i=a===void 0?[]:a,o=t.techniques,s=o===void 0?[]:o,u=new TextDecoder;return i.forEach(function(f){if(Number.isFinite(f.bufferView))f.code=u.decode(r.getTypedArrayForBufferView(f.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),n.forEach(function(f){f.fragmentShader=i[f.fragmentShader],f.vertexShader=i[f.vertexShader]}),s.forEach(function(f){f.program=n[f.program]}),s}function z0(t,r){var e=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(function(n){t.uniforms[n].value&&!(n in e)&&(e[n]=t.uniforms[n].value)}),Object.keys(e).forEach(function(n){$(e[n])==="object"&&e[n].index!==void 0&&(e[n].texture=r.getTexture(e[n].index))}),e}var bs={};Ze(bs,{decode:()=>K0,name:()=>W0});var As=oe(ge());var nm="EXT_feature_metadata",W0=nm;function K0(t){return ys.apply(this,arguments)}function ys(){return ys=k(As.default.mark(function t(r){var e;return As.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e=new he(r),Y0(e);case 2:case"end":return a.stop()}},t)})),ys.apply(this,arguments)}function Y0(t){var r,e=t.getExtension(nm),n=e==null||(r=e.schema)===null||r===void 0?void 0:r.classes,a=e?.featureTables,i=e?.featureTextures;if(i&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.'),n&&a)for(var o in n){var s=n[o],u=q0(a,o);u&&Q0(t,u,s)}}function Q0(t,r,e){for(var n in e.properties){var a,i=e.properties[n],o=r==null||(a=r.properties)===null||a===void 0?void 0:a[n],s=r.count;if(o){var u=$0(t,i,s,o);o.data=u}}}function $0(t,r,e,n){var a=n.bufferView,i=t.getTypedArrayForBufferView(a);switch(r.type){case"STRING":{var o=n.stringOffsetBufferView,s=t.getTypedArrayForBufferView(o);i=Z0(i,s,e);break}default:}return i}function q0(t,r){for(var e in t){var n=t[e];if(n.class===r)return n}return null}function Z0(t,r,e){for(var n=[],a=new TextDecoder("utf8"),i=0,o=4,s=0;s<e;s++){var u=r[(s+1)*o]-r[s*o],f=t.subarray(i,u+i),c=a.decode(f);n.push(c),i+=u}return n}function im(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=eb(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function eb(t,r){if(t){if(typeof t=="string")return am(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return am(t,r)}}function am(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var om=[zo,Wo,Ko,as,ls,hs,gs,us,bs];function sm(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0,n=om.filter(function(u){return fm(u.name,r)}),a=im(n),i;try{for(a.s();!(i=a.n()).done;){var o=i.value,s;(s=o.preprocess)===null||s===void 0||s.call(o,t,r,e)}}catch(u){a.e(u)}finally{a.f()}}function um(t){return Bs.apply(this,arguments)}function Bs(){return Bs=k(_s.default.mark(function t(r){var e,n,a,i,o,s,u,f=arguments;return _s.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:e=f.length>1&&f[1]!==void 0?f[1]:{},n=f.length>2?f[2]:void 0,a=om.filter(function(m){return fm(m.name,e)}),i=im(a),d.prev=4,i.s();case 6:if((o=i.n()).done){d.next=12;break}return s=o.value,d.next=10,(u=s.decode)===null||u===void 0?void 0:u.call(s,r,e,n);case 10:d.next=6;break;case 12:d.next=17;break;case 14:d.prev=14,d.t0=d.catch(4),i.e(d.t0);case 17:return d.prev=17,i.f(),d.finish(17);case 20:case"end":return d.stop()}},t,null,[[4,14,17,20]])})),Bs.apply(this,arguments)}function fm(t,r){var e,n=(r==null||(e=r.gltf)===null||e===void 0?void 0:e.excludeExtensions)||{},a=t in n&&!n[t];return!a}function tb(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=rb(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function rb(t,r){if(t){if(typeof t=="string")return cm(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return cm(t,r)}}function cm(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Es="KHR_binary_glTF";function lm(t){var r=new he(t),e=r.json,n=tb(e.images||[]),a;try{for(n.s();!(a=n.n()).done;){var i=a.value,o=r.getObjectExtension(i,Es);o&&Object.assign(i,o),r.removeObjectExtension(i,Es)}}catch(s){n.e(s)}finally{n.f()}e.buffers&&e.buffers[0]&&delete e.buffers[0].uri,r.removeExtension(Es)}function St(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=ab(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function ab(t,r){if(t){if(typeof t=="string")return dm(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return dm(t,r)}}function dm(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var mm={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},ib={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},ob=function(){function t(){y(this,t),l(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),l(this,"json",void 0)}return E(t,[{key:"normalize",value:function(e,n){this.json=e.json;var a=e.json;switch(a.asset&&a.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(a.asset.version));return}if(!n.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(a),this._convertTopLevelObjectsToArrays(a),lm(e),this._convertObjectIdsToArrayIndices(a),this._updateObjects(a),this._updateMaterial(a)}},{key:"_addAsset",value:function(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}},{key:"_convertTopLevelObjectsToArrays",value:function(e){for(var n in mm)this._convertTopLevelObjectToArray(e,n)}},{key:"_convertTopLevelObjectToArray",value:function(e,n){var a=e[n];if(!(!a||Array.isArray(a))){e[n]=[];for(var i in a){var o=a[i];o.id=o.id||i;var s=e[n].length;e[n].push(o),this.idToIndexMap[n][i]=s}}}},{key:"_convertObjectIdsToArrayIndices",value:function(e){for(var n in mm)this._convertIdsToIndices(e,n);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));var a=St(e.textures),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;this._convertTextureIds(o)}}catch(g){a.e(g)}finally{a.f()}var s=St(e.meshes),u;try{for(s.s();!(u=s.n()).done;){var f=u.value;this._convertMeshIds(f)}}catch(g){s.e(g)}finally{s.f()}var c=St(e.nodes),d;try{for(c.s();!(d=c.n()).done;){var m=d.value;this._convertNodeIds(m)}}catch(g){c.e(g)}finally{c.f()}var h=St(e.scenes),p;try{for(h.s();!(p=h.n()).done;){var v=p.value;this._convertSceneIds(v)}}catch(g){h.e(g)}finally{h.f()}}},{key:"_convertTextureIds",value:function(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}},{key:"_convertMeshIds",value:function(e){var n=St(e.primitives),a;try{for(n.s();!(a=n.n()).done;){var i=a.value,o=i.attributes,s=i.indices,u=i.material;for(var f in o)o[f]=this._convertIdToIndex(o[f],"accessor");s&&(i.indices=this._convertIdToIndex(s,"accessor")),u&&(i.material=this._convertIdToIndex(u,"material"))}}catch(c){n.e(c)}finally{n.f()}}},{key:"_convertNodeIds",value:function(e){var n=this;e.children&&(e.children=e.children.map(function(a){return n._convertIdToIndex(a,"node")})),e.meshes&&(e.meshes=e.meshes.map(function(a){return n._convertIdToIndex(a,"mesh")}))}},{key:"_convertSceneIds",value:function(e){var n=this;e.nodes&&(e.nodes=e.nodes.map(function(a){return n._convertIdToIndex(a,"node")}))}},{key:"_convertIdsToIndices",value:function(e,n){e[n]||(console.warn("gltf v1: json doesn't contain attribute ".concat(n)),e[n]=[]);var a=St(e[n]),i;try{for(a.s();!(i=a.n()).done;){var o=i.value;for(var s in o){var u=o[s],f=this._convertIdToIndex(u,s);o[s]=f}}}catch(c){a.e(c)}finally{a.f()}}},{key:"_convertIdToIndex",value:function(e,n){var a=ib[n];if(a in this.idToIndexMap){var i=this.idToIndexMap[a][e];if(!Number.isFinite(i))throw new Error("gltf v1: failed to resolve ".concat(n," with id ").concat(e));return i}return e}},{key:"_updateObjects",value:function(e){var n=St(this.json.buffers),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;delete i.type}}catch(o){n.e(o)}finally{n.f()}}},{key:"_updateMaterial",value:function(e){var n=St(e.materials),a;try{var i=function(){var c=a.value;c.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};var d=((o=c.values)===null||o===void 0?void 0:o.tex)||((s=c.values)===null||s===void 0?void 0:s.texture2d_0)||((u=c.values)===null||u===void 0?void 0:u.diffuseTex),m=e.textures.findIndex(function(h){return h.id===d});m!==-1&&(c.pbrMetallicRoughness.baseColorTexture={index:m})};for(n.s();!(a=n.n()).done;){var o,s,u;i()}}catch(f){n.e(f)}finally{n.f()}}}]),t}();function hm(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new ob().normalize(t,r)}var gr;function pm(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function ht(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?pm(Object(e),!0).forEach(function(n){l(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):pm(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}var sb={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ub={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},ze={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},fb={magFilter:ze.TEXTURE_MAG_FILTER,minFilter:ze.TEXTURE_MIN_FILTER,wrapS:ze.TEXTURE_WRAP_S,wrapT:ze.TEXTURE_WRAP_T},cb=(gr={},l(gr,ze.TEXTURE_MAG_FILTER,ze.LINEAR),l(gr,ze.TEXTURE_MIN_FILTER,ze.NEAREST_MIPMAP_LINEAR),l(gr,ze.TEXTURE_WRAP_S,ze.REPEAT),l(gr,ze.TEXTURE_WRAP_T,ze.REPEAT),gr);function lb(t){return ub[t]}function db(t){return sb[t]}var mb=function(){function t(){y(this,t),l(this,"baseUri",""),l(this,"json",{}),l(this,"buffers",[]),l(this,"images",[])}return E(t,[{key:"postProcess",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=e.json,i=e.buffers,o=i===void 0?[]:i,s=e.images,u=s===void 0?[]:s,f=e.baseUri,c=f===void 0?"":f;return Te(a),this.baseUri=c,this.json=a,this.buffers=o,this.images=u,this._resolveTree(this.json,n),this.json}},{key:"_resolveTree",value:function(e){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.bufferViews&&(e.bufferViews=e.bufferViews.map(function(i,o){return n._resolveBufferView(i,o)})),e.images&&(e.images=e.images.map(function(i,o){return n._resolveImage(i,o)})),e.samplers&&(e.samplers=e.samplers.map(function(i,o){return n._resolveSampler(i,o)})),e.textures&&(e.textures=e.textures.map(function(i,o){return n._resolveTexture(i,o)})),e.accessors&&(e.accessors=e.accessors.map(function(i,o){return n._resolveAccessor(i,o)})),e.materials&&(e.materials=e.materials.map(function(i,o){return n._resolveMaterial(i,o)})),e.meshes&&(e.meshes=e.meshes.map(function(i,o){return n._resolveMesh(i,o)})),e.nodes&&(e.nodes=e.nodes.map(function(i,o){return n._resolveNode(i,o)})),e.skins&&(e.skins=e.skins.map(function(i,o){return n._resolveSkin(i,o)})),e.scenes&&(e.scenes=e.scenes.map(function(i,o){return n._resolveScene(i,o)})),e.scene!==void 0&&(e.scene=e.scenes[this.json.scene])}},{key:"getScene",value:function(e){return this._get("scenes",e)}},{key:"getNode",value:function(e){return this._get("nodes",e)}},{key:"getSkin",value:function(e){return this._get("skins",e)}},{key:"getMesh",value:function(e){return this._get("meshes",e)}},{key:"getMaterial",value:function(e){return this._get("materials",e)}},{key:"getAccessor",value:function(e){return this._get("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this._get("textures",e)}},{key:"getSampler",value:function(e){return this._get("samplers",e)}},{key:"getImage",value:function(e){return this._get("images",e)}},{key:"getBufferView",value:function(e){return this._get("bufferViews",e)}},{key:"getBuffer",value:function(e){return this._get("buffers",e)}},{key:"_get",value:function(e,n){if($(n)==="object")return n;var a=this.json[e]&&this.json[e][n];return a||console.warn("glTF file error: Could not find ".concat(e,"[").concat(n,"]")),a}},{key:"_resolveScene",value:function(e,n){var a=this;return e.id=e.id||"scene-".concat(n),e.nodes=(e.nodes||[]).map(function(i){return a.getNode(i)}),e}},{key:"_resolveNode",value:function(e,n){var a=this;return e.id=e.id||"node-".concat(n),e.children&&(e.children=e.children.map(function(i){return a.getNode(i)})),e.mesh!==void 0?e.mesh=this.getMesh(e.mesh):e.meshes!==void 0&&e.meshes.length&&(e.mesh=e.meshes.reduce(function(i,o){var s=a.getMesh(o);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),e.camera!==void 0&&(e.camera=this.getCamera(e.camera)),e.skin!==void 0&&(e.skin=this.getSkin(e.skin)),e}},{key:"_resolveSkin",value:function(e,n){return e.id=e.id||"skin-".concat(n),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}},{key:"_resolveMesh",value:function(e,n){var a=this;return e.id=e.id||"mesh-".concat(n),e.primitives&&(e.primitives=e.primitives.map(function(i){i=ht({},i);var o=i.attributes;i.attributes={};for(var s in o)i.attributes[s]=a.getAccessor(o[s]);return i.indices!==void 0&&(i.indices=a.getAccessor(i.indices)),i.material!==void 0&&(i.material=a.getMaterial(i.material)),i})),e}},{key:"_resolveMaterial",value:function(e,n){if(e.id=e.id||"material-".concat(n),e.normalTexture&&(e.normalTexture=ht({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=ht({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=ht({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness=ht({},e.pbrMetallicRoughness);var a=e.pbrMetallicRoughness;a.baseColorTexture&&(a.baseColorTexture=ht({},a.baseColorTexture),a.baseColorTexture.texture=this.getTexture(a.baseColorTexture.index)),a.metallicRoughnessTexture&&(a.metallicRoughnessTexture=ht({},a.metallicRoughnessTexture),a.metallicRoughnessTexture.texture=this.getTexture(a.metallicRoughnessTexture.index))}return e}},{key:"_resolveAccessor",value:function(e,n){if(e.id=e.id||"accessor-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=lb(e.componentType),e.components=db(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){var a=e.bufferView.buffer,i=pr(e,e.bufferView),o=i.ArrayType,s=i.byteLength,u=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+a.byteOffset,f=a.arrayBuffer.slice(u,u+s);e.bufferView.byteStride&&(f=this._getValueFromInterleavedBuffer(a,u,e.bufferView.byteStride,e.bytesPerElement,e.count)),e.value=new o(f)}return e}},{key:"_getValueFromInterleavedBuffer",value:function(e,n,a,i,o){for(var s=new Uint8Array(o*i),u=0;u<o;u++){var f=n+u*a;s.set(new Uint8Array(e.arrayBuffer.slice(f,f+i)),u*i)}return s.buffer}},{key:"_resolveTexture",value:function(e,n){return e.id=e.id||"texture-".concat(n),e.sampler="sampler"in e?this.getSampler(e.sampler):cb,e.source=this.getImage(e.source),e}},{key:"_resolveSampler",value:function(e,n){e.id=e.id||"sampler-".concat(n),e.parameters={};for(var a in e){var i=this._enumSamplerParameter(a);i!==void 0&&(e.parameters[i]=e[a])}return e}},{key:"_enumSamplerParameter",value:function(e){return fb[e]}},{key:"_resolveImage",value:function(e,n){e.id=e.id||"image-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView));var a=this.images[n];return a&&(e.image=a),e}},{key:"_resolveBufferView",value:function(e,n){var a=e.buffer,i=ht(ht({id:"bufferView-".concat(n)},e),{},{buffer:this.buffers[a]}),o=this.buffers[a].arrayBuffer,s=this.buffers[a].byteOffset||0;return"byteOffset"in e&&(s+=e.byteOffset),i.data=new Uint8Array(o,s,e.byteLength),i}},{key:"_resolveCamera",value:function(e,n){return e.id=e.id||"camera-".concat(n),e.perspective,e.orthographic,e}}]),t}();function vm(t,r){return new mb().postProcess(t,r)}var gm=1735152710,Cs=12,xa=8,hb=1313821514,pb=5130562,vb=0,gb=1,Ab=0,Ar=!0;function yb(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return"".concat(String.fromCharCode(t.getUint8(r+0))).concat(String.fromCharCode(t.getUint8(r+1))).concat(String.fromCharCode(t.getUint8(r+2))).concat(String.fromCharCode(t.getUint8(r+3)))}function Am(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=new DataView(t),a=e.magic,i=a===void 0?gm:a,o=n.getUint32(r,!1);return o===i||o===gm}function Ss(t,r){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=new DataView(r),i=yb(a,e+0),o=a.getUint32(e+4,Ar),s=a.getUint32(e+8,Ar);switch(Object.assign(t,{header:{byteOffset:e,byteLength:s,hasBinChunk:!1},type:i,version:o,json:{},binChunks:[]}),e+=Cs,t.version){case 1:return bb(t,a,e);case 2:return _b(t,a,e,n={});default:throw new Error("Invalid GLB version ".concat(t.version,". Only supports v1 and v2."))}}function bb(t,r,e){Xe(t.header.byteLength>Cs+xa);var n=r.getUint32(e+0,Ar),a=r.getUint32(e+4,Ar);return e+=xa,Xe(a===Ab),xs(t,r,e,n),e+=n,e+=Ts(t,r,e,t.header.byteLength),e}function _b(t,r,e,n){return Xe(t.header.byteLength>Cs+xa),Bb(t,r,e,n),e+t.header.byteLength}function Bb(t,r,e,n){for(;e+8<=t.header.byteLength;){var a=r.getUint32(e+0,Ar),i=r.getUint32(e+4,Ar);switch(e+=xa,i){case hb:xs(t,r,e,a);break;case pb:Ts(t,r,e,a);break;case vb:n.strict||xs(t,r,e,a);break;case gb:n.strict||Ts(t,r,e,a);break;default:break}e+=Ct(a,4)}return e}function xs(t,r,e,n){var a=new Uint8Array(r.buffer,e,n),i=new TextDecoder("utf8"),o=i.decode(a);return t.json=JSON.parse(o),Ct(n,4)}function Ts(t,r,e,n){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:e,byteLength:n,arrayBuffer:r.buffer}),Ct(n,4)}function bm(t,r){var e=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Eb(t))||r&&t&&typeof t.length=="number"){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){e=e.call(t)},n:function(){var f=e.next();return i=f.done,f},e:function(f){o=!0,s=f},f:function(){try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}}}function Eb(t,r){if(t){if(typeof t=="string")return ym(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ym(t,r)}}function ym(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function _m(t,r){return Ms.apply(this,arguments)}function Ms(){return Ms=k(pt.default.mark(function t(r,e){var n,a,i,o,s,u,f,c,d,m,h=arguments;return pt.default.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(s=h.length>2&&h[2]!==void 0?h[2]:0,u=h.length>3?h[3]:void 0,f=h.length>4?h[4]:void 0,xb(r,e,s,u),hm(r,{normalize:u==null||(n=u.gltf)===null||n===void 0?void 0:n.normalize}),sm(r,u,f),c=[],!(u!=null&&(a=u.gltf)!==null&&a!==void 0&&a.loadBuffers&&r.json.buffers)){v.next=10;break}return v.next=10,Tb(r,u,f);case 10:return u!=null&&(i=u.gltf)!==null&&i!==void 0&&i.loadImages&&(d=Cb(r,u,f),c.push(d)),m=um(r,u,f),c.push(m),v.next=15,Promise.all(c);case 15:return v.abrupt("return",u!=null&&(o=u.gltf)!==null&&o!==void 0&&o.postProcess?vm(r,u):r);case 16:case"end":return v.stop()}},t)})),Ms.apply(this,arguments)}function xb(t,r,e,n){if(n.uri&&(t.baseUri=n.uri),r instanceof ArrayBuffer&&!Am(r,e,n)){var a=new TextDecoder;r=a.decode(r)}if(typeof r=="string")t.json=to(r);else if(r instanceof ArrayBuffer){var i={};e=Ss(i,r,e,n.glb),Te(i.type==="glTF","Invalid GLB magic string ".concat(i.type)),t._glb=i,t.json=i.json}else Te(!1,"GLTF: must be ArrayBuffer or string");var o=t.json.buffers||[];if(t.buffers=new Array(o.length).fill(null),t._glb&&t._glb.header.hasBinChunk){var s=t._glb.binChunks;t.buffers[0]={arrayBuffer:s[0].arrayBuffer,byteOffset:s[0].byteOffset,byteLength:s[0].byteLength}}var u=t.json.images||[];t.images=new Array(u.length).fill({})}function Tb(t,r,e){return Rs.apply(this,arguments)}function Rs(){return Rs=k(pt.default.mark(function t(r,e,n){var a,i,o,s,u,f,c,d,m;return pt.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:a=r.json.buffers||[],i=0;case 2:if(!(i<a.length)){p.next=22;break}if(o=a[i],!o.uri){p.next=18;break}return f=n.fetch,Te(f),c=ko(o.uri,e),p.next=10,n==null||(s=n.fetch)===null||s===void 0?void 0:s.call(n,c);case 10:return d=p.sent,p.next=13,d==null||(u=d.arrayBuffer)===null||u===void 0?void 0:u.call(d);case 13:m=p.sent,r.buffers[i]={arrayBuffer:m,byteOffset:0,byteLength:m.byteLength},delete o.uri,p.next=19;break;case 18:r.buffers[i]===null&&(r.buffers[i]={arrayBuffer:new ArrayBuffer(o.byteLength),byteOffset:0,byteLength:o.byteLength});case 19:++i,p.next=2;break;case 22:case"end":return p.stop()}},t)})),Rs.apply(this,arguments)}function Cb(t,r,e){return Is.apply(this,arguments)}function Is(){return Is=k(pt.default.mark(function t(r,e,n){var a,i,o,s,u,f;return pt.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:a=Sb(r),i=r.json.images||[],o=[],s=bm(a);try{for(s.s();!(u=s.n()).done;)f=u.value,o.push(Mb(r,i[f],f,e,n))}catch(m){s.e(m)}finally{s.f()}return d.next=7,Promise.all(o);case 7:return d.abrupt("return",d.sent);case 8:case"end":return d.stop()}},t)})),Is.apply(this,arguments)}function Sb(t){var r=new Set,e=t.json.textures||[],n=bm(e),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;i.source!==void 0&&r.add(i.source)}}catch(o){n.e(o)}finally{n.f()}return Array.from(r).sort()}function Mb(t,r,e,n,a){return Os.apply(this,arguments)}function Os(){return Os=k(pt.default.mark(function t(r,e,n,a,i){var o,s,u,f,c,d,m;return pt.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(o=i.fetch,s=i.parse,!(e.uri&&!e.hasOwnProperty("bufferView"))){p.next=10;break}return f=ko(e.uri,a),p.next=5,o(f);case 5:return c=p.sent,p.next=8,c.arrayBuffer();case 8:u=p.sent,e.bufferView={data:u};case 10:return Number.isFinite(e.bufferView)&&(d=bd(r.json,r.buffers,e.bufferView),u=zr(d.buffer,d.byteOffset,d.byteLength)),Te(u,"glTF image has no data"),p.next=14,s(u,[yo,Go],{mimeType:e.mimeType,basis:a.basis||{format:ya()}},i);case 14:m=p.sent,m&&m[0]&&(m={compressed:!0,mipmaps:!1,width:m[0].width,height:m[0].height,data:m[0]}),r.images=r.images||[],r.images[n]=m;case 18:case"end":return p.stop()}},t)})),Os.apply(this,arguments)}function Bm(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function Ta(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Bm(Object(e),!0).forEach(function(n){l(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Bm(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}var un={name:"glTF",id:"gltf",module:"gltf",version:ed,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:Rb,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function Rb(t){return Fs.apply(this,arguments)}function Fs(){return Fs=k(ws.default.mark(function t(r){var e,n,a,i,o,s,u=arguments;return ws.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return e=u.length>1&&u[1]!==void 0?u[1]:{},n=u.length>2?u[2]:void 0,e=Ta(Ta({},un.options),e),e.gltf=Ta(Ta({},un.options.gltf),e.gltf),a=e,i=a.byteOffset,o=i===void 0?0:i,s={},c.next=8,_m(s,r,o,e,n);case 8:return c.abrupt("return",c.sent);case 9:case"end":return c.stop()}},t)})),Fs.apply(this,arguments)}var fn=oe(ge());function Em(t){return Ls.apply(this,arguments)}function Ls(){return Ls=k(fn.default.mark(function t(r){var e;return fn.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=[],r.scenes.forEach(function(i){i.traverse(function(o){Object.values(o.model.getUniforms()).forEach(function(s){s.loaded===!1&&e.push(s)})})}),a.next=4,Ib(function(){return e.some(function(i){return!i.loaded})});case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},t)})),Ls.apply(this,arguments)}function Ib(t){return Ds.apply(this,arguments)}function Ds(){return Ds=k(fn.default.mark(function t(r){return fn.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!r()){n.next=5;break}return n.next=3,new Promise(function(a){return requestAnimationFrame(a)});case 3:n.next=0;break;case 5:case"end":return n.stop()}},t)})),Ds.apply(this,arguments)}var xm=`#version 300 es
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform mat4 sceneModelMatrix;
uniform bool composeModelMatrix;
in vec4 POSITION;

#ifdef HAS_UV
  in vec2 TEXCOORD_0;
#endif

#ifdef MODULE_PBR
  #ifdef HAS_NORMALS
    in vec4 NORMAL;
  #endif
#endif
out vec4 vColor;
#ifndef MODULE_PBR
  #ifdef HAS_UV
    out vec2 vTEXCOORD_0;
  #endif
#endif
void main(void) {
  #if defined(HAS_UV) && !defined(MODULE_PBR)
    vTEXCOORD_0 = TEXCOORD_0;
    geometry.uv = vTEXCOORD_0;
  #endif

  geometry.worldPosition = instancePositions;
  geometry.pickingColor = instancePickingColors;

  vec3 normal = vec3(0.0, 0.0, 1.0);
  #ifdef MODULE_PBR
    #ifdef HAS_NORMALS
      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;
    #endif
  #endif

  float originalSize = project_size_to_pixel(sizeScale);
  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);

  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;
  if(composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    geometry.normal = project_normal(normal);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
    geometry.normal = project_normal(normal);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = TEXCOORD_0;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var Tm=`#version 300 es
uniform float opacity;
in vec4 vColor;

out vec4 fragmentColor;
#ifndef MODULE_PBR
  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
    in vec2 vTEXCOORD_0;
    uniform sampler2D u_BaseColorSampler;
  #endif
#endif

void main(void) {
  #ifdef MODULE_PBR
    fragmentColor = vColor * pbr_filterColor(vec4(0));
    geometry.uv = pbr_vUV;
  #else
    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);
      geometry.uv = vTEXCOORD_0;
    #else
      fragmentColor = vColor;
    #endif
  #endif

  fragmentColor.a *= opacity;
  DECKGL_FILTER_COLOR(fragmentColor, geometry);
}
`;function Cm(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function Sm(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Cm(Object(e),!0).forEach(function(n){l(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Cm(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function Ob(t){var r=wb();return function(){var n=O(t),a;if(r){var i=O(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return W(this,a)}}function wb(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Rm=[255,255,255,255],Fb={scenegraph:{type:"object",value:null,async:!0},getScene:function(r){return r&&r.scenes?$(r.scene)==="object"?r.scene:r.scenes[r.scene||0]:r},getAnimator:function(r){return r&&r.animator},_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:function(r){return r.position}},getColor:{type:"accessor",value:Rm},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[un]},Ca=function(t){w(e,t);var r=Ob(e);function e(){var n;y(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=r.call.apply(r,[this].concat(i)),l(Z(n),"state",void 0),n}return E(e,[{key:"getShaders",value:function(){var a=[$e.project32,$e.picking];return this.props._lighting==="pbr"&&a.push(jr),ve(O(e.prototype),"getShaders",this).call(this,{vs:xm,fs:Tm,modules:a})}},{key:"initializeState",value:function(){var a=this.getAttributeManager();a.addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:Rm,transition:!0},instanceModelMatrix:Pn})}},{key:"updateState",value:function(a){ve(O(e.prototype),"updateState",this).call(this,a);var i=a.props,o=a.oldProps;i.scenegraph!==o.scenegraph?this._updateScenegraph():i._animations!==o._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,i._animations)}},{key:"finalizeState",value:function(a){ve(O(e.prototype),"finalizeState",this).call(this,a),this._deleteScenegraph()}},{key:"_updateScenegraph",value:function(){var a=this,i=this.props,o=this.context.gl,s=null;if(i.scenegraph instanceof ct)s={scenes:[i.scenegraph]};else if(i.scenegraph&&!i.scenegraph.gltf){var u=i.scenegraph,f=ga(o,u,this._getModelOptions());s=Sm({gltf:u},f),Em(f).then(function(){return a.setNeedsRedraw()})}else i.scenegraph&&($e.log.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),s=i.scenegraph);var c={layer:this,gl:o},d=i.getScene(s,c),m=i.getAnimator(s,c);d instanceof ct?(this._deleteScenegraph(),this._applyAllAttributes(d),this._applyAnimationsProp(d,m,i._animations),this.setState({scenegraph:d,animator:m})):d!==null&&$e.log.warn("invalid scenegraph:",d)()}},{key:"_applyAllAttributes",value:function(a){var i=this;if(this.state.attributesAvailable){var o=this.getAttributeManager().getAttributes();a.traverse(function(s){i._setModelAttributes(s.model,o)})}}},{key:"_applyAnimationsProp",value:function(a,i,o){if(!(!a||!i||!o)){var s=i.getAnimations();Object.keys(o).sort().forEach(function(u){var f=o[u];if(u==="*")s.forEach(function(m){Object.assign(m,f)});else if(Number.isFinite(Number(u))){var c=Number(u);c>=0&&c<s.length?Object.assign(s[c],f):$e.log.warn("animation ".concat(u," not found"))()}else{var d=s.find(function(m){var h=m.name;return h===u});d?Object.assign(d,f):$e.log.warn("animation ".concat(u," not found"))()}})}}},{key:"_deleteScenegraph",value:function(){var a=this.state.scenegraph;a instanceof ct&&a.delete()}},{key:"_getModelOptions",value:function(){var a=this.props._imageBasedLightingEnvironment,i=null;return a&&(typeof a=="function"?i=a({gl:this.context.gl,layer:this}):i=a),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:i,modelOptions:Sm({isInstanced:!0,transpileToGLSL100:!(0,Mm.isWebGL2)(this.context.gl)},this.getShaders()),useTangents:!1}}},{key:"updateAttributes",value:function(a){var i=this;this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(function(o){i._setModelAttributes(o.model,a)})}},{key:"draw",value:function(a){var i=a.moduleParameters,o=i===void 0?null:i,s=a.parameters,u=s===void 0?{}:s,f=a.context;if(this.state.scenegraph){this.props._animations&&this.state.animator&&(this.state.animator.animate(f.timeline.getTime()),this.setNeedsRedraw());var c=this.context.viewport,d=this.props,m=d.sizeScale,h=d.sizeMinPixels,p=d.sizeMaxPixels,v=d.opacity,g=d.coordinateSystem,_=this.getNumInstances();this.state.scenegraph.traverse(function(b,C){var x=C.worldMatrix;b.model.setInstanceCount(_),b.updateModuleSettings(o),b.draw({parameters:u,uniforms:{sizeScale:m,opacity:v,sizeMinPixels:h,sizeMaxPixels:p,composeModelMatrix:Gn(c,g),sceneModelMatrix:x,u_Camera:b.model.getUniforms().project_uCameraPosition}})})}}}]),e}($e.Layer);l(Ca,"defaultProps",Fb);l(Ca,"layerName","ScenegraphLayer");return Pm(cn);})();
      return __exports__;
      });
